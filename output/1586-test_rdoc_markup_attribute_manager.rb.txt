#Source[
   #List[
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['rdoc/test_case']
         ]
      ]
      $statement: #Class[
         $name: #NameExpr['TestRDocMarkupAttributeManager']
         $super: #Field[
            $recv: #NameExpr['RDoc']
            $name: #NameExpr['TestCase']
         ]
         $body: #BlockExpr[
            $main: #List[
               $statement: #FuncDecl[
                  $name: #NameExpr['setup']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #Super['super']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@am']
                           $right: #ApplyExpr[
                              $recv: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['AttributeManager']
                              ]
                              $recv: #NameExpr['new']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@bold_on']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array['[]']
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['BOLD']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@bold_off']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['BOLD']
                                    ]
                                 ]
                                 $expression: #Array['[]']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@tt_on']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array['[]']
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['TT']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@tt_off']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['TT']
                                    ]
                                 ]
                                 $expression: #Array['[]']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@em_on']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array['[]']
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['EM']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@em_off']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['EM']
                                    ]
                                 ]
                                 $expression: #Array['[]']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@bold_em_on']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array['[]']
                                 $expression: #OrExpr[
                                    $left: #Array[
                                       $index: #List[
                                          $expression: #NameExpr['BOLD']
                                       ]
                                    ]
                                    $right: #Array[
                                       $index: #List[
                                          $expression: #NameExpr['EM']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@bold_em_off']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #OrExpr[
                                    $left: #Array[
                                       $index: #List[
                                          $expression: #NameExpr['BOLD']
                                       ]
                                    ]
                                    $right: #Array[
                                       $index: #List[
                                          $expression: #NameExpr['EM']
                                       ]
                                    ]
                                 ]
                                 $expression: #Array['[]']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@em_then_bold']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['EM']
                                    ]
                                 ]
                                 $expression: #OrExpr[
                                    $left: #Array[
                                       $index: #List[
                                          $expression: #NameExpr['EM']
                                       ]
                                    ]
                                    $right: #Array[
                                       $index: #List[
                                          $expression: #NameExpr['BOLD']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@em_to_bold']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['EM']
                                    ]
                                 ]
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['BOLD']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@am']
                           $recv: #NameExpr['add_word_pair']
                           $param: #List[
                              $expression: #StringExpr['{']
                              $expression: #StringExpr['}']
                              $expression: #NameExpr['WOMBAT']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@wombat_on']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array['[]']
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['WOMBAT']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@wombat_off']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['changed_attribute_by_name']
                              $param: #List[
                                 $expression: #Array[
                                    $index: #List[
                                       $expression: #NameExpr['WOMBAT']
                                    ]
                                 ]
                                 $expression: #Array['[]']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@klass']
                           $right: #Field[
                              $recv: #Field[
                                 $recv: #NameExpr['RDoc']
                                 $name: #NameExpr['Markup']
                              ]
                              $name: #NameExpr['AttributeManager']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@formatter']
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['Formatter']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['@rdoc']
                                    $recv: #NameExpr['options']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@formatter']
                           $recv: #NameExpr['add_tag']
                           $param: #List[
                              $expression: #NameExpr['BOLD']
                              $expression: #StringExpr['<B>']
                              $expression: #StringExpr['</B>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@formatter']
                           $recv: #NameExpr['add_tag']
                           $param: #List[
                              $expression: #NameExpr['EM']
                              $expression: #StringExpr['<EM>']
                              $expression: #StringExpr['</EM>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@formatter']
                           $recv: #NameExpr['add_tag']
                           $param: #List[
                              $expression: #NameExpr['TT']
                              $expression: #StringExpr['<CODE>']
                              $expression: #StringExpr['</CODE>']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['crossref']
                  $param: #List[
                     $param: #Param[
                        $param: #NameExpr['text']
                     ]
                  ]
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['crossref_bitmap']
                           $right: #OrExpr[
                              $left: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@am']
                                    $recv: #NameExpr['attributes']
                                 ]
                                 $recv: #NameExpr['bitmap_for']
                                 $param: #List[
                                    $expression: #NameExpr['_SPECIAL_']
                                 ]
                              ]
                              $right: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@am']
                                    $recv: #NameExpr['attributes']
                                 ]
                                 $recv: #NameExpr['bitmap_for']
                                 $param: #List[
                                    $expression: #NameExpr['CROSSREF']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #Array[
                           $index: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['changed_attribute_by_name']
                                 $param: #List[
                                    $expression: #Array['[]']
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #NameExpr['CROSSREF']
                                          $expression: #NameExpr['_SPECIAL_']
                                       ]
                                    ]
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['RDoc']
                                       $name: #NameExpr['Markup']
                                    ]
                                    $name: #NameExpr['Special']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #NameExpr['crossref_bitmap']
                                    $expression: #NameExpr['text']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['changed_attribute_by_name']
                                 $param: #List[
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #NameExpr['CROSSREF']
                                          $expression: #NameExpr['_SPECIAL_']
                                       ]
                                    ]
                                    $expression: #Array['[]']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_adding']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat ']
                                 $expression: #NameExpr['@wombat_on']
                                 $expression: #StringExpr['and']
                                 $expression: #NameExpr['@wombat_off']
                                 $expression: #StringExpr[' dog']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat {and} dog']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_add_html_tag']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@am']
                           $recv: #NameExpr['add_html']
                           $param: #List[
                              $expression: #StringExpr['Test']
                              $expression: #NameExpr['TEST']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['tags']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['html_tags']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['6']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['tags']
                                 $recv: #NameExpr['size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['tags']
                                 $recv: #NameExpr['has_key?']
                                 $param: #List[
                                    $expression: #StringExpr['test']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_add_special']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@am']
                           $recv: #NameExpr['add_special']
                           $param: #List[
                              $expression: #StringExpr['WikiWord']
                              $expression: #NameExpr['WIKIWORD']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['specials']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['special']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['1']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['specials']
                                 $recv: #NameExpr['size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $command: #ApplyExpr[
                                 $base: #NameExpr['specials']
                                 $recv: #NameExpr['assoc']
                                 $param: #List[
                                    $expression: #StringExpr['WikiWord']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_add_word_pair']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@am']
                           $recv: #NameExpr['add_word_pair']
                           $param: #List[
                              $expression: #StringExpr['%']
                              $expression: #StringExpr['&']
                              $expression: #StringExpr['percent and']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@am']
                                    $recv: #NameExpr['word_pair_map']
                                 ]
                                 $recv: #NameExpr['include?']
                                 $param: #List[
                                    $expression: #Regex['/(%)(\\S+)(&)/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@am']
                                    $recv: #NameExpr['protectable']
                                 ]
                                 $recv: #NameExpr['include?']
                                 $param: #List[
                                    $expression: #StringExpr['%']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $expression: #NotExpr[
                                 $expr: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@am']
                                       $recv: #NameExpr['protectable']
                                    ]
                                    $recv: #NameExpr['include?']
                                    $param: #List[
                                       $expression: #StringExpr['&']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_add_word_pair_angle']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['e']
                           $right: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_raises']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['ArgumentError']
                                    $body: #Block[
                                       $body: #ApplyExpr[
                                          $base: #NameExpr['@am']
                                          $recv: #NameExpr['add_word_pair']
                                          $param: #List[
                                             $expression: #StringExpr['<']
                                             $expression: #StringExpr['>']
                                             $expression: #StringExpr['angles']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Word flags may not start with \'<\'']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['e']
                                 $recv: #NameExpr['message']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_add_word_pair_invalid']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_raises']
                        $param: #List[
                           $expression: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['ArgumentError']
                              $body: #Block[
                                 $body: #ApplyExpr[
                                    $recv: #NameExpr['@am']
                                    $recv: #NameExpr['add_word_pair']
                                    $param: #List[
                                       $expression: #StringExpr['<']
                                       $expression: #StringExpr['<']
                                       $expression: #NameExpr['TEST']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_add_word_pair_map']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@am']
                           $recv: #NameExpr['add_word_pair']
                           $param: #List[
                              $expression: #StringExpr['x']
                              $expression: #StringExpr['y']
                              $expression: #NameExpr['TEST']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['word_pair_map']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['word_pair_map']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_includes']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['word_pair_map']
                                    $recv: #NameExpr['keys']
                                 ]
                                 $recv: #NameExpr['map']
                                 $body: #Block[
                                    $param: #NameExpr['r']
                                    $body: #ApplyExpr[
                                       $recv: #NameExpr['r']
                                       $recv: #NameExpr['source']
                                    ]
                                 ]
                              ]
                              $expression: #StringExpr['(x)(\\\\S+)(y)']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_add_word_pair_matching']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@am']
                           $recv: #NameExpr['add_word_pair']
                           $param: #List[
                              $expression: #StringExpr['^']
                              $expression: #StringExpr['^']
                              $expression: #StringExpr['caret']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@am']
                                    $recv: #NameExpr['matching_word_pairs']
                                 ]
                                 $recv: #NameExpr['include?']
                                 $param: #List[
                                    $expression: #StringExpr['^']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@am']
                                    $recv: #NameExpr['protectable']
                                 ]
                                 $recv: #NameExpr['include?']
                                 $param: #List[
                                    $expression: #StringExpr['^']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_basic']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['and']
                                    $expression: #NameExpr['@bold_off']
                                    $expression: #StringExpr[' dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat *and* dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['AND']
                                    $expression: #NameExpr['@bold_off']
                                    $expression: #StringExpr[' dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat *AND* dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@em_on']
                                    $expression: #StringExpr['And']
                                    $expression: #NameExpr['@em_off']
                                    $expression: #StringExpr[' dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat _And_ dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat *and dog*']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat *and dog*']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['*cat and* dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['*cat and* dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat *and ']
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['dog']
                                    $expression: #NameExpr['@bold_off']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat *and *dog*']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@em_on']
                                    $expression: #StringExpr['and']
                                    $expression: #NameExpr['@em_off']
                                    $expression: #StringExpr[' dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat _and_ dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat_and_dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat_and_dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@tt_on']
                                    $expression: #StringExpr['and']
                                    $expression: #NameExpr['@tt_off']
                                    $expression: #StringExpr[' dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat +and+ dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@tt_on']
                                    $expression: #StringExpr['X::Y']
                                    $expression: #NameExpr['@tt_off']
                                    $expression: #StringExpr[' dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat +X::Y+ dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['a_b_c']
                                    $expression: #NameExpr['@bold_off']
                                    $expression: #StringExpr[' dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat *a_b_c* dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat __ dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat __ dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@em_on']
                                    $expression: #StringExpr['_']
                                    $expression: #NameExpr['@em_off']
                                    $expression: #StringExpr[' dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat ___ dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat and ']
                                    $expression: #NameExpr['@em_on']
                                    $expression: #StringExpr['5']
                                    $expression: #NameExpr['@em_off']
                                    $expression: #StringExpr[' dogs']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat and _5_ dogs']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_bold']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['bold']
                                    $expression: #NameExpr['@bold_off']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['*bold*']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['Bold:']
                                    $expression: #NameExpr['@bold_off']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['*Bold:*']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['\\\\bold']
                                    $expression: #NameExpr['@bold_off']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['*\\\\bold*']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_bold_html_escaped']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat <b>dog</b>']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat \\<b>dog</b>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_combined']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@em_on']
                                    $expression: #StringExpr['and']
                                    $expression: #NameExpr['@em_off']
                                    $expression: #StringExpr[' ']
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['dog']
                                    $expression: #NameExpr['@bold_off']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat _and_ *dog*']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@em_on']
                                    $expression: #StringExpr['a__nd']
                                    $expression: #NameExpr['@em_off']
                                    $expression: #StringExpr[' ']
                                    $expression: #NameExpr['@bold_on']
                                    $expression: #StringExpr['dog']
                                    $expression: #NameExpr['@bold_off']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat _a__nd_ *dog*']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_attrs']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['+foo+']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['attrs']
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['AttrSpan']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['str']
                                    $recv: #NameExpr['length']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@am']
                           $recv: #NameExpr['convert_attrs']
                           $param: #List[
                              $expression: #NameExpr['str']
                              $expression: #NameExpr['attrs']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\000foo\\000']
                              $expression: #NameExpr['str']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['+:foo:+']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['attrs']
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['AttrSpan']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['str']
                                    $recv: #NameExpr['length']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@am']
                           $recv: #NameExpr['convert_attrs']
                           $param: #List[
                              $expression: #NameExpr['str']
                              $expression: #NameExpr['attrs']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\000:foo:\\000']
                              $expression: #NameExpr['str']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['+x-y+']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['attrs']
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['AttrSpan']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['str']
                                    $recv: #NameExpr['length']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@am']
                           $recv: #NameExpr['convert_attrs']
                           $param: #List[
                              $expression: #NameExpr['str']
                              $expression: #NameExpr['attrs']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\000x-y\\000']
                              $expression: #NameExpr['str']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_attrs_ignores_code']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['foo <CODE>__send__</CODE> bar']
                           $expression: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['output']
                              $param: #List[
                                 $expression: #StringExpr['foo <code>__send__</code> bar']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_attrs_ignores_tt']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['foo <CODE>__send__</CODE> bar']
                           $expression: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['output']
                              $param: #List[
                                 $expression: #StringExpr['foo <tt>__send__</tt> bar']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_attrs_preserves_double']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['foo.__send__ :bar']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['foo.__send__ :bar']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['use __FILE__ to']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['use __FILE__ to']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_attrs_does_not_ignore_after_tt']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['the <CODE>IF:</CODE><EM>key</EM> directive']
                           $expression: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['output']
                              $param: #List[
                                 $expression: #StringExpr['the <tt>IF:</tt>_key_ directive']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_escapes']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<CODE>text</CODE>']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['<tt>text</tt>']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<tt>text</tt>']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['\\\\<tt>text</tt>']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<tt>']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['\\\\<tt>']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<CODE><tt></CODE>']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['<tt>\\\\<tt></tt>']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<CODE>\\\\<tt></CODE>']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['<tt>\\\\\\\\<tt></tt>']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<B>text</B>']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['*text*']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['*text*']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['\\\\*text*']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\\\']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['\\\\']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\\\text']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['\\\\text']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\\\\\\\text']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['\\\\\\\\text']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['text \\\\ text']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['text \\\\ text']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['and <CODE>\\\\s</CODE> matches space']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['and <tt>\\\\s</tt> matches space']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['use <CODE><tt>text</CODE></tt> for code']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['use <tt>\\\\<tt>text</tt></tt> for code']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['use <CODE><tt>text</tt></CODE> for code']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['use <tt>\\\\<tt>text\\\\</tt></tt> for code']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['use <tt><tt>text</tt></tt> for code']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['use \\\\<tt>\\\\<tt>text</tt></tt> for code']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['use <tt><CODE>text</CODE></tt> for code']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['use \\\\<tt><tt>text</tt></tt> for code']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['use <CODE>+text+</CODE> for code']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['use <tt>\\\\+text+</tt> for code']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['use <tt><CODE>text</CODE></tt> for code']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['use \\\\<tt>+text+</tt> for code']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['illegal <tag>not</tag> changed']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['illegal <tag>not</tag> changed']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['unhandled <p>tag</p> unchanged']
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['output']
                                 $param: #List[
                                    $expression: #StringExpr['unhandled <p>tag</p> unchanged']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_html_like_em_bold']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat ']
                                 $expression: #NameExpr['@em_on']
                                 $expression: #StringExpr['and ']
                                 $expression: #NameExpr['@em_to_bold']
                                 $expression: #StringExpr['dog']
                                 $expression: #NameExpr['@bold_off']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat <i>and </i><b>dog</b>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_html_like_em_bold_SGML']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat ']
                                 $expression: #NameExpr['@em_on']
                                 $expression: #StringExpr['and ']
                                 $expression: #NameExpr['@em_to_bold']
                                 $expression: #StringExpr['dog']
                                 $expression: #NameExpr['@bold_off']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat <i>and <b></i>dog</b>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_html_like_em_bold_nested_1']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat ']
                                 $expression: #NameExpr['@bold_em_on']
                                 $expression: #StringExpr['and']
                                 $expression: #NameExpr['@bold_em_off']
                                 $expression: #StringExpr[' dog']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat <i><b>and</b></i> dog']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_html_like_em_bold_nested_2']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat ']
                                 $expression: #NameExpr['@em_on']
                                 $expression: #StringExpr['and ']
                                 $expression: #NameExpr['@em_then_bold']
                                 $expression: #StringExpr['dog']
                                 $expression: #NameExpr['@bold_em_off']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat <i>and <b>dog</b></i>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_html_like_em_bold_nested_mixed_case']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat ']
                                 $expression: #NameExpr['@em_on']
                                 $expression: #StringExpr['and ']
                                 $expression: #NameExpr['@em_then_bold']
                                 $expression: #StringExpr['dog']
                                 $expression: #NameExpr['@bold_em_off']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat <i>and <B>dog</B></I>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_html_like_em_bold_mixed_case']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat ']
                                 $expression: #NameExpr['@em_on']
                                 $expression: #StringExpr['and']
                                 $expression: #NameExpr['@em_off']
                                 $expression: #StringExpr[' ']
                                 $expression: #NameExpr['@bold_on']
                                 $expression: #StringExpr['dog']
                                 $expression: #NameExpr['@bold_off']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat <i>and</i> <B>dog</b>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_html_like_teletype']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #StringExpr['cat ']
                                 $expression: #NameExpr['@tt_on']
                                 $expression: #StringExpr['dog']
                                 $expression: #NameExpr['@tt_off']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['cat <tt>dog</Tt>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_html_like_teletype_em_bold_SGML']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #NameExpr['@tt_on']
                                 $expression: #StringExpr['cat']
                                 $expression: #NameExpr['@tt_off']
                                 $expression: #StringExpr[' ']
                                 $expression: #NameExpr['@em_on']
                                 $expression: #StringExpr['and ']
                                 $expression: #NameExpr['@em_to_bold']
                                 $expression: #StringExpr['dog']
                                 $expression: #NameExpr['@bold_off']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['<tt>cat</tt> <i>and <b></i>dog</b>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_initial_html']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['html_tags']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['html_tags']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['html_tags']
                                 $recv: #NameExpr['is_a?']
                                 $param: #List[
                                    $expression: #NameExpr['Hash']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['5']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['html_tags']
                                 $recv: #NameExpr['size']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_initial_word_pairs']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['word_pairs']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['matching_word_pairs']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['word_pairs']
                                 $recv: #NameExpr['is_a?']
                                 $param: #List[
                                    $expression: #NameExpr['Hash']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['3']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['word_pairs']
                                 $recv: #NameExpr['size']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_mask_protected_sequence']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #SFuncDecl[
                           $path: #NameExpr['@am']
                           $name: #NameExpr['str']
                           $param: #List['']
                           $body: #BlockExpr[
                              $main: #NameExpr['@str']
                           ]
                        ]
                        $statement: #SFuncDecl[
                           $path: #NameExpr['@am']
                           $name: #NameExpr['str=']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #AssignExpr[
                                 $left: #NameExpr['@str']
                                 $right: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@am']
                              $name: #NameExpr['str']
                           ]
                           $right: #StringExpr['<code>foo</code>']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@am']
                           $recv: #NameExpr['mask_protected_sequences']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<code>foo</code>']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@am']
                              $name: #NameExpr['str']
                           ]
                           $right: #StringExpr['<code>foo\\\\</code>']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@am']
                           $recv: #NameExpr['mask_protected_sequences']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<code>foo<\\x04/code>']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['str']
                              ]
                              $expression: #StringExpr['escaped close']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@am']
                              $name: #NameExpr['str']
                           ]
                           $right: #StringExpr['<code>foo\\\\\\\\</code>']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@am']
                           $recv: #NameExpr['mask_protected_sequences']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<code>foo\\\\</code>']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['str']
                              ]
                              $expression: #StringExpr['escaped backslash']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_protect']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat \\\\ dog']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat \\\\ dog']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat <tt>dog</Tt>']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat \\\\<tt>dog</Tt>']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cat ']
                                    $expression: #NameExpr['@em_on']
                                    $expression: #StringExpr['and']
                                    $expression: #NameExpr['@em_off']
                                    $expression: #StringExpr[' <B>dog</b>']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cat <i>and</i> \\\\<B>dog</b>']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['*word* or <b>text</b>']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['\\\\*word* or \\\\<b>text</b>']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['_cat_']
                                    $expression: #NameExpr['@em_on']
                                    $expression: #StringExpr['dog']
                                    $expression: #NameExpr['@em_off']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['\\\\_cat_<i>dog</i>']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_special']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@am']
                           $recv: #NameExpr['add_special']
                           $param: #List[
                              $expression: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['CrossReference']
                                 ]
                                 $name: #NameExpr['CROSSREF_REGEXP']
                              ]
                              $expression: #NameExpr['CROSSREF']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #StringExpr['cats\'']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cats\'']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #Array[
                                    $index: #List[
                                       $expression: #StringExpr['cats\' ']
                                       $expression: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['crossref']
                                          $param: #List[
                                             $expression: #StringExpr['#fred']
                                          ]
                                       ]
                                       $expression: #StringExpr[' dogs\'']
                                    ]
                                 ]
                                 $recv: #NameExpr['flatten']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cats\' #fred dogs\'']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #Array[
                                    $index: #List[
                                       $expression: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['crossref']
                                          $param: #List[
                                             $expression: #StringExpr['#fred']
                                          ]
                                       ]
                                       $expression: #StringExpr[' dogs\'']
                                    ]
                                 ]
                                 $recv: #NameExpr['flatten']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['#fred dogs\'']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #Array[
                                    $index: #List[
                                       $expression: #StringExpr['cats\' ']
                                       $expression: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['crossref']
                                          $param: #List[
                                             $expression: #StringExpr['#fred']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $recv: #NameExpr['flatten']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@am']
                                 $recv: #NameExpr['flow']
                                 $param: #List[
                                    $expression: #StringExpr['cats\' #fred']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_tt_html']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #Array[
                              $index: #List[
                                 $expression: #NameExpr['@tt_on']
                                 $expression: #StringExpr['"\\n"']
                                 $expression: #NameExpr['@tt_off']
                              ]
                           ]
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #StringExpr['<tt>"\\n"</tt>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['output']
                  $param: #List[
                     $param: #Param[
                        $param: #NameExpr['str']
                     ]
                  ]
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        $base: #NameExpr['@formatter']
                        $recv: #NameExpr['convert_flow']
                        $param: #List[
                           $command: #ApplyExpr[
                              $base: #NameExpr['@am']
                              $recv: #NameExpr['flow']
                              $param: #List[
                                 $expression: #NameExpr['str']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
         ]
      ]
   ]
   #Comsumed['comsumed']
]
