#Source[
   #List[
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['socket']
         ]
      ]
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['tempfile']
         ]
      ]
      $statement: #Module[
         $name: #NameExpr['WEBrick']
         $body: #BlockExpr[
            $main: #List[
               $statement: #AssignExpr[
                  $left: #NameExpr['CR']
                  $right: #StringExpr['\\x0d']
               ]
               $statement: #AssignExpr[
                  $left: #NameExpr['LF']
                  $right: #StringExpr['\\x0a']
               ]
               $statement: #AssignExpr[
                  $left: #NameExpr['CRLF']
                  $right: #StringExpr['\\x0d\\x0a']
               ]
               $statement: #Module[
                  $name: #NameExpr['HTTPUtils']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #FuncDecl[
                           $name: #NameExpr['normalize_path']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['path']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #IfExpr[
                                    $then: #ApplyExpr[
                                       #Self['self']
                                       $recv: #NameExpr['raise']
                                       $param: #List[
                                          $expression: #StringExpr[
                                             $inner: #NameExpr['path']
                                          ]
                                       ]
                                    ]
                                    $cond: #NeExpr[
                                       $left: #Indexer[
                                          $recv: #NameExpr['path']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $right: #StringExpr['/']
                                    ]
                                 ]
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['ret']
                                    $right: #ApplyExpr[
                                       $recv: #NameExpr['path']
                                       $recv: #NameExpr['dup']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['ret']
                                    $recv: #NameExpr['gsub!']
                                    $param: #List[
                                       $expression: #Regex['%r{/+}o']
                                       $expression: #StringExpr['/']
                                    ]
                                 ]
                                 $statement: #While[
                                    $cond: #ApplyExpr[
                                       $recv: #NameExpr['ret']
                                       $recv: #NameExpr['sub!']
                                       $param: #List[
                                          $expression: #Regex['%r\'/\\.(?:/|\\Z)\'']
                                          $expression: #StringExpr['/']
                                       ]
                                    ]
                                    $body: #Empty['']
                                 ]
                                 $statement: #While[
                                    $cond: #ApplyExpr[
                                       $recv: #NameExpr['ret']
                                       $recv: #NameExpr['sub!']
                                       $param: #List[
                                          $expression: #Regex['%r\'/(?!\\.\\./)[^/]+/\\.\\.(?:/|\\Z)\'']
                                          $expression: #StringExpr['/']
                                       ]
                                    ]
                                    $body: #Empty['']
                                 ]
                                 $statement: #IfExpr[
                                    $then: #ApplyExpr[
                                       #Self['self']
                                       $recv: #NameExpr['raise']
                                       $param: #List[
                                          $expression: #StringExpr[
                                             $inner: #NameExpr['path']
                                          ]
                                       ]
                                    ]
                                    $cond: #Match[
                                       $left: #Regex['%r{/\\.\\.(/|\\Z)}']
                                       $right: #NameExpr['ret']
                                    ]
                                 ]
                                 $statement: #NameExpr['ret']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['normalize_path']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['DefaultMimeTypes']
                           $right: #List[
                              $hash: #Hash[
                                 $key: #StringExpr['ai']
                                 $value: #StringExpr['application/postscript']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['asc']
                                 $value: #StringExpr['text/plain']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['avi']
                                 $value: #StringExpr['video/x-msvideo']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['bin']
                                 $value: #StringExpr['application/octet-stream']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['bmp']
                                 $value: #StringExpr['image/bmp']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['class']
                                 $value: #StringExpr['application/octet-stream']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['cer']
                                 $value: #StringExpr['application/pkix-cert']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['crl']
                                 $value: #StringExpr['application/pkix-crl']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['crt']
                                 $value: #StringExpr['application/x-x509-ca-cert']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['css']
                                 $value: #StringExpr['text/css']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['dms']
                                 $value: #StringExpr['application/octet-stream']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['doc']
                                 $value: #StringExpr['application/msword']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['dvi']
                                 $value: #StringExpr['application/x-dvi']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['eps']
                                 $value: #StringExpr['application/postscript']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['etx']
                                 $value: #StringExpr['text/x-setext']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['exe']
                                 $value: #StringExpr['application/octet-stream']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['gif']
                                 $value: #StringExpr['image/gif']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['htm']
                                 $value: #StringExpr['text/html']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['html']
                                 $value: #StringExpr['text/html']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['jpe']
                                 $value: #StringExpr['image/jpeg']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['jpeg']
                                 $value: #StringExpr['image/jpeg']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['jpg']
                                 $value: #StringExpr['image/jpeg']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['js']
                                 $value: #StringExpr['application/javascript']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['lha']
                                 $value: #StringExpr['application/octet-stream']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['lzh']
                                 $value: #StringExpr['application/octet-stream']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['mov']
                                 $value: #StringExpr['video/quicktime']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['mpe']
                                 $value: #StringExpr['video/mpeg']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['mpeg']
                                 $value: #StringExpr['video/mpeg']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['mpg']
                                 $value: #StringExpr['video/mpeg']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['pbm']
                                 $value: #StringExpr['image/x-portable-bitmap']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['pdf']
                                 $value: #StringExpr['application/pdf']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['pgm']
                                 $value: #StringExpr['image/x-portable-graymap']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['png']
                                 $value: #StringExpr['image/png']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['pnm']
                                 $value: #StringExpr['image/x-portable-anymap']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['ppm']
                                 $value: #StringExpr['image/x-portable-pixmap']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['ppt']
                                 $value: #StringExpr['application/vnd.ms-powerpoint']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['ps']
                                 $value: #StringExpr['application/postscript']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['qt']
                                 $value: #StringExpr['video/quicktime']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['ras']
                                 $value: #StringExpr['image/x-cmu-raster']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['rb']
                                 $value: #StringExpr['text/plain']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['rd']
                                 $value: #StringExpr['text/plain']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['rtf']
                                 $value: #StringExpr['application/rtf']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['sgm']
                                 $value: #StringExpr['text/sgml']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['sgml']
                                 $value: #StringExpr['text/sgml']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['svg']
                                 $value: #StringExpr['image/svg+xml']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['tif']
                                 $value: #StringExpr['image/tiff']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['tiff']
                                 $value: #StringExpr['image/tiff']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['txt']
                                 $value: #StringExpr['text/plain']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['xbm']
                                 $value: #StringExpr['image/x-xbitmap']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['xhtml']
                                 $value: #StringExpr['text/html']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['xls']
                                 $value: #StringExpr['application/vnd.ms-excel']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['xml']
                                 $value: #StringExpr['text/xml']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['xpm']
                                 $value: #StringExpr['image/x-xpixmap']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['xwd']
                                 $value: #StringExpr['image/x-xwindowdump']
                              ]
                              $hash: #Hash[
                                 $key: #StringExpr['zip']
                                 $value: #StringExpr['application/zip']
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['load_mime_types']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['file']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['open']
                                 $param: #List[
                                    $expression: #NameExpr['file']
                                 ]
                                 $body: #Block[
                                    $param: #NameExpr['io']
                                    $body: #List[
                                       $statement: #AssignExpr[
                                          $left: #NameExpr['hash']
                                          $right: #ApplyExpr[
                                             $recv: #NameExpr['Hash']
                                             $recv: #NameExpr['new']
                                          ]
                                       ]
                                       $statement: #ApplyExpr[
                                          $recv: #NameExpr['io']
                                          $recv: #NameExpr['each']
                                          $body: #Block[
                                             $param: #NameExpr['line']
                                             $body: #List[
                                                $statement: #IfExpr[
                                                   $then: #Next['next']
                                                   $cond: #Match[
                                                      $left: #Regex['/^#/']
                                                      $right: #NameExpr['line']
                                                   ]
                                                ]
                                                $statement: #ApplyExpr[
                                                   $recv: #NameExpr['line']
                                                   $recv: #NameExpr['chomp!']
                                                ]
                                                $statement: #MultipleAssign[
                                                   $left: #MultipleLeftHandSideExpression[
                                                      $item: #NameExpr['mimetype']
                                                      $item: #NameExpr['ext0']
                                                   ]
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['line']
                                                      $recv: #NameExpr['split']
                                                      $param: #List[
                                                         $expression: #Regex['/\\s+/']
                                                         $expression: #IntExpr['2']
                                                      ]
                                                   ]
                                                ]
                                                $statement: #Unless[
                                                   $then: #Next['next']
                                                   $cond: #NameExpr['ext0']
                                                ]
                                                $statement: #IfExpr[
                                                   $then: #Next['next']
                                                   $cond: #ApplyExpr[
                                                      $recv: #NameExpr['ext0']
                                                      $recv: #NameExpr['empty?']
                                                   ]
                                                ]
                                                $statement: #ApplyExpr[
                                                   $recv: #ApplyExpr[
                                                      $recv: #NameExpr['ext0']
                                                      $recv: #NameExpr['split']
                                                      $param: #List[
                                                         $expression: #Regex['/\\s+/']
                                                      ]
                                                   ]
                                                   $recv: #NameExpr['each']
                                                   $body: #Block[
                                                      $param: #NameExpr['ext']
                                                      $body: #AssignExpr[
                                                         $left: #Indexer[
                                                            $base: #NameExpr['hash']
                                                            $index: #List[
                                                               $expression: #NameExpr['ext']
                                                            ]
                                                         ]
                                                         $right: #NameExpr['mimetype']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                       $statement: #NameExpr['hash']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['load_mime_types']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['mime_type']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['filename']
                              ]
                              $param: #Param[
                                 $param: #NameExpr['mime_tab']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['suffix1']
                                    $right: #LAnd[
                                       $left: #Match[
                                          $left: #Regex['/\\.(\\w+)$/']
                                          $right: #NameExpr['filename']
                                       ]
                                       $right: #ApplyExpr[
                                          $recv: #MatchedRegex['$1']
                                          $recv: #NameExpr['downcase']
                                       ]
                                    ]
                                 ]
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['suffix2']
                                    $right: #LAnd[
                                       $left: #Match[
                                          $left: #Regex['/\\.(\\w+)\\.[\\w\\-]+$/']
                                          $right: #NameExpr['filename']
                                       ]
                                       $right: #ApplyExpr[
                                          $recv: #MatchedRegex['$1']
                                          $recv: #NameExpr['downcase']
                                       ]
                                    ]
                                 ]
                                 $statement: #LOr[
                                    $left: #LOr[
                                       $left: #Indexer[
                                          $recv: #NameExpr['mime_tab']
                                          $index: #List[
                                             $expression: #NameExpr['suffix1']
                                          ]
                                       ]
                                       $right: #Indexer[
                                          $recv: #NameExpr['mime_tab']
                                          $index: #List[
                                             $expression: #NameExpr['suffix2']
                                          ]
                                       ]
                                    ]
                                    $right: #StringExpr['application/octet-stream']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['mime_type']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['parse_header']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['raw']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['header']
                                    $right: #ApplyExpr[
                                       $recv: #NameExpr['Hash']
                                       $recv: #NameExpr['new']
                                       $param: #List[
                                          $expression: #ApplyExpr[
                                             $recv: #Array['[]']
                                             $recv: #NameExpr['freeze']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['field']
                                    $right: #Nil['nil']
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['raw']
                                    $recv: #NameExpr['each_line']
                                    $body: #Block[
                                       $param: #NameExpr['line']
                                       $body: #Case[
                                          $cond: #NameExpr['line']
                                          $body: #List[
                                             $when: #When[
                                                $cond: #List[
                                                   $expression: #Regex['/^([A-Za-z0-9!\\#$%&\'*+\\-.^_`|~]+):\\s*(.*?)\\s*\\z/om']
                                                ]
                                                $then: #List[
                                                   $statement: #MultipleAssign[
                                                      $left: #MultipleLeftHandSideExpression[
                                                         $item: #NameExpr['field']
                                                         $item: #NameExpr['value']
                                                      ]
                                                      $right: #MultipleRightHandSideExpression[
                                                         $expression: #MatchedRegex['$1']
                                                         $expression: #MatchedRegex['$2']
                                                      ]
                                                   ]
                                                   $statement: #ApplyExpr[
                                                      $recv: #NameExpr['field']
                                                      $recv: #NameExpr['downcase!']
                                                   ]
                                                   $statement: #Unless[
                                                      $then: #AssignExpr[
                                                         $left: #Indexer[
                                                            $base: #NameExpr['header']
                                                            $index: #List[
                                                               $expression: #NameExpr['field']
                                                            ]
                                                         ]
                                                         $right: #Array['[]']
                                                      ]
                                                      $cond: #ApplyExpr[
                                                         $recv: #NameExpr['header']
                                                         $recv: #NameExpr['has_key?']
                                                         $param: #List[
                                                            $expression: #NameExpr['field']
                                                         ]
                                                      ]
                                                   ]
                                                   $statement: #LShiftExpr[
                                                      $left: #Indexer[
                                                         $recv: #NameExpr['header']
                                                         $index: #List[
                                                            $expression: #NameExpr['field']
                                                         ]
                                                      ]
                                                      $right: #NameExpr['value']
                                                   ]
                                                ]
                                             ]
                                             $when: #When[
                                                $cond: #List[
                                                   $expression: #Regex['/^\\s+(.*?)\\s*\\z/om']
                                                ]
                                                $then: #List[
                                                   $statement: #AssignExpr[
                                                      $left: #NameExpr['value']
                                                      $right: #MatchedRegex['$1']
                                                   ]
                                                   $statement: #Unless[
                                                      $cond: #NameExpr['field']
                                                      $then: #ApplyExpr[
                                                         #Self['self']
                                                         $recv: #NameExpr['raise']
                                                         $param: #List[
                                                            $expression: #Field[
                                                               $recv: #NameExpr['HTTPStatus']
                                                               $name: #NameExpr['BadRequest']
                                                            ]
                                                            $expression: #StringExpr[
                                                               $inner: #NameExpr['line']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                   $statement: #LShiftExpr[
                                                      $left: #LShiftExpr[
                                                         $left: #Indexer[
                                                            $recv: #Indexer[
                                                               $recv: #NameExpr['header']
                                                               $index: #List[
                                                                  $expression: #NameExpr['field']
                                                               ]
                                                            ]
                                                            $index: #List[
                                                               $expression: #MinusExpr[
                                                                  $expr: #IntExpr['1']
                                                               ]
                                                            ]
                                                         ]
                                                         $right: #StringExpr[' ']
                                                      ]
                                                      $right: #NameExpr['value']
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $else: #ApplyExpr[
                                             #Self['self']
                                             $recv: #NameExpr['raise']
                                             $param: #List[
                                                $expression: #Field[
                                                   $recv: #NameExpr['HTTPStatus']
                                                   $name: #NameExpr['BadRequest']
                                                ]
                                                $expression: #StringExpr[
                                                   $inner: #NameExpr['line']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['header']
                                    $recv: #NameExpr['each']
                                    $body: #Block[
                                       $param: #MultipleLeftHandSideExpression[
                                          $item: #NameExpr['key']
                                          $item: #NameExpr['values']
                                       ]
                                       $body: #ApplyExpr[
                                          $recv: #NameExpr['values']
                                          $recv: #NameExpr['each']
                                          $body: #Block[
                                             $param: #NameExpr['value']
                                             $body: #List[
                                                $statement: #ApplyExpr[
                                                   $recv: #NameExpr['value']
                                                   $recv: #NameExpr['strip!']
                                                ]
                                                $statement: #ApplyExpr[
                                                   $recv: #NameExpr['value']
                                                   $recv: #NameExpr['gsub!']
                                                   $param: #List[
                                                      $expression: #Regex['/\\s+/']
                                                      $expression: #StringExpr[' ']
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #NameExpr['header']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['parse_header']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['split_header_value']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['str']
                                    $recv: #NameExpr['scan']
                                    $param: #List[
                                       $expression: #Regex['%r\'\\G((?:"(?:\\\\.|[^"])+?"|[^",]+)+)\n                    (?:,\\s*|\\Z)\'xn']
                                    ]
                                 ]
                                 $recv: #NameExpr['flatten']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['split_header_value']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['parse_range_header']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['ranges_specifier']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #IfExpr[
                                 $cond: #Match[
                                    $left: #Regex['/^bytes=(.*)/']
                                    $right: #NameExpr['ranges_specifier']
                                 ]
                                 $then: #List[
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['byte_range_set']
                                       $right: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['split_header_value']
                                          $param: #List[
                                             $expression: #MatchedRegex['$1']
                                          ]
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['byte_range_set']
                                       $recv: #NameExpr['collect']
                                       $body: #Block[
                                          $param: #NameExpr['range_spec']
                                          $body: #Case[
                                             $cond: #NameExpr['range_spec']
                                             $body: #List[
                                                $when: #When[
                                                   $cond: #List[
                                                      $expression: #Regex['/^(\\d+)-(\\d+)/']
                                                   ]
                                                   $then: #ClosedRange[
                                                      #ApplyExpr[
                                                         $recv: #MatchedRegex['$1']
                                                         $recv: #NameExpr['to_i']
                                                      ]
                                                      #ApplyExpr[
                                                         $recv: #MatchedRegex['$2']
                                                         $recv: #NameExpr['to_i']
                                                      ]
                                                   ]
                                                ]
                                                $when: #When[
                                                   $cond: #List[
                                                      $expression: #Regex['/^(\\d+)-/']
                                                   ]
                                                   $then: #ClosedRange[
                                                      #ApplyExpr[
                                                         $recv: #MatchedRegex['$1']
                                                         $recv: #NameExpr['to_i']
                                                      ]
                                                      #MinusExpr[
                                                         $expr: #IntExpr['1']
                                                      ]
                                                   ]
                                                ]
                                                $when: #When[
                                                   $cond: #List[
                                                      $expression: #Regex['/^-(\\d+)/']
                                                   ]
                                                   $then: #ClosedRange[
                                                      #MinusExpr[
                                                         $expr: #ApplyExpr[
                                                            $recv: #MatchedRegex['$1']
                                                            $recv: #NameExpr['to_i']
                                                         ]
                                                      ]
                                                      #MinusExpr[
                                                         $expr: #IntExpr['1']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                             $else: #RReturnStmt[
                                                $expr: #List[
                                                   $expression: #Nil['nil']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['parse_range_header']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['parse_qvalues']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['value']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['tmp']
                                    $right: #Array['[]']
                                 ]
                                 $statement: #IfExpr[
                                    $cond: #NameExpr['value']
                                    $then: #List[
                                       $statement: #AssignExpr[
                                          $left: #NameExpr['parts']
                                          $right: #ApplyExpr[
                                             $recv: #NameExpr['value']
                                             $recv: #NameExpr['split']
                                             $param: #List[
                                                $expression: #Regex['/,\\s*/']
                                             ]
                                          ]
                                       ]
                                       $statement: #ApplyExpr[
                                          $recv: #NameExpr['parts']
                                          $recv: #NameExpr['each']
                                          $body: #Block[
                                             $param: #NameExpr['part']
                                             $body: #IfExpr[
                                                $cond: #AssignExpr[
                                                   $left: #NameExpr['m']
                                                   $right: #ApplyExpr[
                                                      $recv: #Regex['%r{^([^\\s,]+?)(?:;\\s*q=(\\d+(?:\\.\\d+)?))?$}']
                                                      $recv: #NameExpr['match']
                                                      $param: #List[
                                                         $expression: #NameExpr['part']
                                                      ]
                                                   ]
                                                ]
                                                $then: #List[
                                                   $statement: #AssignExpr[
                                                      $left: #NameExpr['val']
                                                      $right: #Indexer[
                                                         $recv: #NameExpr['m']
                                                         $index: #List[
                                                            $expression: #IntExpr['1']
                                                         ]
                                                      ]
                                                   ]
                                                   $statement: #AssignExpr[
                                                      $left: #NameExpr['q']
                                                      $right: #ApplyExpr[
                                                         $recv: #OrExpr[
                                                            $left: #Indexer[
                                                               $recv: #NameExpr['m']
                                                               $index: #List[
                                                                  $expression: #IntExpr['2']
                                                               ]
                                                            ]
                                                            $right: #IntExpr['1']
                                                         ]
                                                         $recv: #NameExpr['to_f']
                                                      ]
                                                   ]
                                                   $statement: #ApplyExpr[
                                                      $recv: #NameExpr['tmp']
                                                      $recv: #NameExpr['push']
                                                      $param: #List[
                                                         $expression: #Array[
                                                            $index: #List[
                                                               $expression: #NameExpr['val']
                                                               $expression: #NameExpr['q']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                       $statement: #AssignExpr[
                                          $left: #NameExpr['tmp']
                                          $right: #ApplyExpr[
                                             $recv: #NameExpr['tmp']
                                             $recv: #NameExpr['sort_by']
                                             $body: #Block[
                                                $param: #MultipleLeftHandSideExpression[
                                                   $item: #NameExpr['val']
                                                   $item: #NameExpr['q']
                                                ]
                                                $body: #MinusExpr[
                                                   $expr: #NameExpr['q']
                                                ]
                                             ]
                                          ]
                                       ]
                                       $statement: #ApplyExpr[
                                          $recv: #NameExpr['tmp']
                                          $recv: #NameExpr['collect!']
                                          $body: #Block[
                                             $param: #MultipleLeftHandSideExpression[
                                                $item: #NameExpr['val']
                                                $item: #NameExpr['q']
                                             ]
                                             $body: #NameExpr['val']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #RReturnStmt[
                                    $expr: #List[
                                       $expression: #NameExpr['tmp']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['parse_qvalues']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['dequote']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['ret']
                                    $right: #Conditional[
                                       $cond: #Match[
                                          $left: #Regex['/\\A"(.*)"\\Z/']
                                          $right: #NameExpr['str']
                                       ]
                                       $then: #MatchedRegex['$1']
                                       $else: #ApplyExpr[
                                          $recv: #NameExpr['str']
                                          $recv: #NameExpr['dup']
                                       ]
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['ret']
                                    $recv: #NameExpr['gsub!']
                                    $param: #List[
                                       $expression: #Regex['/\\\\(.)/']
                                       $expression: #StringExpr['\\\\1']
                                    ]
                                 ]
                                 $statement: #NameExpr['ret']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['dequote']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['quote']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #LShiftExpr[
                                 $left: #LShiftExpr[
                                    $left: #StringExpr['"']
                                    $right: #ApplyExpr[
                                       $recv: #NameExpr['str']
                                       $recv: #NameExpr['gsub']
                                       $param: #List[
                                          $expression: #Regex['/[\\\\\\"]/o']
                                          $expression: #StringExpr['\\\\\\1']
                                       ]
                                    ]
                                 ]
                                 $right: #StringExpr['"']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['quote']
                           ]
                        ]
                        $statement: #Class[
                           $name: #NameExpr['FormData']
                           $super: #NameExpr['String']
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['EmptyRawHeader']
                                    $right: #ApplyExpr[
                                       $recv: #Array['[]']
                                       $recv: #NameExpr['freeze']
                                    ]
                                 ]
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['EmptyHeader']
                                    $right: #ApplyExpr[
                                       $recv: #List['{}']
                                       $recv: #NameExpr['freeze']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['attr_accessor']
                                    $param: #List[
                                       $expression: #NameExpr['name']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['attr_accessor']
                                    $param: #List[
                                       $expression: #NameExpr['filename']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['attr_accessor']
                                    $param: #List[
                                       $expression: #NameExpr['next_data']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['protected']
                                    $param: #List[
                                       $expression: #NameExpr['next_data']
                                    ]
                                 ]
                                 $statement: #FuncDecl[
                                    $name: #NameExpr['initialize']
                                    $param: #List[
                                       $param: #VariadicParam[
                                          $name: #NameExpr['args']
                                       ]
                                    ]
                                    $body: #BlockExpr[
                                       $main: #List[
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['@name']
                                             $right: #AssignExpr[
                                                $left: #NameExpr['@filename']
                                                $right: #AssignExpr[
                                                   $left: #NameExpr['@next_data']
                                                   $right: #Nil['nil']
                                                ]
                                             ]
                                          ]
                                          $statement: #IfExpr[
                                             $cond: #ApplyExpr[
                                                $recv: #NameExpr['args']
                                                $recv: #NameExpr['empty?']
                                             ]
                                             $then: #List[
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['@raw_header']
                                                   $right: #Array['[]']
                                                ]
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['@header']
                                                   $right: #Nil['nil']
                                                ]
                                                $statement: #ApplyExpr[
                                                   #Self['self']
                                                   $recv: #Super['super']
                                                   $param: #List[
                                                      $expression: #StringExpr['']
                                                   ]
                                                ]
                                             ]
                                             $else: #List[
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['@raw_header']
                                                   $right: #NameExpr['EmptyRawHeader']
                                                ]
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['@header']
                                                   $right: #NameExpr['EmptyHeader']
                                                ]
                                                $statement: #ApplyExpr[
                                                   #Self['self']
                                                   $recv: #Super['super']
                                                   $param: #List[
                                                      $expression: #ApplyExpr[
                                                         $recv: #NameExpr['args']
                                                         $recv: #NameExpr['shift']
                                                      ]
                                                   ]
                                                ]
                                                $statement: #Unless[
                                                   $cond: #ApplyExpr[
                                                      $recv: #NameExpr['args']
                                                      $recv: #NameExpr['empty?']
                                                   ]
                                                   $then: #AssignExpr[
                                                      $left: #NameExpr['@next_data']
                                                      $right: #ApplyExpr[
                                                         $recv: #ApplyExpr[
                                                            $recv: #Self['self']
                                                            $recv: #NameExpr['class']
                                                         ]
                                                         $recv: #NameExpr['new']
                                                         $param: #List[
                                                            $variadic: #Variadic[
                                                               $base: #NameExpr['args']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #FuncDecl[
                                    $name: #NameExpr['[]']
                                    $param: #List[
                                       $param: #VariadicParam[
                                          $name: #NameExpr['key']
                                       ]
                                    ]
                                    $body: #BlockExpr[
                                       $main: #ExceptionBlock[
                                          $main: #ApplyExpr[
                                             $recv: #Indexer[
                                                $recv: #NameExpr['@header']
                                                $index: #List[
                                                   $expression: #ApplyExpr[
                                                      $recv: #Indexer[
                                                         $recv: #NameExpr['key']
                                                         $index: #List[
                                                            $expression: #IntExpr['0']
                                                         ]
                                                      ]
                                                      $recv: #NameExpr['downcase']
                                                   ]
                                                ]
                                             ]
                                             $recv: #NameExpr['join']
                                             $param: #List[
                                                $expression: #StringExpr[', ']
                                             ]
                                          ]
                                          $rescue: #List[
                                             $rescue: #Rescue[
                                                $class: #MultipleRightHandSideExpression[
                                                   $expression: #NameExpr['StandardError']
                                                   $expression: #NameExpr['NameError']
                                                ]
                                                $then: #ApplyExpr[
                                                   #Self['self']
                                                   $recv: #Super['super']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #FuncDecl[
                                    $name: #NameExpr['<<']
                                    $param: #List[
                                       $param: #Param[
                                          $param: #NameExpr['str']
                                       ]
                                    ]
                                    $body: #BlockExpr[
                                       $main: #List[
                                          $statement: #IfExpr[
                                             $cond: #NameExpr['@header']
                                             $then: #ApplyExpr[
                                                #Self['self']
                                                $recv: #Super['super']
                                             ]
                                             $else: #IfExpr[
                                                $cond: #EqExpr[
                                                   $left: #NameExpr['str']
                                                   $right: #NameExpr['CRLF']
                                                ]
                                                $then: #List[
                                                   $statement: #AssignExpr[
                                                      $left: #NameExpr['@header']
                                                      $right: #ApplyExpr[
                                                         $recv: #NameExpr['HTTPUtils']
                                                         $recv: #NameExpr['parse_header']
                                                         $param: #List[
                                                            $expression: #ApplyExpr[
                                                               $recv: #NameExpr['@raw_header']
                                                               $recv: #NameExpr['join']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                   $statement: #IfExpr[
                                                      $cond: #AssignExpr[
                                                         $left: #NameExpr['cd']
                                                         $right: #Indexer[
                                                            $recv: #Self['self']
                                                            $index: #List[
                                                               $expression: #StringExpr['content-disposition']
                                                            ]
                                                         ]
                                                      ]
                                                      $then: #List[
                                                         $statement: #IfExpr[
                                                            $cond: #Match[
                                                               $left: #Regex['/\\s+name="(.*?)"/']
                                                               $right: #NameExpr['cd']
                                                            ]
                                                            $then: #AssignExpr[
                                                               $left: #NameExpr['@name']
                                                               $right: #MatchedRegex['$1']
                                                            ]
                                                         ]
                                                         $statement: #IfExpr[
                                                            $cond: #Match[
                                                               $left: #Regex['/\\s+filename="(.*?)"/']
                                                               $right: #NameExpr['cd']
                                                            ]
                                                            $then: #AssignExpr[
                                                               $left: #NameExpr['@filename']
                                                               $right: #MatchedRegex['$1']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                                $else: #LShiftExpr[
                                                   $left: #NameExpr['@raw_header']
                                                   $right: #NameExpr['str']
                                                ]
                                             ]
                                          ]
                                          $statement: #Self['self']
                                       ]
                                    ]
                                 ]
                                 $statement: #FuncDecl[
                                    $name: #NameExpr['append_data']
                                    $param: #List[
                                       $param: #Param[
                                          $param: #NameExpr['data']
                                       ]
                                    ]
                                    $body: #BlockExpr[
                                       $main: #List[
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['tmp']
                                             $right: #Self['self']
                                          ]
                                          $statement: #While[
                                             $cond: #NameExpr['tmp']
                                             $body: #List[
                                                $statement: #Unless[
                                                   $cond: #ApplyExpr[
                                                      $recv: #NameExpr['tmp']
                                                      $recv: #NameExpr['next_data']
                                                   ]
                                                   $then: #List[
                                                      $statement: #AssignExpr[
                                                         $left: #Field[
                                                            $base: #NameExpr['tmp']
                                                            $name: #NameExpr['next_data']
                                                         ]
                                                         $right: #NameExpr['data']
                                                      ]
                                                      $statement: #Break['break']
                                                   ]
                                                ]
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['tmp']
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['tmp']
                                                      $recv: #NameExpr['next_data']
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $statement: #Self['self']
                                       ]
                                    ]
                                 ]
                                 $statement: #FuncDecl[
                                    $name: #NameExpr['each_data']
                                    $param: #List['']
                                    $body: #BlockExpr[
                                       $main: #List[
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['tmp']
                                             $right: #Self['self']
                                          ]
                                          $statement: #While[
                                             $cond: #NameExpr['tmp']
                                             $body: #List[
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['next_data']
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['tmp']
                                                      $recv: #NameExpr['next_data']
                                                   ]
                                                ]
                                                $statement: #Yield[
                                                   $param: #List[
                                                      $expression: #NameExpr['tmp']
                                                   ]
                                                ]
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['tmp']
                                                   $right: #NameExpr['next_data']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #FuncDecl[
                                    $name: #NameExpr['list']
                                    $param: #List['']
                                    $body: #BlockExpr[
                                       $main: #List[
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['ret']
                                             $right: #Array['[]']
                                          ]
                                          $statement: #ApplyExpr[
                                             #Self['self']
                                             $recv: #NameExpr['each_data']
                                             $body: #Block[
                                                $param: #NameExpr['data']
                                                $body: #LShiftExpr[
                                                   $left: #NameExpr['ret']
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['data']
                                                      $recv: #NameExpr['to_s']
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $statement: #NameExpr['ret']
                                       ]
                                    ]
                                 ]
                                 $statement: #Alias[
                                    $newname: #NameExpr['to_ary']
                                    $target: #NameExpr['list']
                                 ]
                                 $statement: #FuncDecl[
                                    $name: #NameExpr['to_s']
                                    $param: #List['']
                                    $body: #BlockExpr[
                                       $main: #ApplyExpr[
                                          $recv: #NameExpr['String']
                                          $recv: #NameExpr['new']
                                          $param: #List[
                                             $expression: #Self['self']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['parse_query']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['query']
                                    $right: #ApplyExpr[
                                       $recv: #NameExpr['Hash']
                                       $recv: #NameExpr['new']
                                    ]
                                 ]
                                 $statement: #IfExpr[
                                    $cond: #NameExpr['str']
                                    $then: #ApplyExpr[
                                       $recv: #ApplyExpr[
                                          $recv: #NameExpr['str']
                                          $recv: #NameExpr['split']
                                          $param: #List[
                                             $expression: #Regex['/[&;]/']
                                          ]
                                       ]
                                       $recv: #NameExpr['each']
                                       $body: #Block[
                                          $param: #NameExpr['x']
                                          $body: #List[
                                             $statement: #IfExpr[
                                                $then: #Next['next']
                                                $cond: #ApplyExpr[
                                                   $recv: #NameExpr['x']
                                                   $recv: #NameExpr['empty?']
                                                ]
                                             ]
                                             $statement: #MultipleAssign[
                                                $left: #MultipleLeftHandSideExpression[
                                                   $item: #NameExpr['key']
                                                   $item: #NameExpr['val']
                                                ]
                                                $right: #ApplyExpr[
                                                   $recv: #NameExpr['x']
                                                   $recv: #NameExpr['split']
                                                   $param: #List[
                                                      $expression: #Regex['/=/']
                                                      $expression: #IntExpr['2']
                                                   ]
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['key']
                                                $right: #ApplyExpr[
                                                   #Self['self']
                                                   $recv: #NameExpr['unescape_form']
                                                   $param: #List[
                                                      $expression: #NameExpr['key']
                                                   ]
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['val']
                                                $right: #ApplyExpr[
                                                   #Self['self']
                                                   $recv: #NameExpr['unescape_form']
                                                   $param: #List[
                                                      $expression: #ApplyExpr[
                                                         $recv: #NameExpr['val']
                                                         $recv: #NameExpr['to_s']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['val']
                                                $right: #ApplyExpr[
                                                   $recv: #NameExpr['FormData']
                                                   $recv: #NameExpr['new']
                                                   $param: #List[
                                                      $expression: #NameExpr['val']
                                                   ]
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #Field[
                                                   $base: #NameExpr['val']
                                                   $name: #NameExpr['name']
                                                ]
                                                $right: #NameExpr['key']
                                             ]
                                             $statement: #IfExpr[
                                                $cond: #ApplyExpr[
                                                   $recv: #NameExpr['query']
                                                   $recv: #NameExpr['has_key?']
                                                   $param: #List[
                                                      $expression: #NameExpr['key']
                                                   ]
                                                ]
                                                $then: #List[
                                                   $statement: #ApplyExpr[
                                                      $recv: #Indexer[
                                                         $recv: #NameExpr['query']
                                                         $index: #List[
                                                            $expression: #NameExpr['key']
                                                         ]
                                                      ]
                                                      $recv: #NameExpr['append_data']
                                                      $param: #List[
                                                         $expression: #NameExpr['val']
                                                      ]
                                                   ]
                                                   $statement: #Next['next']
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #Indexer[
                                                   $base: #NameExpr['query']
                                                   $index: #List[
                                                      $expression: #NameExpr['key']
                                                   ]
                                                ]
                                                $right: #NameExpr['val']
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #NameExpr['query']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['parse_query']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['parse_form_data']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['io']
                              ]
                              $param: #Param[
                                 $param: #NameExpr['boundary']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['boundary_regexp']
                                    $right: #Regex['/\\A--#{Regexp.quote(boundary)}(--)?#{CRLF}\\z/']
                                 ]
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['form_data']
                                    $right: #ApplyExpr[
                                       $recv: #NameExpr['Hash']
                                       $recv: #NameExpr['new']
                                    ]
                                 ]
                                 $statement: #Unless[
                                    $then: #RReturnStmt[
                                       $expr: #List[
                                          $expression: #NameExpr['form_data']
                                       ]
                                    ]
                                    $cond: #NameExpr['io']
                                 ]
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['data']
                                    $right: #Nil['nil']
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['io']
                                    $recv: #NameExpr['each_line']
                                    $body: #Block[
                                       $param: #NameExpr['line']
                                       $body: #IfExpr[
                                          $cond: #AssignExpr[
                                             $left: #NameExpr['boundary_regexp']
                                             $right: #ComplExpr[
                                                $expr: #NameExpr['line']
                                             ]
                                          ]
                                          $then: #List[
                                             $statement: #IfExpr[
                                                $cond: #NameExpr['data']
                                                $then: #List[
                                                   $statement: #ApplyExpr[
                                                      $recv: #NameExpr['data']
                                                      $recv: #NameExpr['chop!']
                                                   ]
                                                   $statement: #AssignExpr[
                                                      $left: #NameExpr['key']
                                                      $right: #ApplyExpr[
                                                         $recv: #NameExpr['data']
                                                         $recv: #NameExpr['name']
                                                      ]
                                                   ]
                                                   $statement: #IfExpr[
                                                      $cond: #ApplyExpr[
                                                         $recv: #NameExpr['form_data']
                                                         $recv: #NameExpr['has_key?']
                                                         $param: #List[
                                                            $expression: #NameExpr['key']
                                                         ]
                                                      ]
                                                      $then: #ApplyExpr[
                                                         $recv: #Indexer[
                                                            $recv: #NameExpr['form_data']
                                                            $index: #List[
                                                               $expression: #NameExpr['key']
                                                            ]
                                                         ]
                                                         $recv: #NameExpr['append_data']
                                                         $param: #List[
                                                            $expression: #NameExpr['data']
                                                         ]
                                                      ]
                                                      $else: #AssignExpr[
                                                         $left: #Indexer[
                                                            $base: #NameExpr['form_data']
                                                            $index: #List[
                                                               $expression: #NameExpr['key']
                                                            ]
                                                         ]
                                                         $right: #NameExpr['data']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['data']
                                                $right: #ApplyExpr[
                                                   $recv: #NameExpr['FormData']
                                                   $recv: #NameExpr['new']
                                                ]
                                             ]
                                             $statement: #Next['next']
                                          ]
                                          $else: #IfExpr[
                                             $cond: #NameExpr['data']
                                             $then: #LShiftExpr[
                                                $left: #NameExpr['data']
                                                $right: #NameExpr['line']
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #RReturnStmt[
                                    $expr: #List[
                                       $expression: #NameExpr['form_data']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['module_function']
                           $param: #List[
                              $expression: #NameExpr['parse_form_data']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['reserved']
                           $right: #StringExpr[';/?:@&=+$,']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['num']
                           $right: #StringExpr['0123456789']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['lowalpha']
                           $right: #StringExpr['abcdefghijklmnopqrstuvwxyz']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['upalpha']
                           $right: #StringExpr['ABCDEFGHIJKLMNOPQRSTUVWXYZ']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['mark']
                           $right: #StringExpr['-_.!~*\\\'()']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['unreserved']
                           $right: #AddExpr[
                              $left: #AddExpr[
                                 $left: #AddExpr[
                                    $left: #NameExpr['num']
                                    $right: #NameExpr['lowalpha']
                                 ]
                                 $right: #NameExpr['upalpha']
                              ]
                              $right: #NameExpr['mark']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['control']
                           $right: #AddExpr[
                              $left: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #ClosedRange[
                                       #HexInteger['0x0']
                                       #HexInteger['0x1f']
                                    ]
                                    $recv: #NameExpr['collect']
                                    $body: #Block[
                                       $param: #NameExpr['c']
                                       $body: #ApplyExpr[
                                          $recv: #NameExpr['c']
                                          $recv: #NameExpr['chr']
                                       ]
                                    ]
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                              $right: #StringExpr['\\x7f']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['space']
                           $right: #StringExpr[' ']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['delims']
                           $right: #StringExpr['<>#%"']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['unwise']
                           $right: #StringExpr['{}|\\\\^[]`']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['nonascii']
                           $right: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #ClosedRange[
                                    #HexInteger['0x80']
                                    #HexInteger['0xff']
                                 ]
                                 $recv: #NameExpr['collect']
                                 $body: #Block[
                                    $param: #NameExpr['c']
                                    $body: #ApplyExpr[
                                       $recv: #NameExpr['c']
                                       $recv: #NameExpr['chr']
                                    ]
                                 ]
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                        $statement: #NameExpr['module_function']
                        $statement: #FuncDecl[
                           $name: #NameExpr['_make_regex']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #Regex['/([#{Regexp.escape(str)}])/n']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['_make_regex!']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #Regex['/([^#{Regexp.escape(str)}])/n']
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['_escape']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                              $param: #Param[
                                 $param: #NameExpr['regex']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['str']
                                    $right: #ApplyExpr[
                                       $recv: #NameExpr['str']
                                       $recv: #NameExpr['b']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['str']
                                    $recv: #NameExpr['gsub!']
                                    $param: #List[
                                       $expression: #NameExpr['regex']
                                    ]
                                    $body: #Block[
                                       $body: #ModExpr[
                                          $left: #StringExpr['%%%02X']
                                          $right: #ApplyExpr[
                                             $recv: #MatchedRegex['$1']
                                             $recv: #NameExpr['ord']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['str']
                                    $recv: #NameExpr['force_encoding']
                                    $param: #List[
                                       $expression: #Field[
                                          $recv: #NameExpr['Encoding']
                                          $name: #NameExpr['US_ASCII']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['_unescape']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                              $param: #Param[
                                 $param: #NameExpr['regex']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['str']
                                    $right: #ApplyExpr[
                                       $recv: #NameExpr['str']
                                       $recv: #NameExpr['b']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['str']
                                    $recv: #NameExpr['gsub!']
                                    $param: #List[
                                       $expression: #NameExpr['regex']
                                    ]
                                    $body: #Block[
                                       $body: #ApplyExpr[
                                          $recv: #ApplyExpr[
                                             $recv: #MatchedRegex['$1']
                                             $recv: #NameExpr['hex']
                                          ]
                                          $recv: #NameExpr['chr']
                                       ]
                                    ]
                                 ]
                                 $statement: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['UNESCAPED']
                           $right: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['_make_regex']
                              $param: #List[
                                 $expression: #AddExpr[
                                    $left: #AddExpr[
                                       $left: #AddExpr[
                                          $left: #AddExpr[
                                             $left: #NameExpr['control']
                                             $right: #NameExpr['space']
                                          ]
                                          $right: #NameExpr['delims']
                                       ]
                                       $right: #NameExpr['unwise']
                                    ]
                                    $right: #NameExpr['nonascii']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['UNESCAPED_FORM']
                           $right: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['_make_regex']
                              $param: #List[
                                 $expression: #AddExpr[
                                    $left: #AddExpr[
                                       $left: #AddExpr[
                                          $left: #AddExpr[
                                             $left: #NameExpr['reserved']
                                             $right: #NameExpr['control']
                                          ]
                                          $right: #NameExpr['delims']
                                       ]
                                       $right: #NameExpr['unwise']
                                    ]
                                    $right: #NameExpr['nonascii']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['NONASCII']
                           $right: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['_make_regex']
                              $param: #List[
                                 $expression: #NameExpr['nonascii']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['ESCAPED']
                           $right: #Regex['/%([0-9a-fA-F]{2})/']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['UNESCAPED_PCHAR']
                           $right: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['_make_regex!']
                              $param: #List[
                                 $expression: #AddExpr[
                                    $left: #NameExpr['unreserved']
                                    $right: #StringExpr[':@&=+$,']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['escape']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['_escape']
                                 $param: #List[
                                    $expression: #NameExpr['str']
                                    $expression: #NameExpr['UNESCAPED']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['unescape']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['_unescape']
                                 $param: #List[
                                    $expression: #NameExpr['str']
                                    $expression: #NameExpr['ESCAPED']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['escape_form']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['ret']
                                    $right: #ApplyExpr[
                                       #Self['self']
                                       $recv: #NameExpr['_escape']
                                       $param: #List[
                                          $expression: #NameExpr['str']
                                          $expression: #NameExpr['UNESCAPED_FORM']
                                       ]
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #NameExpr['ret']
                                    $recv: #NameExpr['gsub!']
                                    $param: #List[
                                       $expression: #Regex['/ /']
                                       $expression: #StringExpr['+']
                                    ]
                                 ]
                                 $statement: #NameExpr['ret']
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['unescape_form']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['_unescape']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['str']
                                       $recv: #NameExpr['gsub']
                                       $param: #List[
                                          $expression: #Regex['/\\+/']
                                          $expression: #StringExpr[' ']
                                       ]
                                    ]
                                    $expression: #NameExpr['ESCAPED']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['escape_path']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['result']
                                    $right: #StringExpr['']
                                 ]
                                 $statement: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['str']
                                       $recv: #NameExpr['scan']
                                       $param: #List[
                                          $expression: #Regex['%r{/([^/]*)}']
                                       ]
                                    ]
                                    $recv: #NameExpr['each']
                                    $body: #Block[
                                       $param: #NameExpr['i']
                                       $body: #LShiftExpr[
                                          $left: #LShiftExpr[
                                             $left: #NameExpr['result']
                                             $right: #StringExpr['/']
                                          ]
                                          $right: #ApplyExpr[
                                             #Self['self']
                                             $recv: #NameExpr['_escape']
                                             $param: #List[
                                                $expression: #Indexer[
                                                   $recv: #NameExpr['i']
                                                   $index: #List[
                                                      $expression: #IntExpr['0']
                                                   ]
                                                ]
                                                $expression: #NameExpr['UNESCAPED_PCHAR']
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $statement: #RReturnStmt[
                                    $expr: #List[
                                       $expression: #NameExpr['result']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #FuncDecl[
                           $name: #NameExpr['escape8bit']
                           $param: #List[
                              $param: #Param[
                                 $param: #NameExpr['str']
                              ]
                           ]
                           $body: #BlockExpr[
                              $main: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['_escape']
                                 $param: #List[
                                    $expression: #NameExpr['str']
                                    $expression: #NameExpr['NONASCII']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
         ]
      ]
   ]
   #Comsumed['comsumed']
]
