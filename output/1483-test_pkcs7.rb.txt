#Source[
   #List[
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require_relative']
         $param: #List[
            $expression: #StringExpr['utils']
         ]
      ]
      $statement: #IfExpr[
         $cond: #Defined[
            $base: #Field[
               $recv: #NameExpr['OpenSSL']
               $name: #NameExpr['TestUtils']
            ]
         ]
         $then: #Class[
            $name: #NestedName[
               $path: #NameExpr['OpenSSL']
               $name: #NameExpr['TestPKCS7']
            ]
            $super: #Field[
               $recv: #NameExpr['OpenSSL']
               $name: #NameExpr['TestCase']
            ]
            $body: #BlockExpr[
               $main: #List[
                  $statement: #FuncDecl[
                     $name: #NameExpr['setup']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['@rsa1024']
                              $right: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['TestUtils']
                                 ]
                                 $name: #NameExpr['TEST_KEY_RSA1024']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['@rsa2048']
                              $right: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['TestUtils']
                                 ]
                                 $name: #NameExpr['TEST_KEY_RSA2048']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ca']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['Name']
                                 ]
                                 $recv: #NameExpr['parse']
                                 $param: #List[
                                    $expression: #StringExpr['/DC=org/DC=ruby-lang/CN=CA']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ee1']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['Name']
                                 ]
                                 $recv: #NameExpr['parse']
                                 $param: #List[
                                    $expression: #StringExpr['/DC=org/DC=ruby-lang/CN=EE1']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ee2']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['Name']
                                 ]
                                 $recv: #NameExpr['parse']
                                 $param: #List[
                                    $expression: #StringExpr['/DC=org/DC=ruby-lang/CN=EE2']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['now']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['Time']
                                 $recv: #NameExpr['now']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ca_exts']
                              $right: #Array[
                                 $index: #List[
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #StringExpr['basicConstraints']
                                          $expression: #StringExpr['CA:TRUE']
                                          $expression: #TrueExpr['true']
                                       ]
                                    ]
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #StringExpr['keyUsage']
                                          $expression: #StringExpr['keyCertSign, cRLSign']
                                          $expression: #TrueExpr['true']
                                       ]
                                    ]
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #StringExpr['subjectKeyIdentifier']
                                          $expression: #StringExpr['hash']
                                          $expression: #FalseExpr['false']
                                       ]
                                    ]
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #StringExpr['authorityKeyIdentifier']
                                          $expression: #StringExpr['keyid:always']
                                          $expression: #FalseExpr['false']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['@ca_cert']
                              $right: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['issue_cert']
                                 $param: #List[
                                    $expression: #NameExpr['ca']
                                    $expression: #NameExpr['@rsa2048']
                                    $expression: #IntExpr['1']
                                    $expression: #NameExpr['now']
                                    $expression: #AddExpr[
                                       $left: #NameExpr['now']
                                       $right: #IntExpr['3600']
                                    ]
                                    $expression: #NameExpr['ca_exts']
                                    $expression: #Nil['nil']
                                    $expression: #Nil['nil']
                                    $expression: #ApplyExpr[
                                       $recv: #Field[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['Digest']
                                          ]
                                          $name: #NameExpr['SHA1']
                                       ]
                                       $recv: #NameExpr['new']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ee_exts']
                              $right: #Array[
                                 $index: #List[
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #StringExpr['keyUsage']
                                          $expression: #StringExpr['Non Repudiation, Digital Signature, Key Encipherment']
                                          $expression: #TrueExpr['true']
                                       ]
                                    ]
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #StringExpr['authorityKeyIdentifier']
                                          $expression: #StringExpr['keyid:always']
                                          $expression: #FalseExpr['false']
                                       ]
                                    ]
                                    $expression: #Array[
                                       $index: #List[
                                          $expression: #StringExpr['extendedKeyUsage']
                                          $expression: #StringExpr['clientAuth, emailProtection, codeSigning']
                                          $expression: #FalseExpr['false']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['@ee1_cert']
                              $right: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['issue_cert']
                                 $param: #List[
                                    $expression: #NameExpr['ee1']
                                    $expression: #NameExpr['@rsa1024']
                                    $expression: #IntExpr['2']
                                    $expression: #NameExpr['now']
                                    $expression: #AddExpr[
                                       $left: #NameExpr['now']
                                       $right: #IntExpr['1800']
                                    ]
                                    $expression: #NameExpr['ee_exts']
                                    $expression: #NameExpr['@ca_cert']
                                    $expression: #NameExpr['@rsa2048']
                                    $expression: #ApplyExpr[
                                       $recv: #Field[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['Digest']
                                          ]
                                          $name: #NameExpr['SHA1']
                                       ]
                                       $recv: #NameExpr['new']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['@ee2_cert']
                              $right: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['issue_cert']
                                 $param: #List[
                                    $expression: #NameExpr['ee2']
                                    $expression: #NameExpr['@rsa1024']
                                    $expression: #IntExpr['3']
                                    $expression: #NameExpr['now']
                                    $expression: #AddExpr[
                                       $left: #NameExpr['now']
                                       $right: #IntExpr['1800']
                                    ]
                                    $expression: #NameExpr['ee_exts']
                                    $expression: #NameExpr['@ca_cert']
                                    $expression: #NameExpr['@rsa2048']
                                    $expression: #ApplyExpr[
                                       $recv: #Field[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['Digest']
                                          ]
                                          $name: #NameExpr['SHA1']
                                       ]
                                       $recv: #NameExpr['new']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['issue_cert']
                     $param: #List[
                        $param: #VariadicParam[
                           $name: #NameExpr['args']
                        ]
                     ]
                     $body: #BlockExpr[
                        $main: #ApplyExpr[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['TestUtils']
                           ]
                           $recv: #NameExpr['issue_cert']
                           $param: #List[
                              $variadic: #Variadic[
                                 $base: #NameExpr['args']
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_signed']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['store']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['Store']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['store']
                              $recv: #NameExpr['add_cert']
                              $param: #List[
                                 $expression: #NameExpr['@ca_cert']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ca_certs']
                              $right: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['@ca_cert']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['data']
                              $right: #StringExpr['aaaaa\\r\\nbbbbb\\r\\nccccc\\r\\n']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['tmp']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['sign']
                                 $param: #List[
                                    $expression: #NameExpr['@ee1_cert']
                                    $expression: #NameExpr['@rsa1024']
                                    $expression: #NameExpr['data']
                                    $expression: #NameExpr['ca_certs']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['tmp']
                                       $recv: #NameExpr['to_der']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['certs']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['certificates']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['signers']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['signers']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['verify']
                                    $param: #List[
                                       $expression: #Array['[]']
                                       $expression: #NameExpr['store']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['data']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['data']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['2']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['certs']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ee1_cert']
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['certs']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ca_cert']
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['certs']
                                          $index: #List[
                                             $expression: #IntExpr['1']
                                          ]
                                       ]
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['1']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['signers']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['@ee1_cert']
                                    $recv: #NameExpr['serial']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #Indexer[
                                       $recv: #NameExpr['signers']
                                       $index: #List[
                                          $expression: #IntExpr['0']
                                       ]
                                    ]
                                    $recv: #NameExpr['serial']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ee1_cert']
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['signers']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['data']
                              $right: #StringExpr['aaaaa\\nbbbbb\\nccccc\\n']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['flag']
                              $right: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $name: #NameExpr['BINARY']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['tmp']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['sign']
                                 $param: #List[
                                    $expression: #NameExpr['@ee1_cert']
                                    $expression: #NameExpr['@rsa1024']
                                    $expression: #NameExpr['data']
                                    $expression: #NameExpr['ca_certs']
                                    $expression: #NameExpr['flag']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['tmp']
                                       $recv: #NameExpr['to_der']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['certs']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['certificates']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['signers']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['signers']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['verify']
                                    $param: #List[
                                       $expression: #Array['[]']
                                       $expression: #NameExpr['store']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['data']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['data']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['2']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['certs']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ee1_cert']
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['certs']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ca_cert']
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['certs']
                                          $index: #List[
                                             $expression: #IntExpr['1']
                                          ]
                                       ]
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['1']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['signers']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['@ee1_cert']
                                    $recv: #NameExpr['serial']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #Indexer[
                                       $recv: #NameExpr['signers']
                                       $index: #List[
                                          $expression: #IntExpr['0']
                                       ]
                                    ]
                                    $recv: #NameExpr['serial']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ee1_cert']
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['signers']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['tmp1']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['sign']
                                 $param: #List[
                                    $expression: #NameExpr['@ee1_cert']
                                    $expression: #NameExpr['@rsa1024']
                                    $expression: #NameExpr['data']
                                    $expression: #Array['[]']
                                    $expression: #NameExpr['flag']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['tmp2']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['sign']
                                 $param: #List[
                                    $expression: #NameExpr['@ee2_cert']
                                    $expression: #NameExpr['@rsa1024']
                                    $expression: #NameExpr['data']
                                    $expression: #Array['[]']
                                    $expression: #NameExpr['flag']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['tmp1']
                              $recv: #NameExpr['add_signer']
                              $param: #List[
                                 $expression: #Indexer[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['tmp2']
                                       $recv: #NameExpr['signers']
                                    ]
                                    $index: #List[
                                       $expression: #IntExpr['0']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['tmp1']
                              $recv: #NameExpr['add_certificate']
                              $param: #List[
                                 $expression: #NameExpr['@ee2_cert']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['tmp1']
                                       $recv: #NameExpr['to_der']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['certs']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['certificates']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['signers']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['signers']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['verify']
                                    $param: #List[
                                       $expression: #Array['[]']
                                       $expression: #NameExpr['store']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['data']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['data']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['2']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['certs']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['2']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['signers']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['@ee1_cert']
                                    $recv: #NameExpr['serial']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #Indexer[
                                       $recv: #NameExpr['signers']
                                       $index: #List[
                                          $expression: #IntExpr['0']
                                       ]
                                    ]
                                    $recv: #NameExpr['serial']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ee1_cert']
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['signers']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['@ee2_cert']
                                    $recv: #NameExpr['serial']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #Indexer[
                                       $recv: #NameExpr['signers']
                                       $index: #List[
                                          $expression: #IntExpr['1']
                                       ]
                                    ]
                                    $recv: #NameExpr['serial']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ee2_cert']
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['signers']
                                          $index: #List[
                                             $expression: #IntExpr['1']
                                          ]
                                       ]
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_detached_sign']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['store']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['Store']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['store']
                              $recv: #NameExpr['add_cert']
                              $param: #List[
                                 $expression: #NameExpr['@ca_cert']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ca_certs']
                              $right: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['@ca_cert']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['data']
                              $right: #StringExpr['aaaaa\\nbbbbb\\nccccc\\n']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['flag']
                              $right: #OrExpr[
                                 $left: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['PKCS7']
                                    ]
                                    $name: #NameExpr['BINARY']
                                 ]
                                 $right: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['PKCS7']
                                    ]
                                    $name: #NameExpr['DETACHED']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['tmp']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['sign']
                                 $param: #List[
                                    $expression: #NameExpr['@ee1_cert']
                                    $expression: #NameExpr['@rsa1024']
                                    $expression: #NameExpr['data']
                                    $expression: #NameExpr['ca_certs']
                                    $expression: #NameExpr['flag']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['tmp']
                                       $recv: #NameExpr['to_der']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_nothing_raised']
                              $body: #Block[
                                 $body: #ApplyExpr[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['ASN1']
                                    ]
                                    $recv: #NameExpr['decode']
                                    $param: #List[
                                       $expression: #NameExpr['p7']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['certs']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['certificates']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['signers']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['signers']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert']
                              $param: #List[
                                 $expression: #NotExpr[
                                    $expr: #ApplyExpr[
                                       $recv: #NameExpr['p7']
                                       $recv: #NameExpr['verify']
                                       $param: #List[
                                          $expression: #Array['[]']
                                          $expression: #NameExpr['store']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['verify']
                                    $param: #List[
                                       $expression: #Array['[]']
                                       $expression: #NameExpr['store']
                                       $expression: #NameExpr['data']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['data']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['data']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['2']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['certs']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ee1_cert']
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['certs']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ca_cert']
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['certs']
                                          $index: #List[
                                             $expression: #IntExpr['1']
                                          ]
                                       ]
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['1']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['signers']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['@ee1_cert']
                                    $recv: #NameExpr['serial']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #Indexer[
                                       $recv: #NameExpr['signers']
                                       $index: #List[
                                          $expression: #IntExpr['0']
                                       ]
                                    ]
                                    $recv: #NameExpr['serial']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ee1_cert']
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['signers']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_enveloped']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['certs']
                              $right: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['@ee1_cert']
                                    $expression: #NameExpr['@ee2_cert']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['cipher']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['Cipher']
                                    ]
                                    $name: #NameExpr['AES']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #StringExpr['128-CBC']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['data']
                              $right: #StringExpr['aaaaa\\nbbbbb\\nccccc\\n']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['tmp']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['encrypt']
                                 $param: #List[
                                    $expression: #NameExpr['certs']
                                    $expression: #NameExpr['data']
                                    $expression: #NameExpr['cipher']
                                    $expression: #Field[
                                       $recv: #Field[
                                          $recv: #NameExpr['OpenSSL']
                                          $name: #NameExpr['PKCS7']
                                       ]
                                       $name: #NameExpr['BINARY']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['tmp']
                                       $recv: #NameExpr['to_der']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['recip']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['p7']
                                 $recv: #NameExpr['recipients']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['enveloped']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['type']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['2']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['recip']
                                    $recv: #NameExpr['size']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ca_cert']
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['recip']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['2']
                                 $expression: #ApplyExpr[
                                    $recv: #Indexer[
                                       $recv: #NameExpr['recip']
                                       $index: #List[
                                          $expression: #IntExpr['0']
                                       ]
                                    ]
                                    $recv: #NameExpr['serial']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['data']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['decrypt']
                                    $param: #List[
                                       $expression: #NameExpr['@rsa1024']
                                       $expression: #NameExpr['@ee1_cert']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['@ca_cert']
                                       $recv: #NameExpr['subject']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Indexer[
                                          $recv: #NameExpr['recip']
                                          $index: #List[
                                             $expression: #IntExpr['1']
                                          ]
                                       ]
                                       $recv: #NameExpr['issuer']
                                    ]
                                    $recv: #NameExpr['to_s']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #IntExpr['3']
                                 $expression: #ApplyExpr[
                                    $recv: #Indexer[
                                       $recv: #NameExpr['recip']
                                       $index: #List[
                                          $expression: #IntExpr['1']
                                       ]
                                    ]
                                    $recv: #NameExpr['serial']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['data']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['decrypt']
                                    $param: #List[
                                       $expression: #NameExpr['@rsa1024']
                                       $expression: #NameExpr['@ee2_cert']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_graceful_parsing_failure']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['contents']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['File']
                                 $recv: #NameExpr['read']
                                 $param: #List[
                                    $expression: #File['__FILE__']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_raise']
                              $param: #List[
                                 $expression: #NameExpr['ArgumentError']
                              ]
                              $body: #Block[
                                 $body: #ApplyExpr[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['PKCS7']
                                    ]
                                    $recv: #NameExpr['new']
                                    $param: #List[
                                       $expression: #NameExpr['contents']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_set_type_signed']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['p7']
                                 $name: #NameExpr['type']
                              ]
                              $right: #StringExpr['signed']
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['signed']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['type']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_set_type_data']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['p7']
                                 $name: #NameExpr['type']
                              ]
                              $right: #StringExpr['data']
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['data']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['type']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_set_type_signed_and_enveloped']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['p7']
                                 $name: #NameExpr['type']
                              ]
                              $right: #StringExpr['signedAndEnveloped']
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['signedAndEnveloped']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['type']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_set_type_enveloped']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['p7']
                                 $name: #NameExpr['type']
                              ]
                              $right: #StringExpr['enveloped']
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['enveloped']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['type']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_set_type_encrypted']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['p7']
                                 $name: #NameExpr['type']
                              ]
                              $right: #StringExpr['encrypted']
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['encrypted']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['type']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_degenerate_pkcs7']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['ca_cert_pem']
                              $right: #HereDocument['-----BEGIN CERTIFICATE-----\nMIID4DCCAsigAwIBAgIJAL1oVI72wmQwMA0GCSqGSIb3DQEBBQUAMFMxCzAJBgNV\nBAYTAkFVMQ4wDAYDVQQIEwVTdGF0ZTENMAsGA1UEBxMEQ2l0eTEQMA4GA1UEChMH\nRXhhbXBsZTETMBEGA1UEAxMKRXhhbXBsZSBDQTAeFw0xMjEwMTgwOTE2NTBaFw0y\nMjEwMTYwOTE2NTBaMFMxCzAJBgNVBAYTAkFVMQ4wDAYDVQQIEwVTdGF0ZTENMAsG\nA1UEBxMEQ2l0eTEQMA4GA1UEChMHRXhhbXBsZTETMBEGA1UEAxMKRXhhbXBsZSBD\nQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMTSPNxOkd5NN19XO0fJ\ntGVlWN4DWuvVL9WbWnXJXX9rU6X8sSOL9RrRA64eEZf2UBFjz9fMHZj/OGcxZpus\n4YtzfSrMU6xfvsIHeqX+mT60ms2RfX4UXab50MQArBin3JVKHGnOi25uyAOylVFU\nTuzzQJvKyB67vjuRPMlVAgVAZAP07ru9gW0ajt/ODxvUfvXxp5SFF68mVP2ipMBr\n4fujUwQC6cVHmnuL6p87VFoo9uk87TSQVDOQGL8MK4moMFtEW9oUTU22CgnxnCsS\nsCCELYhy9BdaTWQH26LzMfhnwSuIRHZyprW4WZtU0akrYXNiCj8o92rZmQWXJDbl\nqNECAwEAAaOBtjCBszAdBgNVHQ4EFgQUNtVw4jvkZZbkdQbkYi2/F4QN79owgYMG\nA1UdIwR8MHqAFDbVcOI75GWW5HUG5GItvxeEDe/aoVekVTBTMQswCQYDVQQGEwJB\nVTEOMAwGA1UECBMFU3RhdGUxDTALBgNVBAcTBENpdHkxEDAOBgNVBAoTB0V4YW1w\nbGUxEzARBgNVBAMTCkV4YW1wbGUgQ0GCCQC9aFSO9sJkMDAMBgNVHRMEBTADAQH/\nMA0GCSqGSIb3DQEBBQUAA4IBAQBvJIsY9bIqliZ3WD1KoN4cvAQeRAPsoLXQkkHg\nP6Nrcw9rJ5JvoHfYbo5aNlwbnkbt/B2xlVEXUYpJoBZFXafgxG2gJleioIgnaDS4\nFPPwZf1C5ZrOgUBfxTGjHex4ghSAoNGOd35jQzin5NGKOvZclPjZ2vQ++LP3aA2l\n9Fn2qASS46IzMGJlC75mlTOTQwDM16UunMAK26lNG9J6q02o4d/oU2a7x0fD80yF\n64kNA1wDAwaVCYiUH541qKp+b4iDqer8nf8HqzYDFlpje18xYZMEd1hj8dVOharM\npISJ+D52hV/BGEYF8r5k3hpC5d76gSP2oCcaY0XvLBf97qik\n-----END CERTIFICATE-----\n']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['p7']
                                 $name: #NameExpr['type']
                              ]
                              $right: #StringExpr['signed']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ca_cert']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['Certificate']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #NameExpr['ca_cert_pem']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $base: #NameExpr['p7']
                              $recv: #NameExpr['add_certificate']
                              $param: #List[
                                 $expression: #NameExpr['ca_cert']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $base: #NameExpr['p7']
                              $recv: #NameExpr['add_data']
                              $param: #List[
                                 $expression: #StringExpr['']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_nothing_raised']
                              $body: #Block[
                                 $body: #ApplyExpr[
                                    $recv: #NameExpr['p7']
                                    $recv: #NameExpr['to_pem']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['test_split_content']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['pki_message_pem']
                              $right: #HereDocument['-----BEGIN PKCS7-----\nMIIHSwYJKoZIhvcNAQcCoIIHPDCCBzgCAQExCzAJBgUrDgMCGgUAMIIDiAYJKoZI\nhvcNAQcBoIIDeQSCA3UwgAYJKoZIhvcNAQcDoIAwgAIBADGCARAwggEMAgEAMHUw\ncDEQMA4GA1UECgwHZXhhbXBsZTEXMBUGA1UEAwwOVEFSTUFDIFJPT1QgQ0ExIjAg\nBgkqhkiG9w0BCQEWE3NvbWVvbmVAZXhhbXBsZS5vcmcxCzAJBgNVBAYTAlVTMRIw\nEAYDVQQHDAlUb3duIEhhbGwCAWYwDQYJKoZIhvcNAQEBBQAEgYBspXXse8ZhG1FE\nE3PVAulbvrdR52FWPkpeLvSjgEkYzTiUi0CC3poUL1Ku5mOlavWAJgoJpFICDbvc\nN4ZNDCwOhnzoI9fMGmm1gvPQy15BdhhZRo9lP7Ga/Hg2APKT0/0yhPsmJ+w+u1e7\nOoJEVeEZ27x3+u745bGEcu8of5th6TCABgkqhkiG9w0BBwEwFAYIKoZIhvcNAwcE\nCBNs2U5mMsd/oIAEggIQU6cur8QBz02/4eMpHdlU9IkyrRMiaMZ/ky9zecOAjnvY\nd2jZqS7RhczpaNJaSli3GmDsKrF+XqE9J58s9ScGqUigzapusTsxIoRUPr7Ztb0a\npg8VWDipAsuw7GfEkgx868sV93uC4v6Isfjbhd+JRTFp/wR1kTi7YgSXhES+RLUW\ngQbDIDgEQYxJ5U951AJtnSpjs9za2ZkTdd8RSEizJK0bQ1vqLoApwAVgZqluATqQ\nAHSDCxhweVYw6+y90B9xOrqPC0eU7Wzryq2+Raq5ND2Wlf5/N11RQ3EQdKq/l5Te\nijp9PdWPlkUhWVoDlOFkysjk+BE+7AkzgYvz9UvBjmZsMsWqf+KsZ4S8/30ndLzu\niucsu6eOnFLLX8DKZxV6nYffZOPzZZL8hFBcE7PPgSdBEkazMrEBXq1j5mN7exbJ\nNOA5uGWyJNBMOCe+1JbxG9UeoqvCCTHESxEeDu7xR3NnSOD47n7cXwHr81YzK2zQ\n5oWpP3C8jzI7tUjLd1S0Z3Psd17oaCn+JOfUtuB0nc3wfPF/WPo0xZQodWxp2/Cl\nEltR6qr1zf5C7GwmLzBZ6bHFAIT60/JzV0/56Pn8ztsRFtI4cwaBfTfvnwi8/sD9\n/LYOMY+/b6UDCUSR7RTN7XfrtAqDEzSdzdJkOWm1jvM8gkLmxpZdvxG3ZvDYnEQE\n5Nq+un5nAny1wf3rWierBAjE5ntiAmgs5AAAAAAAAAAAAACgggHqMIIB5jCCAU+g\nAwIBAgIBATANBgkqhkiG9w0BAQUFADAvMS0wKwYDVQQDEyQwQUM5RjAyNi1EQ0VB\nLTRDMTItOTEyNy1DMEZEN0QyQThCNUEwHhcNMTIxMDE5MDk0NTQ3WhcNMTMxMDE5\nMDk0NTQ3WjAvMS0wKwYDVQQDEyQwQUM5RjAyNi1EQ0VBLTRDMTItOTEyNy1DMEZE\nN0QyQThCNUEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBALTsTNyGIsKvyw56\nWI3Gll/RmjsupkrdEtPbx7OjS9MEgyhOAf9+u6CV0LJGHpy7HUeROykF6xpbSdCm\nMr6kNObl5N0ljOb8OmV4atKjmGg1rWawDLyDQ9Dtuby+dzfHtzAzP+J/3ZoOtSqq\nAHVTnCclU1pm/uHN0HZ5nL5iLJTvAgMBAAGjEjAQMA4GA1UdDwEB/wQEAwIFoDAN\nBgkqhkiG9w0BAQUFAAOBgQA8K+BouEV04HRTdMZd3akjTQOm6aEGW4nIRnYIf8ZV\nmvUpLirVlX/unKtJinhGisFGpuYLMpemx17cnGkBeLCQRvHQjC+ho7l8/LOGheMS\nnvu0XHhvmJtRbm8MKHhogwZqHFDnXonvjyqhnhEtK5F2Fimcce3MoF2QtEe0UWv/\n8DGCAaowggGmAgEBMDQwLzEtMCsGA1UEAxMkMEFDOUYwMjYtRENFQS00QzEyLTkx\nMjctQzBGRDdEMkE4QjVBAgEBMAkGBSsOAwIaBQCggc0wEgYKYIZIAYb4RQEJAjEE\nEwIxOTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0x\nMjEwMTkwOTQ1NDdaMCAGCmCGSAGG+EUBCQUxEgQQ2EFUJdQNwQDxclIQ8qNyYzAj\nBgkqhkiG9w0BCQQxFgQUy8GFXPpAwRJUT3rdvNC9Pn+4eoswOAYKYIZIAYb4RQEJ\nBzEqEygwRkU3QzJEQTVEMDc2NzFFOTcxNDlCNUE3MDRCMERDNkM4MDYwRDJBMA0G\nCSqGSIb3DQEBAQUABIGAWUNdzvU2iiQOtihBwF0h48Nnw/2qX8uRjg6CVTOMcGji\nBxjUMifEbT//KJwljshl4y3yBLqeVYLOd04k6aKSdjgdZnrnUPI6p5tL5PfJkTAE\nL6qflZ9YCU5erE4T5U98hCQBMh4nOYxgaTjnZzhpkKQuEiKq/755cjzTzlI/eok=\n-----END PKCS7-----\n']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['pki_message_content_pem']
                              $right: #HereDocument['-----BEGIN PKCS7-----\nMIIDawYJKoZIhvcNAQcDoIIDXDCCA1gCAQAxggEQMIIBDAIBADB1MHAxEDAOBgNV\nBAoMB2V4YW1wbGUxFzAVBgNVBAMMDlRBUk1BQyBST09UIENBMSIwIAYJKoZIhvcN\nAQkBFhNzb21lb25lQGV4YW1wbGUub3JnMQswCQYDVQQGEwJVUzESMBAGA1UEBwwJ\nVG93biBIYWxsAgFmMA0GCSqGSIb3DQEBAQUABIGAbKV17HvGYRtRRBNz1QLpW763\nUedhVj5KXi70o4BJGM04lItAgt6aFC9SruZjpWr1gCYKCaRSAg273DeGTQwsDoZ8\n6CPXzBpptYLz0MteQXYYWUaPZT+xmvx4NgDyk9P9MoT7JifsPrtXuzqCRFXhGdu8\nd/ru+OWxhHLvKH+bYekwggI9BgkqhkiG9w0BBwEwFAYIKoZIhvcNAwcECBNs2U5m\nMsd/gIICGFOnLq/EAc9Nv+HjKR3ZVPSJMq0TImjGf5Mvc3nDgI572Hdo2aku0YXM\n6WjSWkpYtxpg7Cqxfl6hPSefLPUnBqlIoM2qbrE7MSKEVD6+2bW9GqYPFVg4qQLL\nsOxnxJIMfOvLFfd7guL+iLH424XfiUUxaf8EdZE4u2IEl4REvkS1FoEGwyA4BEGM\nSeVPedQCbZ0qY7Pc2tmZE3XfEUhIsyStG0Nb6i6AKcAFYGapbgE6kAB0gwsYcHlW\nMOvsvdAfcTq6jwtHlO1s68qtvkWquTQ9lpX+fzddUUNxEHSqv5eU3oo6fT3Vj5ZF\nIVlaA5ThZMrI5PgRPuwJM4GL8/VLwY5mbDLFqn/irGeEvP99J3S87ornLLunjpxS\ny1/AymcVep2H32Tj82WS/IRQXBOzz4EnQRJGszKxAV6tY+Zje3sWyTTgObhlsiTQ\nTDgnvtSW8RvVHqKrwgkxxEsRHg7u8UdzZ0jg+O5+3F8B6/NWMyts0OaFqT9wvI8y\nO7VIy3dUtGdz7Hde6Ggp/iTn1LbgdJ3N8Hzxf1j6NMWUKHVsadvwpRJbUeqq9c3+\nQuxsJi8wWemxxQCE+tPyc1dP+ej5/M7bERbSOHMGgX03758IvP7A/fy2DjGPv2+l\nAwlEke0Uze1367QKgxM0nc3SZDlptY7zPIJC5saWXb8Rt2bw2JxEBOTavrp+ZwJ8\ntcH961onq8Tme2ICaCzk\n-----END PKCS7-----\n']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['pki_msg']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #NameExpr['pki_message_pem']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['store']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['Store']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['pki_msg']
                              $recv: #NameExpr['verify']
                              $param: #List[
                                 $expression: #Nil['nil']
                                 $expression: #NameExpr['store']
                                 $expression: #Nil['nil']
                                 $expression: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['PKCS7']
                                    ]
                                    $name: #NameExpr['NOVERIFY']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['p7enc']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['PKCS7']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['pki_msg']
                                       $recv: #NameExpr['data']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['assert_equal']
                              $param: #List[
                                 $expression: #NameExpr['pki_message_content_pem']
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['p7enc']
                                    $recv: #NameExpr['to_pem']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
         ]
      ]
   ]
   #Comsumed['comsumed']
]
