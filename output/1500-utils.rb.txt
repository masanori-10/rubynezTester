#Source[
   #List[
      $statement: #ExceptionBlock[
         $main: #List[
            $statement: #ApplyExpr[
               #Self['self']
               $recv: #NameExpr['require']
               $param: #List[
                  $expression: #StringExpr['openssl']
               ]
            ]
            $statement: #AssignExpr[
               $left: #Field[
                  $base: #NameExpr['OpenSSL']
                  $name: #NameExpr['fips_mode']
               ]
               $right: #FalseExpr['false']
            ]
         ]
         $rescue: #List[
            $rescue: #Rescue[
               $class: #NameExpr['LoadError']
               $then: #Empty['']
            ]
         ]
      ]
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['test/unit']
         ]
      ]
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['digest/md5']
         ]
      ]
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['tempfile']
         ]
      ]
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['rbconfig']
         ]
      ]
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['socket']
         ]
      ]
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['envutil']
         ]
      ]
      $statement: #IfExpr[
         $then: #Module[
            $name: #NestedName[
               $path: #NameExpr['OpenSSL']
               $name: #NameExpr['TestUtils']
            ]
            $body: #BlockExpr[
               $main: #List[
                  $statement: #AssignExpr[
                     $left: #NameExpr['TEST_KEY_RSA1024']
                     $right: #ApplyExpr[
                        $base: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['PKey']
                           ]
                           $name: #NameExpr['RSA']
                        ]
                        $recv: #NameExpr['new']
                        $param: #List[
                           $expression: #HereDocument['-----BEGIN RSA PRIVATE KEY-----\nMIICXgIBAAKBgQDLwsSw1ECnPtT+PkOgHhcGA71nwC2/nL85VBGnRqDxOqjVh7Cx\naKPERYHsk4BPCkE3brtThPWc9kjHEQQ7uf9Y1rbCz0layNqHyywQEVLFmp1cpIt/\nQ3geLv8ZD9pihowKJDyMDiN6ArYUmZczvW4976MU3+l54E6lF/JfFEU5hwIDAQAB\nAoGBAKSl/MQarye1yOysqX6P8fDFQt68VvtXkNmlSiKOGuzyho0M+UVSFcs6k1L0\nmaDE25AMZUiGzuWHyaU55d7RXDgeskDMakD1v6ZejYtxJkSXbETOTLDwUWTn618T\ngnb17tU1jktUtU67xK/08i/XodlgnQhs6VoHTuCh3Hu77O6RAkEA7+gxqBuZR572\n74/akiW/SuXm0SXPEviyO1MuSRwtI87B02D0qgV8D1UHRm4AhMnJ8MCs1809kMQE\nJiQUCrp9mQJBANlt2ngBO14us6NnhuAseFDTBzCHXwUUu1YKHpMMmxpnGqaldGgX\nsOZB3lgJsT9VlGf3YGYdkLTNVbogQKlKpB8CQQDiSwkb4vyQfDe8/NpU5Not0fII\n8jsDUCb+opWUTMmfbxWRR3FBNu8wnym/m19N4fFj8LqYzHX4KY0oVPu6qvJxAkEA\nwa5snNekFcqONLIE4G5cosrIrb74sqL8GbGb+KuTAprzj5z1K8Bm0UW9lTjVDjDi\nqRYgZfZSL+x1P/54+xTFSwJAY1FxA/N3QPCXCjPh5YqFxAMQs2VVYTfg+t0MEcJD\ndPMQD5JX6g5HKnHFg2mZtoXQrWmJSn7p8GJK8yNTopEErA==\n-----END RSA PRIVATE KEY-----\n']
                        ]
                     ]
                  ]
                  $statement: #AssignExpr[
                     $left: #NameExpr['TEST_KEY_RSA2048']
                     $right: #ApplyExpr[
                        $base: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['PKey']
                           ]
                           $name: #NameExpr['RSA']
                        ]
                        $recv: #NameExpr['new']
                        $param: #List[
                           $expression: #HereDocument['-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAuV9ht9J7k4NBs38jOXvvTKY9gW8nLICSno5EETR1cuF7i4pN\ns9I1QJGAFAX0BEO4KbzXmuOvfCpD3CU+Slp1enenfzq/t/e/1IRW0wkJUJUFQign\n4CtrkJL+P07yx18UjyPlBXb81ApEmAB5mrJVSrWmqbjs07JbuS4QQGGXLc+Su96D\nkYKmSNVjBiLxVVSpyZfAY3hD37d60uG+X8xdW5v68JkRFIhdGlb6JL8fllf/A/bl\nNwdJOhVr9mESHhwGjwfSeTDPfd8ZLE027E5lyAVX9KZYcU00mOX+fdxOSnGqS/8J\nDRh0EPHDL15RcJjV2J6vZjPb0rOYGDoMcH+94wIDAQABAoIBAAzsamqfYQAqwXTb\nI0CJtGg6msUgU7HVkOM+9d3hM2L791oGHV6xBAdpXW2H8LgvZHJ8eOeSghR8+dgq\nPIqAffo4x1Oma+FOg3A0fb0evyiACyrOk+EcBdbBeLo/LcvahBtqnDfiUMQTpy6V\nseSoFCwuN91TSCeGIsDpRjbG1vxZgtx+uI+oH5+ytqJOmfCksRDCkMglGkzyfcl0\nXc5CUhIJ0my53xijEUQl19rtWdMnNnnkdbG8PT3LZlOta5Do86BElzUYka0C6dUc\nVsBDQ0Nup0P6rEQgy7tephHoRlUGTYamsajGJaAo1F3IQVIrRSuagi7+YpSpCqsW\nwORqorkCgYEA7RdX6MDVrbw7LePnhyuaqTiMK+055/R1TqhB1JvvxJ1CXk2rDL6G\n0TLHQ7oGofd5LYiemg4ZVtWdJe43BPZlVgT6lvL/iGo8JnrncB9Da6L7nrq/+Rvj\nXGjf1qODCK+LmreZWEsaLPURIoR/Ewwxb9J2zd0CaMjeTwafJo1CZvcCgYEAyCgb\naqoWvUecX8VvARfuA593Lsi50t4MEArnOXXcd1RnXoZWhbx5rgO8/ATKfXr0BK/n\nh2GF9PfKzHFm/4V6e82OL7gu/kLy2u9bXN74vOvWFL5NOrOKPM7Kg+9I131kNYOw\nIvnr/VtHE5s0dY7JChYWE1F3vArrOw3T00a4CXUCgYEA0SqY+dS2LvIzW4cHCe9k\nIQqsT0yYm5TFsUEr4sA3xcPfe4cV8sZb9k/QEGYb1+SWWZ+AHPV3UW5fl8kTbSNb\nv4ng8i8rVVQ0ANbJO9e5CUrepein2MPL0AkOATR8M7t7dGGpvYV0cFk8ZrFx0oId\nU0PgYDotF/iueBWlbsOM430CgYEAqYI95dFyPI5/AiSkY5queeb8+mQH62sdcCCr\nvd/w/CZA/K5sbAo4SoTj8dLk4evU6HtIa0DOP63y071eaxvRpTNqLUOgmLh+D6gS\nCc7TfLuFrD+WDBatBd5jZ+SoHccVrLR/4L8jeodo5FPW05A+9gnKXEXsTxY4LOUC\n9bS4e1kCgYAqVXZh63JsMwoaxCYmQ66eJojKa47VNrOeIZDZvd2BPVf30glBOT41\ngBoDG3WMPZoQj9pb7uMcrnvs4APj2FIhMU8U15LcPAj59cD6S6rWnAxO8NFK7HQG\n4Jxg3JNNf8ErQoCHb1B3oVdXJkmbJkARoDpBKmTCgKtP8ADYLmVPQw==\n-----END RSA PRIVATE KEY-----\n']
                        ]
                     ]
                  ]
                  $statement: #AssignExpr[
                     $left: #NameExpr['TEST_KEY_DSA256']
                     $right: #ApplyExpr[
                        $base: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['PKey']
                           ]
                           $name: #NameExpr['DSA']
                        ]
                        $recv: #NameExpr['new']
                        $param: #List[
                           $expression: #HereDocument['-----BEGIN DSA PRIVATE KEY-----\nMIH3AgEAAkEAhk2libbY2a8y2Pt21+YPYGZeW6wzaW2yfj5oiClXro9XMR7XWLkE\n9B7XxLNFCS2gmCCdMsMW1HulaHtLFQmB2wIVAM43JZrcgpu6ajZ01VkLc93gu/Ed\nAkAOhujZrrKV5CzBKutKLb0GVyVWmdC7InoNSMZEeGU72rT96IjM59YzoqmD0pGM\n3I1o4cGqg1D1DfM1rQlnN1eSAkBq6xXfEDwJ1mLNxF6q8Zm/ugFYWR5xcX/3wFiT\nb4+EjHP/DbNh9Vm5wcfnDBJ1zKvrMEf2xqngYdrV/3CiGJeKAhRvL57QvJZcQGvn\nISNX5cMzFHRW3Q==\n-----END DSA PRIVATE KEY-----\n']
                        ]
                     ]
                  ]
                  $statement: #AssignExpr[
                     $left: #NameExpr['TEST_KEY_DSA512']
                     $right: #ApplyExpr[
                        $base: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['PKey']
                           ]
                           $name: #NameExpr['DSA']
                        ]
                        $recv: #NameExpr['new']
                        $param: #List[
                           $expression: #HereDocument['-----BEGIN DSA PRIVATE KEY-----\nMIH4AgEAAkEA5lB4GvEwjrsMlGDqGsxrbqeFRh6o9OWt6FgTYiEEHaOYhkIxv0Ok\nRZPDNwOG997mDjBnvDJ1i56OmS3MbTnovwIVAJgub/aDrSDB4DZGH7UyarcaGy6D\nAkB9HdFw/3td8K4l1FZHv7TCZeJ3ZLb7dF3TWoGUP003RCqoji3/lHdKoVdTQNuR\nS/m6DlCwhjRjiQ/lBRgCLCcaAkEAjN891JBjzpMj4bWgsACmMggFf57DS0Ti+5++\nQ1VB8qkJN7rA7/2HrCR3gTsWNb1YhAsnFsoeRscC+LxXoXi9OAIUBG98h4tilg6S\n55jreJD3Se3slps=\n-----END DSA PRIVATE KEY-----\n']
                        ]
                     ]
                  ]
                  $statement: #AssignExpr[
                     $left: #NameExpr['TEST_KEY_DSA1024']
                     $right: #ApplyExpr[
                        $base: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['PKey']
                           ]
                           $name: #NameExpr['DSA']
                        ]
                        $recv: #NameExpr['new']
                        $param: #List[
                           $expression: #HereDocument['-----BEGIN DSA PRIVATE KEY-----\nMIIBugIBAAKBgQCH9aAoXvWWThIjkA6D+nI1F9ksF9iDq594rkiGNOT9sPDOdB+n\nD+qeeeeloRlj19ymCSADPI0ZLRgkchkAEnY2RnqnhHOjVf/roGgRbW+iQDMbQ9wa\n/pvc6/fAbsu1goE1hBYjm98/sZEeXavj8tR56IXnjF1b6Nx0+sgeUKFKEQIVAMiz\n4BJUFeTtddyM4uadBM7HKLPRAoGAZdLBSYNGiij7vAjesF5mGUKTIgPd+JKuBEDx\nOaBclsgfdoyoF/TMOkIty+PVlYD+//Vl2xnoUEIRaMXHwHfm0r2xUX++oeRaSScg\nYizJdUxe5jvBuBszGPRc/mGpb9YvP0sB+FL1KmuxYmdODfCe51zl8uM/CVhouJ3w\nDjmRGscCgYAuFlfC7p+e8huCKydfcv/beftqjewiOPpQ3u5uI6KPCtCJPpDhs3+4\nIihH2cPsAlqwGF4tlibW1+/z/OZ1AZinPK3y7b2jSJASEaPeEltVzB92hcd1khk2\njTYcmSsV4VddplOPK9czytR/GbbibxsrhhgZUbd8LPbvIgaiadJ1PgIUBnJ/5vN2\nCVArsEzlPUCbohPvZnE=\n-----END DSA PRIVATE KEY-----\n']
                        ]
                     ]
                  ]
                  $statement: #IfExpr[
                     $cond: #Defined[
                        $base: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['PKey']
                           ]
                           $name: #NameExpr['EC']
                        ]
                     ]
                     $then: #AssignExpr[
                        $left: #NameExpr['TEST_KEY_EC_P256V1']
                        $right: #ApplyExpr[
                           $base: #Field[
                              $recv: #Field[
                                 $recv: #NameExpr['OpenSSL']
                                 $name: #NameExpr['PKey']
                              ]
                              $name: #NameExpr['EC']
                           ]
                           $recv: #NameExpr['new']
                           $param: #List[
                              $expression: #HereDocument['-----BEGIN EC PRIVATE KEY-----\nMHcCAQEEIID49FDqcf1O1eO8saTgG70UbXQw9Fqwseliit2aWhH1oAoGCCqGSM49\nAwEHoUQDQgAEFglk2c+oVUIKQ64eZG9bhLNPWB7lSZ/ArK41eGy5wAzU/0G51Xtt\nCeBUl+MahZtn9fO1JKdF4qJmS39dXnpENg==\n-----END EC PRIVATE KEY-----\n']
                           ]
                        ]
                     ]
                  ]
                  $statement: #AssignExpr[
                     $left: #NameExpr['TEST_KEY_DH1024']
                     $right: #ApplyExpr[
                        $base: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['PKey']
                           ]
                           $name: #NameExpr['DH']
                        ]
                        $recv: #NameExpr['new']
                        $param: #List[
                           $expression: #HereDocument['-----BEGIN DH PARAMETERS-----\nMIGHAoGBAKnKQ8MNK6nYZzLrrcuTsLxuiJGXoOO5gT+tljOTbHBuiktdMTITzIY0\npFxIvjG05D7HoBZQfrR0c92NGWPkAiCkhQKB8JCbPVzwNLDy6DZ0pmofDKrEsYHG\nAQjjxMXhwULlmuR/K+WwlaZPiLIBYalLAZQ7ZbOPeVkJ8ePao0eLAgEC\n-----END DH PARAMETERS-----\n']
                        ]
                     ]
                  ]
                  $statement: #ApplyExpr[
                     $recv: #NameExpr['TEST_KEY_DH1024']
                     $recv: #NameExpr['set_key']
                     $param: #List[
                        $expression: #ApplyExpr[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['BN']
                           ]
                           $recv: #NameExpr['new']
                           $param: #List[
                              $expression: #StringExpr['556AF1598AE69899867CEBA9F29CE4862B884C2B43C9019EA0231908F6EFA785E3C462A6ECB16DF676866E997FFB72B487DC7967C58C3CA38CE974473BF19B2AA5DCBF102735572EBA6F353F6F0BBE7FF1DE1B07FE1381A355C275C33405004317F9491B5955F191F6615A63B30E55A027FB88A1A4B25608E09EEE68A7DF32D']
                              $expression: #IntExpr['16']
                           ]
                        ]
                        $expression: #ApplyExpr[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['BN']
                           ]
                           $recv: #NameExpr['new']
                           $param: #List[
                              $expression: #StringExpr['48561834C67E65FFD2A9B47F41E5E78FDC95C387428FDB1E4B0188B64D1643C3A8D3455B945B7E8C4D166010C7C2CE23BFB9BEF43D0348FE7FA5284B0225E7FE1537546D114E3D8A4411B9B9351AB451E1A358F50ED61B1F00DA29336EEBBD649980AC86D76AF8BBB065298C2052672EEF3EF13AB47A15275FC2836F3AC74CEA']
                              $expression: #IntExpr['16']
                           ]
                        ]
                     ]
                  ]
                  $statement: #AssignExpr[
                     $left: #NameExpr['DSA_SIGNATURE_DIGEST']
                     $right: #Conditional[
                        $cond: #GtExpr[
                           $left: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['OPENSSL_VERSION_NUMBER']
                           ]
                           $right: #HexInteger['0x10000000']
                        ]
                        $then: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['Digest']
                           ]
                           $name: #NameExpr['SHA1']
                        ]
                        $else: #Field[
                           $recv: #Field[
                              $recv: #NameExpr['OpenSSL']
                              $name: #NameExpr['Digest']
                           ]
                           $name: #NameExpr['DSS1']
                        ]
                     ]
                  ]
                  $statement: #NameExpr['module_function']
                  $statement: #FuncDecl[
                     $name: #NameExpr['issue_cert']
                     $param: #List[
                        $param: #Param[
                           $param: #NameExpr['dn']
                        ]
                        $param: #Param[
                           $param: #NameExpr['key']
                        ]
                        $param: #Param[
                           $param: #NameExpr['serial']
                        ]
                        $param: #Param[
                           $param: #NameExpr['not_before']
                        ]
                        $param: #Param[
                           $param: #NameExpr['not_after']
                        ]
                        $param: #Param[
                           $param: #NameExpr['extensions']
                        ]
                        $param: #Param[
                           $param: #NameExpr['issuer']
                        ]
                        $param: #Param[
                           $param: #NameExpr['issuer_key']
                        ]
                        $param: #Param[
                           $param: #NameExpr['digest']
                        ]
                     ]
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['cert']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['Certificate']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #Unless[
                              $then: #AssignExpr[
                                 $left: #NameExpr['issuer']
                                 $right: #NameExpr['cert']
                              ]
                              $cond: #NameExpr['issuer']
                           ]
                           $statement: #Unless[
                              $then: #AssignExpr[
                                 $left: #NameExpr['issuer_key']
                                 $right: #NameExpr['key']
                              ]
                              $cond: #NameExpr['issuer_key']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['cert']
                                 $name: #NameExpr['version']
                              ]
                              $right: #IntExpr['2']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['cert']
                                 $name: #NameExpr['serial']
                              ]
                              $right: #NameExpr['serial']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['cert']
                                 $name: #NameExpr['subject']
                              ]
                              $right: #NameExpr['dn']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['cert']
                                 $name: #NameExpr['issuer']
                              ]
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['issuer']
                                 $recv: #NameExpr['subject']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['cert']
                                 $name: #NameExpr['public_key']
                              ]
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['key']
                                 $recv: #NameExpr['public_key']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['cert']
                                 $name: #NameExpr['not_before']
                              ]
                              $right: #NameExpr['not_before']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['cert']
                                 $name: #NameExpr['not_after']
                              ]
                              $right: #NameExpr['not_after']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ef']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['ExtensionFactory']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['ef']
                                 $name: #NameExpr['subject_certificate']
                              ]
                              $right: #NameExpr['cert']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['ef']
                                 $name: #NameExpr['issuer_certificate']
                              ]
                              $right: #NameExpr['issuer']
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['extensions']
                              $recv: #NameExpr['each']
                              $body: #Block[
                                 $param: #MultipleLeftHandSideExpression[
                                    $item: #NameExpr['oid']
                                    $item: #NameExpr['value']
                                    $item: #NameExpr['critical']
                                 ]
                                 $body: #ApplyExpr[
                                    $recv: #NameExpr['cert']
                                    $recv: #NameExpr['add_extension']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['ef']
                                          $recv: #NameExpr['create_extension']
                                          $param: #List[
                                             $expression: #NameExpr['oid']
                                             $expression: #NameExpr['value']
                                             $expression: #NameExpr['critical']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['cert']
                              $recv: #NameExpr['sign']
                              $param: #List[
                                 $expression: #NameExpr['issuer_key']
                                 $expression: #NameExpr['digest']
                              ]
                           ]
                           $statement: #NameExpr['cert']
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['issue_crl']
                     $param: #List[
                        $param: #Param[
                           $param: #NameExpr['revoke_info']
                        ]
                        $param: #Param[
                           $param: #NameExpr['serial']
                        ]
                        $param: #Param[
                           $param: #NameExpr['lastup']
                        ]
                        $param: #Param[
                           $param: #NameExpr['nextup']
                        ]
                        $param: #Param[
                           $param: #NameExpr['extensions']
                        ]
                        $param: #Param[
                           $param: #NameExpr['issuer']
                        ]
                        $param: #Param[
                           $param: #NameExpr['issuer_key']
                        ]
                        $param: #Param[
                           $param: #NameExpr['digest']
                        ]
                     ]
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['crl']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['CRL']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['crl']
                                 $name: #NameExpr['issuer']
                              ]
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['issuer']
                                 $recv: #NameExpr['subject']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['crl']
                                 $name: #NameExpr['version']
                              ]
                              $right: #IntExpr['1']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['crl']
                                 $name: #NameExpr['last_update']
                              ]
                              $right: #NameExpr['lastup']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['crl']
                                 $name: #NameExpr['next_update']
                              ]
                              $right: #NameExpr['nextup']
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['revoke_info']
                              $recv: #NameExpr['each']
                              $body: #Block[
                                 $param: #MultipleLeftHandSideExpression[
                                    $item: #NameExpr['rserial']
                                    $item: #NameExpr['time']
                                    $item: #NameExpr['reason_code']
                                 ]
                                 $body: #List[
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['revoked']
                                       $right: #ApplyExpr[
                                          $recv: #Field[
                                             $recv: #Field[
                                                $recv: #NameExpr['OpenSSL']
                                                $name: #NameExpr['X509']
                                             ]
                                             $name: #NameExpr['Revoked']
                                          ]
                                          $recv: #NameExpr['new']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #Field[
                                          $base: #NameExpr['revoked']
                                          $name: #NameExpr['serial']
                                       ]
                                       $right: #NameExpr['rserial']
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #Field[
                                          $base: #NameExpr['revoked']
                                          $name: #NameExpr['time']
                                       ]
                                       $right: #NameExpr['time']
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['enum']
                                       $right: #ApplyExpr[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['ASN1']
                                          ]
                                          $recv: #NameExpr['Enumerated']
                                          $param: #List[
                                             $expression: #NameExpr['reason_code']
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['ext']
                                       $right: #ApplyExpr[
                                          $recv: #Field[
                                             $recv: #Field[
                                                $recv: #NameExpr['OpenSSL']
                                                $name: #NameExpr['X509']
                                             ]
                                             $name: #NameExpr['Extension']
                                          ]
                                          $recv: #NameExpr['new']
                                          $param: #List[
                                             $expression: #StringExpr['CRLReason']
                                             $expression: #NameExpr['enum']
                                          ]
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['revoked']
                                       $recv: #NameExpr['add_extension']
                                       $param: #List[
                                          $expression: #NameExpr['ext']
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['crl']
                                       $recv: #NameExpr['add_revoked']
                                       $param: #List[
                                          $expression: #NameExpr['revoked']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ef']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['X509']
                                    ]
                                    $name: #NameExpr['ExtensionFactory']
                                 ]
                                 $recv: #NameExpr['new']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['ef']
                                 $name: #NameExpr['issuer_certificate']
                              ]
                              $right: #NameExpr['issuer']
                           ]
                           $statement: #AssignExpr[
                              $left: #Field[
                                 $base: #NameExpr['ef']
                                 $name: #NameExpr['crl']
                              ]
                              $right: #NameExpr['crl']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['crlnum']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['ASN1']
                                 ]
                                 $recv: #NameExpr['Integer']
                                 $param: #List[
                                    $expression: #NameExpr['serial']
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['crl']
                              $recv: #NameExpr['add_extension']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #Field[
                                       $recv: #Field[
                                          $recv: #NameExpr['OpenSSL']
                                          $name: #NameExpr['X509']
                                       ]
                                       $name: #NameExpr['Extension']
                                    ]
                                    $recv: #NameExpr['new']
                                    $param: #List[
                                       $expression: #StringExpr['crlNumber']
                                       $expression: #NameExpr['crlnum']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['extensions']
                              $recv: #NameExpr['each']
                              $body: #Block[
                                 $param: #MultipleLeftHandSideExpression[
                                    $item: #NameExpr['oid']
                                    $item: #NameExpr['value']
                                    $item: #NameExpr['critical']
                                 ]
                                 $body: #ApplyExpr[
                                    $recv: #NameExpr['crl']
                                    $recv: #NameExpr['add_extension']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['ef']
                                          $recv: #NameExpr['create_extension']
                                          $param: #List[
                                             $expression: #NameExpr['oid']
                                             $expression: #NameExpr['value']
                                             $expression: #NameExpr['critical']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #NameExpr['crl']
                              $recv: #NameExpr['sign']
                              $param: #List[
                                 $expression: #NameExpr['issuer_key']
                                 $expression: #NameExpr['digest']
                              ]
                           ]
                           $statement: #NameExpr['crl']
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['get_subject_key_id']
                     $param: #List[
                        $param: #Param[
                           $param: #NameExpr['cert']
                        ]
                     ]
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['asn1_cert']
                              $right: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['OpenSSL']
                                    $name: #NameExpr['ASN1']
                                 ]
                                 $recv: #NameExpr['decode']
                                 $param: #List[
                                    $expression: #NameExpr['cert']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['tbscert']
                              $right: #Indexer[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['asn1_cert']
                                    $recv: #NameExpr['value']
                                 ]
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['pkinfo']
                              $right: #Indexer[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['tbscert']
                                    $recv: #NameExpr['value']
                                 ]
                                 $index: #List[
                                    $expression: #IntExpr['6']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['publickey']
                              $right: #Indexer[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['pkinfo']
                                    $recv: #NameExpr['value']
                                 ]
                                 $index: #List[
                                    $expression: #IntExpr['1']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['pkvalue']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['publickey']
                                 $recv: #NameExpr['value']
                              ]
                           ]
                           $statement: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Field[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['Digest']
                                          ]
                                          $name: #NameExpr['SHA1']
                                       ]
                                       $recv: #NameExpr['hexdigest']
                                       $param: #List[
                                          $expression: #NameExpr['pkvalue']
                                       ]
                                    ]
                                    $recv: #NameExpr['scan']
                                    $param: #List[
                                       $expression: #Regex['/../']
                                    ]
                                 ]
                                 $recv: #NameExpr['join']
                                 $param: #List[
                                    $expression: #StringExpr[':']
                                 ]
                              ]
                              $recv: #NameExpr['upcase']
                           ]
                        ]
                     ]
                  ]
                  $statement: #FuncDecl[
                     $name: #NameExpr['silent']
                     $param: #List['']
                     $body: #BlockExpr[
                        $main: #ExceptionBlock[
                           $main: #List[
                              $statement: #MultipleAssign[
                                 $left: #MultipleLeftHandSideExpression[
                                    $item: #NameExpr['back']
                                    $item: #NameExpr['$VERBOSE']
                                 ]
                                 $right: #MultipleRightHandSideExpression[
                                    $expression: #NameExpr['$VERBOSE']
                                    $expression: #Nil['nil']
                                 ]
                              ]
                              $statement: #Yield['yield']
                           ]
                           $ensure: #AssignExpr[
                              $left: #NameExpr['$VERBOSE']
                              $right: #NameExpr['back']
                           ]
                        ]
                     ]
                  ]
                  $statement: #Class[
                     $name: #NestedName[
                        $path: #NameExpr['OpenSSL']
                        $name: #NameExpr['TestCase']
                     ]
                     $super: #Field[
                        $recv: #Field[
                           $recv: #NameExpr['Test']
                           $name: #NameExpr['Unit']
                        ]
                        $name: #NameExpr['TestCase']
                     ]
                     $body: #BlockExpr[
                        $main: #FuncDecl[
                           $name: #NameExpr['teardown']
                           $param: #List['']
                           $body: #BlockExpr[
                              $main: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['assert_equal']
                                 $param: #List[
                                    $expression: #Array['[]']
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['OpenSSL']
                                       $recv: #NameExpr['errors']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #Class[
                     $name: #NestedName[
                        $path: #NameExpr['OpenSSL']
                        $name: #NameExpr['SSLTestCase']
                     ]
                     $super: #Field[
                        $recv: #NameExpr['OpenSSL']
                        $name: #NameExpr['TestCase']
                     ]
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['RUBY']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['EnvUtil']
                                 $recv: #NameExpr['rubybin']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['ITERATIONS']
                              $right: #Conditional[
                                 $cond: #EqExpr[
                                    $left: #BuiltInVariable['$0']
                                    $right: #File['__FILE__']
                                 ]
                                 $then: #IntExpr['100']
                                 $else: #IntExpr['10']
                              ]
                           ]
                           $statement: #FuncDecl[
                              $name: #NameExpr['setup']
                              $param: #List['']
                              $body: #BlockExpr[
                                 $main: #List[
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@ca_key']
                                       $right: #Field[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['TestUtils']
                                          ]
                                          $name: #NameExpr['TEST_KEY_RSA2048']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@svr_key']
                                       $right: #Field[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['TestUtils']
                                          ]
                                          $name: #NameExpr['TEST_KEY_RSA1024']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@cli_key']
                                       $right: #Field[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['TestUtils']
                                          ]
                                          $name: #NameExpr['TEST_KEY_DSA1024']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@ca']
                                       $right: #ApplyExpr[
                                          $recv: #Field[
                                             $recv: #Field[
                                                $recv: #NameExpr['OpenSSL']
                                                $name: #NameExpr['X509']
                                             ]
                                             $name: #NameExpr['Name']
                                          ]
                                          $recv: #NameExpr['parse']
                                          $param: #List[
                                             $expression: #StringExpr['/DC=org/DC=ruby-lang/CN=CA']
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@svr']
                                       $right: #ApplyExpr[
                                          $recv: #Field[
                                             $recv: #Field[
                                                $recv: #NameExpr['OpenSSL']
                                                $name: #NameExpr['X509']
                                             ]
                                             $name: #NameExpr['Name']
                                          ]
                                          $recv: #NameExpr['parse']
                                          $param: #List[
                                             $expression: #StringExpr['/DC=org/DC=ruby-lang/CN=localhost']
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@cli']
                                       $right: #ApplyExpr[
                                          $recv: #Field[
                                             $recv: #Field[
                                                $recv: #NameExpr['OpenSSL']
                                                $name: #NameExpr['X509']
                                             ]
                                             $name: #NameExpr['Name']
                                          ]
                                          $recv: #NameExpr['parse']
                                          $param: #List[
                                             $expression: #StringExpr['/DC=org/DC=ruby-lang/CN=localhost']
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['now']
                                       $right: #ApplyExpr[
                                          $recv: #NameExpr['Time']
                                          $recv: #NameExpr['at']
                                          $param: #List[
                                             $expression: #ApplyExpr[
                                                $recv: #ApplyExpr[
                                                   $recv: #NameExpr['Time']
                                                   $recv: #NameExpr['now']
                                                ]
                                                $recv: #NameExpr['to_i']
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['ca_exts']
                                       $right: #Array[
                                          $index: #List[
                                             $expression: #Array[
                                                $index: #List[
                                                   $expression: #StringExpr['basicConstraints']
                                                   $expression: #StringExpr['CA:TRUE']
                                                   $expression: #TrueExpr['true']
                                                ]
                                             ]
                                             $expression: #Array[
                                                $index: #List[
                                                   $expression: #StringExpr['keyUsage']
                                                   $expression: #StringExpr['cRLSign,keyCertSign']
                                                   $expression: #TrueExpr['true']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['ee_exts']
                                       $right: #Array[
                                          $index: #List[
                                             $expression: #Array[
                                                $index: #List[
                                                   $expression: #StringExpr['keyUsage']
                                                   $expression: #StringExpr['keyEncipherment,digitalSignature']
                                                   $expression: #TrueExpr['true']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@ca_cert']
                                       $right: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['issue_cert']
                                          $param: #List[
                                             $expression: #NameExpr['@ca']
                                             $expression: #NameExpr['@ca_key']
                                             $expression: #IntExpr['1']
                                             $expression: #NameExpr['now']
                                             $expression: #AddExpr[
                                                $left: #NameExpr['now']
                                                $right: #IntExpr['3600']
                                             ]
                                             $expression: #NameExpr['ca_exts']
                                             $expression: #Nil['nil']
                                             $expression: #Nil['nil']
                                             $expression: #ApplyExpr[
                                                $recv: #Field[
                                                   $recv: #Field[
                                                      $recv: #NameExpr['OpenSSL']
                                                      $name: #NameExpr['Digest']
                                                   ]
                                                   $name: #NameExpr['SHA1']
                                                ]
                                                $recv: #NameExpr['new']
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@svr_cert']
                                       $right: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['issue_cert']
                                          $param: #List[
                                             $expression: #NameExpr['@svr']
                                             $expression: #NameExpr['@svr_key']
                                             $expression: #IntExpr['2']
                                             $expression: #NameExpr['now']
                                             $expression: #AddExpr[
                                                $left: #NameExpr['now']
                                                $right: #IntExpr['1800']
                                             ]
                                             $expression: #NameExpr['ee_exts']
                                             $expression: #NameExpr['@ca_cert']
                                             $expression: #NameExpr['@ca_key']
                                             $expression: #ApplyExpr[
                                                $recv: #Field[
                                                   $recv: #Field[
                                                      $recv: #NameExpr['OpenSSL']
                                                      $name: #NameExpr['Digest']
                                                   ]
                                                   $name: #NameExpr['SHA1']
                                                ]
                                                $recv: #NameExpr['new']
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@cli_cert']
                                       $right: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['issue_cert']
                                          $param: #List[
                                             $expression: #NameExpr['@cli']
                                             $expression: #NameExpr['@cli_key']
                                             $expression: #IntExpr['3']
                                             $expression: #NameExpr['now']
                                             $expression: #AddExpr[
                                                $left: #NameExpr['now']
                                                $right: #IntExpr['1800']
                                             ]
                                             $expression: #NameExpr['ee_exts']
                                             $expression: #NameExpr['@ca_cert']
                                             $expression: #NameExpr['@ca_key']
                                             $expression: #ApplyExpr[
                                                $recv: #Field[
                                                   $recv: #Field[
                                                      $recv: #NameExpr['OpenSSL']
                                                      $name: #NameExpr['Digest']
                                                   ]
                                                   $name: #NameExpr['SHA1']
                                                ]
                                                $recv: #NameExpr['new']
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@server']
                                       $right: #Nil['nil']
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #FuncDecl[
                              $name: #NameExpr['issue_cert']
                              $param: #List[
                                 $param: #VariadicParam[
                                    $name: #NameExpr['arg']
                                 ]
                              ]
                              $body: #BlockExpr[
                                 $main: #ApplyExpr[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['TestUtils']
                                    ]
                                    $recv: #NameExpr['issue_cert']
                                    $param: #List[
                                       $variadic: #Variadic[
                                          $base: #NameExpr['arg']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #FuncDecl[
                              $name: #NameExpr['issue_crl']
                              $param: #List[
                                 $param: #VariadicParam[
                                    $name: #NameExpr['arg']
                                 ]
                              ]
                              $body: #BlockExpr[
                                 $main: #ApplyExpr[
                                    $recv: #Field[
                                       $recv: #NameExpr['OpenSSL']
                                       $name: #NameExpr['TestUtils']
                                    ]
                                    $recv: #NameExpr['issue_crl']
                                    $param: #List[
                                       $variadic: #Variadic[
                                          $base: #NameExpr['arg']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #FuncDecl[
                              $name: #NameExpr['readwrite_loop']
                              $param: #List[
                                 $param: #Param[
                                    $param: #NameExpr['ctx']
                                 ]
                                 $param: #Param[
                                    $param: #NameExpr['ssl']
                                 ]
                              ]
                              $body: #BlockExpr[
                                 $main: #While[
                                    $cond: #AssignExpr[
                                       $left: #NameExpr['line']
                                       $right: #ApplyExpr[
                                          $recv: #NameExpr['ssl']
                                          $recv: #NameExpr['gets']
                                       ]
                                    ]
                                    $body: #ApplyExpr[
                                       $recv: #NameExpr['ssl']
                                       $recv: #NameExpr['write']
                                       $param: #List[
                                          $expression: #NameExpr['line']
                                       ]
                                    ]
                                 ]
                                 $rescue: #List[
                                    $rescue: #Rescue[
                                       $class: #Field[
                                          $recv: #Field[
                                             $recv: #NameExpr['OpenSSL']
                                             $name: #NameExpr['SSL']
                                          ]
                                          $name: #NameExpr['SSLError']
                                       ]
                                       $then: #Empty['']
                                    ]
                                    $rescue: #Rescue[
                                       $class: #NameExpr['IOError']
                                       $then: #Empty['']
                                    ]
                                 ]
                                 $ensure: #Rescue[
                                    $body: #ApplyExpr[
                                       $recv: #NameExpr['ssl']
                                       $recv: #NameExpr['close']
                                    ]
                                    $rescue: #Nil['nil']
                                 ]
                              ]
                           ]
                           $statement: #FuncDecl[
                              $name: #NameExpr['server_loop']
                              $param: #List[
                                 $param: #Param[
                                    $param: #NameExpr['ctx']
                                 ]
                                 $param: #Param[
                                    $param: #NameExpr['ssls']
                                 ]
                                 $param: #Param[
                                    $param: #NameExpr['stop_pipe_r']
                                 ]
                                 $param: #Param[
                                    $param: #NameExpr['ignore_listener_error']
                                 ]
                                 $param: #Param[
                                    $param: #NameExpr['server_proc']
                                 ]
                                 $param: #Param[
                                    $param: #NameExpr['threads']
                                 ]
                              ]
                              $body: #BlockExpr[
                                 $main: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['loop']
                                    $body: #Block[
                                       $body: #List[
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['ssl']
                                             $right: #Nil['nil']
                                          ]
                                          $statement: #ExceptionBlock[
                                             $main: #List[
                                                $statement: #MultipleAssign[
                                                   $left: #MultipleLeftHandSideExpression[
                                                      $item: #NameExpr['readable']
                                                   ]
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['IO']
                                                      $recv: #NameExpr['select']
                                                      $param: #List[
                                                         $expression: #Array[
                                                            $index: #List[
                                                               $expression: #NameExpr['ssls']
                                                               $expression: #NameExpr['stop_pipe_r']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                                $statement: #IfExpr[
                                                   $cond: #ApplyExpr[
                                                      $base: #NameExpr['readable']
                                                      $recv: #NameExpr['include?']
                                                      $param: #List[
                                                         $expression: #NameExpr['stop_pipe_r']
                                                      ]
                                                   ]
                                                   $then: #RReturnStmt['return']
                                                ]
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['ssl']
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['ssls']
                                                      $recv: #NameExpr['accept']
                                                   ]
                                                ]
                                             ]
                                             $rescue: #List[
                                                $rescue: #Rescue[
                                                   $class: #MultipleRightHandSideExpression[
                                                      $expression: #Field[
                                                         $recv: #Field[
                                                            $recv: #NameExpr['OpenSSL']
                                                            $name: #NameExpr['SSL']
                                                         ]
                                                         $name: #NameExpr['SSLError']
                                                      ]
                                                      $expression: #Field[
                                                         $recv: #NameExpr['Errno']
                                                         $name: #NameExpr['ECONNRESET']
                                                      ]
                                                   ]
                                                   $then: #IfExpr[
                                                      $cond: #NameExpr['ignore_listener_error']
                                                      $then: #Retry['retry']
                                                      $else: #NameExpr['raise']
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['th']
                                             $right: #ApplyExpr[
                                                $recv: #NameExpr['Thread']
                                                $recv: #NameExpr['start']
                                                $body: #Block[
                                                   $body: #ApplyExpr[
                                                      $recv: #NameExpr['server_proc']
                                                      $recv: #NameExpr['call']
                                                      $param: #List[
                                                         $expression: #NameExpr['ctx']
                                                         $expression: #NameExpr['ssl']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $statement: #LShiftExpr[
                                             $left: #NameExpr['threads']
                                             $right: #NameExpr['th']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $rescue: #List[
                                    $rescue: #Rescue[
                                       $class: #MultipleRightHandSideExpression[
                                          $expression: #Field[
                                             $recv: #NameExpr['Errno']
                                             $name: #NameExpr['EBADF']
                                          ]
                                          $expression: #NameExpr['IOError']
                                          $expression: #Field[
                                             $recv: #NameExpr['Errno']
                                             $name: #NameExpr['EINVAL']
                                          ]
                                          $expression: #Field[
                                             $recv: #NameExpr['Errno']
                                             $name: #NameExpr['ECONNABORTED']
                                          ]
                                          $expression: #Field[
                                             $recv: #NameExpr['Errno']
                                             $name: #NameExpr['ENOTSOCK']
                                          ]
                                          $expression: #Field[
                                             $recv: #NameExpr['Errno']
                                             $name: #NameExpr['ECONNRESET']
                                          ]
                                       ]
                                       $then: #IfExpr[
                                          $cond: #NotExpr[
                                             $expr: #NameExpr['ignore_listener_error']
                                          ]
                                          $then: #NameExpr['raise']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #FuncDecl[
                              $name: #NameExpr['start_server']
                              $param: #List[
                                 $param: #KeywordParam[
                                    $name: #NameExpr['verify_mode']
                                    $default: #Field[
                                       $recv: #Field[
                                          $recv: #NameExpr['OpenSSL']
                                          $name: #NameExpr['SSL']
                                       ]
                                       $name: #NameExpr['VERIFY_NONE']
                                    ]
                                 ]
                                 $param: #KeywordParam[
                                    $name: #NameExpr['start_immediately']
                                    $default: #TrueExpr['true']
                                 ]
                                 $param: #KeywordParam[
                                    $name: #NameExpr['ctx_proc']
                                    $default: #Nil['nil']
                                 ]
                                 $param: #KeywordParam[
                                    $name: #NameExpr['server_proc']
                                    $default: #ApplyExpr[
                                       #Self['self']
                                       $recv: #NameExpr['method']
                                       $param: #List[
                                          $expression: #NameExpr['readwrite_loop']
                                       ]
                                    ]
                                 ]
                                 $param: #KeywordParam[
                                    $name: #NameExpr['ignore_listener_error']
                                    $default: #FalseExpr['false']
                                 ]
                                 $param: #ProcedureParam[
                                    $name: #NameExpr['block']
                                 ]
                              ]
                              $body: #BlockExpr[
                                 $main: #ApplyExpr[
                                    $recv: #NameExpr['IO']
                                    $recv: #NameExpr['pipe']
                                    $body: #Block[
                                       $param: #MultipleLeftHandSideExpression[
                                          $item: #NameExpr['stop_pipe_r']
                                          $item: #NameExpr['stop_pipe_w']
                                       ]
                                       $body: #List[
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['store']
                                             $right: #ApplyExpr[
                                                $recv: #Field[
                                                   $recv: #Field[
                                                      $recv: #NameExpr['OpenSSL']
                                                      $name: #NameExpr['X509']
                                                   ]
                                                   $name: #NameExpr['Store']
                                                ]
                                                $recv: #NameExpr['new']
                                             ]
                                          ]
                                          $statement: #ApplyExpr[
                                             $recv: #NameExpr['store']
                                             $recv: #NameExpr['add_cert']
                                             $param: #List[
                                                $expression: #NameExpr['@ca_cert']
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['store']
                                                $name: #NameExpr['purpose']
                                             ]
                                             $right: #Field[
                                                $recv: #Field[
                                                   $recv: #NameExpr['OpenSSL']
                                                   $name: #NameExpr['X509']
                                                ]
                                                $name: #NameExpr['PURPOSE_SSL_CLIENT']
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['ctx']
                                             $right: #ApplyExpr[
                                                $recv: #Field[
                                                   $recv: #Field[
                                                      $recv: #NameExpr['OpenSSL']
                                                      $name: #NameExpr['SSL']
                                                   ]
                                                   $name: #NameExpr['SSLContext']
                                                ]
                                                $recv: #NameExpr['new']
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['ctx']
                                                $name: #NameExpr['cert_store']
                                             ]
                                             $right: #NameExpr['store']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['ctx']
                                                $name: #NameExpr['cert']
                                             ]
                                             $right: #NameExpr['@svr_cert']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['ctx']
                                                $name: #NameExpr['key']
                                             ]
                                             $right: #NameExpr['@svr_key']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['ctx']
                                                $name: #NameExpr['tmp_dh_callback']
                                             ]
                                             $right: #ApplyExpr[
                                                #Self['self']
                                                $recv: #NameExpr['proc']
                                                $body: #Block[
                                                   $body: #Field[
                                                      $recv: #Field[
                                                         $recv: #NameExpr['OpenSSL']
                                                         $name: #NameExpr['TestUtils']
                                                      ]
                                                      $name: #NameExpr['TEST_KEY_DH1024']
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $statement: #ExceptionBlock[
                                             $main: #AssignExpr[
                                                $left: #Field[
                                                   $base: #NameExpr['ctx']
                                                   $name: #NameExpr['ecdh_curves']
                                                ]
                                                $right: #StringExpr['P-256']
                                             ]
                                             $rescue: #List[
                                                $rescue: #Rescue[
                                                   $class: #NameExpr['NotImplementedError']
                                                   $then: #Empty['']
                                                ]
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['ctx']
                                                $name: #NameExpr['verify_mode']
                                             ]
                                             $right: #NameExpr['verify_mode']
                                          ]
                                          $statement: #IfExpr[
                                             $then: #ApplyExpr[
                                                $recv: #NameExpr['ctx_proc']
                                                $recv: #NameExpr['call']
                                                $param: #List[
                                                   $expression: #NameExpr['ctx']
                                                ]
                                             ]
                                             $cond: #NameExpr['ctx_proc']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['Socket']
                                                $name: #NameExpr['do_not_reverse_lookup']
                                             ]
                                             $right: #TrueExpr['true']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['tcps']
                                             $right: #Nil['nil']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['tcps']
                                             $right: #ApplyExpr[
                                                $recv: #NameExpr['TCPServer']
                                                $recv: #NameExpr['new']
                                                $param: #List[
                                                   $expression: #StringExpr['127.0.0.1']
                                                   $expression: #IntExpr['0']
                                                ]
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['port']
                                             $right: #ApplyExpr[
                                                $recv: #ApplyExpr[
                                                   $recv: #NameExpr['tcps']
                                                   $recv: #NameExpr['connect_address']
                                                ]
                                                $recv: #NameExpr['ip_port']
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['ssls']
                                             $right: #ApplyExpr[
                                                $recv: #Field[
                                                   $recv: #Field[
                                                      $recv: #NameExpr['OpenSSL']
                                                      $name: #NameExpr['SSL']
                                                   ]
                                                   $name: #NameExpr['SSLServer']
                                                ]
                                                $recv: #NameExpr['new']
                                                $param: #List[
                                                   $expression: #NameExpr['tcps']
                                                   $expression: #NameExpr['ctx']
                                                ]
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['ssls']
                                                $name: #NameExpr['start_immediately']
                                             ]
                                             $right: #NameExpr['start_immediately']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['threads']
                                             $right: #Array['[]']
                                          ]
                                          $statement: #ExceptionBlock[
                                             $main: #List[
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['server']
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['Thread']
                                                      $recv: #NameExpr['new']
                                                      $body: #Block[
                                                         $body: #ExceptionBlock[
                                                            $main: #ApplyExpr[
                                                               #Self['self']
                                                               $recv: #NameExpr['server_loop']
                                                               $param: #List[
                                                                  $expression: #NameExpr['ctx']
                                                                  $expression: #NameExpr['ssls']
                                                                  $expression: #NameExpr['stop_pipe_r']
                                                                  $expression: #NameExpr['ignore_listener_error']
                                                                  $expression: #NameExpr['server_proc']
                                                                  $expression: #NameExpr['threads']
                                                               ]
                                                            ]
                                                            $ensure: #ApplyExpr[
                                                               $recv: #NameExpr['tcps']
                                                               $recv: #NameExpr['close']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                                $statement: #ApplyExpr[
                                                   $base: #NameExpr['threads']
                                                   $recv: #NameExpr['unshift']
                                                   $param: #List[
                                                      $expression: #NameExpr['server']
                                                   ]
                                                ]
                                                $statement: #IfExpr[
                                                   $then: #ApplyExpr[
                                                      $recv: #NameExpr['$stderr']
                                                      $recv: #NameExpr['printf']
                                                      $param: #List[
                                                         $expression: #StringExpr['SSL server started: pid=%d port=%d\\n']
                                                         $expression: #BuiltInVariable['$$']
                                                         $expression: #NameExpr['port']
                                                      ]
                                                   ]
                                                   $cond: #NameExpr['$DEBUG']
                                                ]
                                                $statement: #AssignExpr[
                                                   $left: #NameExpr['client']
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['Thread']
                                                      $recv: #NameExpr['new']
                                                      $body: #Block[
                                                         $body: #ExceptionBlock[
                                                            $main: #ApplyExpr[
                                                               $recv: #NameExpr['block']
                                                               $recv: #NameExpr['call']
                                                               $param: #List[
                                                                  $expression: #NameExpr['server']
                                                                  $expression: #ApplyExpr[
                                                                     $recv: #NameExpr['port']
                                                                     $recv: #NameExpr['to_i']
                                                                  ]
                                                               ]
                                                            ]
                                                            $ensure: #ApplyExpr[
                                                               $recv: #NameExpr['stop_pipe_w']
                                                               $recv: #NameExpr['close']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                                $statement: #ApplyExpr[
                                                   $base: #NameExpr['threads']
                                                   $recv: #NameExpr['unshift']
                                                   $param: #List[
                                                      $expression: #NameExpr['client']
                                                   ]
                                                ]
                                             ]
                                             $ensure: #ApplyExpr[
                                                #Self['self']
                                                $recv: #NameExpr['assert_join_threads']
                                                $param: #List[
                                                   $expression: #NameExpr['threads']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
                  $statement: #Class[
                     $name: #NestedName[
                        $path: #NameExpr['OpenSSL']
                        $name: #NameExpr['PKeyTestCase']
                     ]
                     $super: #Field[
                        $recv: #NameExpr['OpenSSL']
                        $name: #NameExpr['TestCase']
                     ]
                     $body: #BlockExpr[
                        $main: #List[
                           $statement: #FuncDecl[
                              $name: #NameExpr['check_component']
                              $param: #List[
                                 $param: #Param[
                                    $param: #NameExpr['base']
                                 ]
                                 $param: #Param[
                                    $param: #NameExpr['test']
                                 ]
                                 $param: #Param[
                                    $param: #NameExpr['keys']
                                 ]
                              ]
                              $body: #BlockExpr[
                                 $main: #ApplyExpr[
                                    $recv: #NameExpr['keys']
                                    $recv: #NameExpr['each']
                                    $body: #Block[
                                       $param: #NameExpr['comp']
                                       $body: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['assert_equal']
                                          $param: #List[
                                             $expression: #ApplyExpr[
                                                $recv: #NameExpr['base']
                                                $recv: #NameExpr['send']
                                                $param: #List[
                                                   $expression: #NameExpr['comp']
                                                ]
                                             ]
                                             $expression: #ApplyExpr[
                                                $recv: #NameExpr['test']
                                                $recv: #NameExpr['send']
                                                $param: #List[
                                                   $expression: #NameExpr['comp']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $statement: #FuncDecl[
                              $name: #NameExpr['dup_public']
                              $param: #List[
                                 $param: #Param[
                                    $param: #NameExpr['key']
                                 ]
                              ]
                              $body: #BlockExpr[
                                 $main: #Case[
                                    $cond: #NameExpr['key']
                                    $body: #List[
                                       $when: #When[
                                          $cond: #List[
                                             $expression: #Field[
                                                $recv: #Field[
                                                   $recv: #NameExpr['OpenSSL']
                                                   $name: #NameExpr['PKey']
                                                ]
                                                $name: #NameExpr['RSA']
                                             ]
                                          ]
                                          $then: #List[
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['rsa']
                                                $right: #ApplyExpr[
                                                   $recv: #Field[
                                                      $recv: #Field[
                                                         $recv: #NameExpr['OpenSSL']
                                                         $name: #NameExpr['PKey']
                                                      ]
                                                      $name: #NameExpr['RSA']
                                                   ]
                                                   $recv: #NameExpr['new']
                                                ]
                                             ]
                                             $statement: #ApplyExpr[
                                                $recv: #NameExpr['rsa']
                                                $recv: #NameExpr['set_key']
                                                $param: #List[
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['n']
                                                   ]
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['e']
                                                   ]
                                                   $expression: #Nil['nil']
                                                ]
                                             ]
                                             $statement: #NameExpr['rsa']
                                          ]
                                       ]
                                       $when: #When[
                                          $cond: #List[
                                             $expression: #Field[
                                                $recv: #Field[
                                                   $recv: #NameExpr['OpenSSL']
                                                   $name: #NameExpr['PKey']
                                                ]
                                                $name: #NameExpr['DSA']
                                             ]
                                          ]
                                          $then: #List[
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['dsa']
                                                $right: #ApplyExpr[
                                                   $recv: #Field[
                                                      $recv: #Field[
                                                         $recv: #NameExpr['OpenSSL']
                                                         $name: #NameExpr['PKey']
                                                      ]
                                                      $name: #NameExpr['DSA']
                                                   ]
                                                   $recv: #NameExpr['new']
                                                ]
                                             ]
                                             $statement: #ApplyExpr[
                                                $recv: #NameExpr['dsa']
                                                $recv: #NameExpr['set_pqg']
                                                $param: #List[
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['p']
                                                   ]
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['q']
                                                   ]
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['g']
                                                   ]
                                                ]
                                             ]
                                             $statement: #ApplyExpr[
                                                $recv: #NameExpr['dsa']
                                                $recv: #NameExpr['set_key']
                                                $param: #List[
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['pub_key']
                                                   ]
                                                   $expression: #Nil['nil']
                                                ]
                                             ]
                                             $statement: #NameExpr['dsa']
                                          ]
                                       ]
                                       $when: #When[
                                          $cond: #List[
                                             $expression: #Field[
                                                $recv: #Field[
                                                   $recv: #NameExpr['OpenSSL']
                                                   $name: #NameExpr['PKey']
                                                ]
                                                $name: #NameExpr['DH']
                                             ]
                                          ]
                                          $then: #List[
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['dh']
                                                $right: #ApplyExpr[
                                                   $recv: #Field[
                                                      $recv: #Field[
                                                         $recv: #NameExpr['OpenSSL']
                                                         $name: #NameExpr['PKey']
                                                      ]
                                                      $name: #NameExpr['DH']
                                                   ]
                                                   $recv: #NameExpr['new']
                                                ]
                                             ]
                                             $statement: #ApplyExpr[
                                                $recv: #NameExpr['dh']
                                                $recv: #NameExpr['set_pqg']
                                                $param: #List[
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['p']
                                                   ]
                                                   $expression: #Nil['nil']
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['g']
                                                   ]
                                                ]
                                             ]
                                             $statement: #NameExpr['dh']
                                          ]
                                       ]
                                    ]
                                    $else: #IfExpr[
                                       $cond: #Defined[
                                          $base: #LAnd[
                                             $left: #Field[
                                                $recv: #Field[
                                                   $recv: #NameExpr['OpenSSL']
                                                   $name: #NameExpr['PKey']
                                                ]
                                                $name: #NameExpr['EC']
                                             ]
                                             $right: #StrictEquals[
                                                $left: #Field[
                                                   $recv: #Field[
                                                      $recv: #NameExpr['OpenSSL']
                                                      $name: #NameExpr['PKey']
                                                   ]
                                                   $name: #NameExpr['EC']
                                                ]
                                                $right: #NameExpr['key']
                                             ]
                                          ]
                                       ]
                                       $then: #List[
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['ec']
                                             $right: #ApplyExpr[
                                                $recv: #Field[
                                                   $recv: #Field[
                                                      $recv: #NameExpr['OpenSSL']
                                                      $name: #NameExpr['PKey']
                                                   ]
                                                   $name: #NameExpr['EC']
                                                ]
                                                $recv: #NameExpr['new']
                                                $param: #List[
                                                   $expression: #ApplyExpr[
                                                      $recv: #NameExpr['key']
                                                      $recv: #NameExpr['group']
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['ec']
                                                $name: #NameExpr['public_key']
                                             ]
                                             $right: #ApplyExpr[
                                                $recv: #NameExpr['key']
                                                $recv: #NameExpr['public_key']
                                             ]
                                          ]
                                          $statement: #NameExpr['ec']
                                       ]
                                       $else: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['raise']
                                          $param: #List[
                                             $expression: #StringExpr['unknown key type']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
         ]
         $cond: #AndExpr[
            $left: #Defined[
               $base: #Field[
                  $recv: #NameExpr['OpenSSL']
                  $name: #NameExpr['OPENSSL_LIBRARY_VERSION']
               ]
            ]
            $right: #NotMatch[
               $left: #Regex['/\\AOpenSSL +0\\./']
               $right: #Field[
                  $recv: #NameExpr['OpenSSL']
                  $name: #NameExpr['OPENSSL_LIBRARY_VERSION']
               ]
            ]
         ]
      ]
   ]
   #Comsumed['comsumed']
]
