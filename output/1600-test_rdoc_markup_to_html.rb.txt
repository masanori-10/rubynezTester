#Source[
   #List[
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['rdoc/test_case']
         ]
      ]
      $statement: #Class[
         $name: #NameExpr['TestRDocMarkupToHtml']
         $super: #Field[
            $recv: #Field[
               $recv: #NameExpr['RDoc']
               $name: #NameExpr['Markup']
            ]
            $name: #NameExpr['FormatterTestCase']
         ]
         $body: #BlockExpr[
            $main: #List[
               $statement: #NameExpr['add_visitor_tests']
               $statement: #FuncDecl[
                  $name: #NameExpr['setup']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #Super['super']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['@to']
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['ToHtml']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['@options']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_blank_line']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_empty']
                        $param: #List[
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_block_quote']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<blockquote>\\n<p>quote</p>\\n</blockquote>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_document']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>hello</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_heading']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #StringExpr[
                              $inner: #NameExpr['links']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_heading_1']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_heading_2']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_heading_3']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_heading_4']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_heading_b']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['inner']
                           $right: #StringExpr['<strong>Hello</strong>']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['inner']
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_heading_suppressed_crossref']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_end_bullet']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<ul></ul>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_end_label']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<dl class=\\"rdoc-list label-list\\"></dl>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_end_lalpha']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<ol style=\\"list-style-type: lower-alpha\\"></ol>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_end_number']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<ol></ol>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_end_note']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<dl class=\\"rdoc-list note-list\\"></dl>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_end_ualpha']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<ol style=\\"list-style-type: upper-alpha\\"></ol>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_end_bullet']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #ParcentNotation['%w[</li>]']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['in_list_entry']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_end_label']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #ParcentNotation['%w[</dd>]']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['in_list_entry']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_end_lalpha']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #ParcentNotation['%w[</li>]']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['in_list_entry']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_end_note']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #ParcentNotation['%w[</dd>]']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['in_list_entry']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_end_number']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #ParcentNotation['%w[</li>]']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['in_list_entry']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_end_ualpha']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #ParcentNotation['%w[</li>]']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['in_list_entry']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_bullet']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<ul><li>']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_label']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<dl class=\\"rdoc-list label-list\\"><dt>cat\\n<dd>']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_lalpha']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<ol style=\\"list-style-type: lower-alpha\\"><li>']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_note']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<dl class=\\"rdoc-list note-list\\"><dt>cat\\n<dd>']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_note_2']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['<dl class="rdoc-list note-list"><dt><code>teletype</code>\n<dd>\n<p>teletype description</p>\n</dd></dl>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_note_multi_description']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['<dl class="rdoc-list note-list"><dt>label\n<dd>\n<p>description one</p>\n</dd><dd>\n<p>description two</p>\n</dd></dl>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_note_multi_label']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['<dl class="rdoc-list note-list"><dt>one\n<dt>two\n<dd>\n<p>two headers</p>\n</dd></dl>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_number']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<ol><li>']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_item_start_ualpha']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<ol style=\\"list-style-type: upper-alpha\\"><li>']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_start_bullet']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['BULLET']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<ul>']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_start_label']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['LABEL']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<dl class="rdoc-list label-list">']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_start_lalpha']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['LALPHA']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<ol style=\\"list-style-type: lower-alpha\\">']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_start_note']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['NOTE']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<dl class=\\"rdoc-list note-list\\">']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_start_number']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['NUMBER']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<ol>']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_list_start_ualpha']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #NameExpr['UALPHA']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array[
                                 $index: #List[
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<ol style=\\"list-style-type: upper-alpha\\">']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_paragraph']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>hi</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_paragraph_b']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>reg <strong>bold words</strong> reg</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_paragraph_br']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>one<br>two</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_paragraph_break']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>hello<br> world</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_paragraph_i']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>reg <em>italic words</em> reg</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_paragraph_plus']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>reg <code>teletype</code> reg</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_paragraph_star']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>reg <strong>bold</strong> reg</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_paragraph_underscore']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p>reg <em>italic</em> reg</p>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_raw']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['raw']
                           $right: #HereDocument['<table>\n<tr><th>Name<th>Count\n<tr><td>a<td>1\n<tr><td>b<td>2\n</table>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['raw']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_rule']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<hr>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['accept_verbatim']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<pre class=\\"ruby\\"><span class=\\"ruby-identifier\\">hi</span>\\n  <span class=\\"ruby-identifier\\">world</span>\\n</pre>\\n']
                           $expression: #ApplyExpr[
                              $recv: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                              $recv: #NameExpr['join']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['end_accepting']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['hi']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['end_accepting']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['start_accepting']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['res']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['in_list_entry']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Array['[]']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['list']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['list_nested']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['<ul><li>\n<p>l1</p>\n<ul><li>\n<p>l1.1</p>\n</li></ul>\n</li><li>\n<p>l2</p>\n</li></ul>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['list_verbatim']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['<ul><li>\n<p>list stuff</p>\n\n<pre>* list\n  with\n\n  second\n\n  1. indented\n  2. numbered\n\n  third\n\n* second</pre>\n</li></ul>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@to']
                                 $recv: #NameExpr['end_accepting']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_heading_7']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_heading']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['@RM']
                                    $name: #NameExpr['Heading']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #IntExpr['7']
                                    $expression: #StringExpr['Hello']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_heading_aref_class']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@to']
                              $name: #NameExpr['code_object']
                           ]
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #NameExpr['RDoc']
                                 $name: #NameExpr['NormalClass']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['Foo']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_heading']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['head']
                                 $param: #List[
                                    $expression: #IntExpr['1']
                                    $expression: #StringExpr['Hello']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#class-Foo-label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_heading_aref_method']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@to']
                              $name: #NameExpr['code_object']
                           ]
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #NameExpr['RDoc']
                                 $name: #NameExpr['AnyMethod']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #Nil['nil']
                                 $expression: #StringExpr['foo']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_heading']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['@RM']
                                    $name: #NameExpr['Heading']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #IntExpr['1']
                                    $expression: #StringExpr['Hello']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['links']
                           $right: #AddExpr[
                              $left: #StringExpr['<span><a href="#method-i-foo-label-Hello">&para;</a> ']
                              $right: #StringExpr['<a href="#top">&uarr;</a></span>']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[
                                 $inner: #NameExpr['links']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_heading_pipe']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@options']
                              $name: #NameExpr['pipe']
                           ]
                           $right: #TrueExpr['true']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_heading']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['@RM']
                                    $name: #NameExpr['Heading']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #IntExpr['1']
                                    $expression: #StringExpr['Hello']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<h1 id=\\"label-Hello\\">Hello</h1>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_paragraph_newline']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_paragraph']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['para']
                                 $param: #List[
                                    $expression: #StringExpr['hello\\n']
                                    $expression: #StringExpr['world\\n']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p>hello world</p>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_heading_output_decoration']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@options']
                              $name: #NameExpr['output_decoration']
                           ]
                           $right: #FalseExpr['false']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_heading']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['@RM']
                                    $name: #NameExpr['Heading']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #IntExpr['1']
                                    $expression: #StringExpr['Hello']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<h1>Hello<span><a href=\\"#label-Hello\\">&para;</a> <a href=\\"#top\\">&uarr;</a></span></h1>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_heading_output_decoration_with_pipe']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@options']
                              $name: #NameExpr['pipe']
                           ]
                           $right: #TrueExpr['true']
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@options']
                              $name: #NameExpr['output_decoration']
                           ]
                           $right: #FalseExpr['false']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_heading']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['@RM']
                                    $name: #NameExpr['Heading']
                                 ]
                                 $recv: #NameExpr['new']
                                 $param: #List[
                                    $expression: #IntExpr['1']
                                    $expression: #StringExpr['Hello']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<h1>Hello</h1>\\n']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_verbatim_parseable']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['verb']
                           $right: #ApplyExpr[
                              $recv: #Field[
                                 $recv: #NameExpr['@RM']
                                 $name: #NameExpr['Verbatim']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['class C\\n']
                                 $expression: #StringExpr['end\\n']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_verbatim']
                           $param: #List[
                              $expression: #NameExpr['verb']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['\n<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">C</span>\n<span class="ruby-keyword">end</span>\n</pre>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_verbatim_parseable_error']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['verb']
                           $right: #ApplyExpr[
                              $recv: #Field[
                                 $recv: #NameExpr['@RM']
                                 $name: #NameExpr['Verbatim']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['a % 09 # => blah\\n']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_verbatim']
                           $param: #List[
                              $expression: #NameExpr['verb']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['inner']
                           $right: #ApplyExpr[
                              $base: #NameExpr['CGI']
                              $recv: #NameExpr['escapeHTML']
                              $param: #List[
                                 $expression: #StringExpr['a % 09 # => blah']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['\n<pre>#{inner}</pre>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_verbatim_pipe']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['@options']
                              $name: #NameExpr['pipe']
                           ]
                           $right: #TrueExpr['true']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['verb']
                           $right: #ApplyExpr[
                              $recv: #Field[
                                 $recv: #NameExpr['@RM']
                                 $name: #NameExpr['Verbatim']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['1 + 1\\n']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['verb']
                              $name: #NameExpr['format']
                           ]
                           $right: #NameExpr['ruby']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_verbatim']
                           $param: #List[
                              $expression: #NameExpr['verb']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['\n<pre><code>1 + 1\n</code></pre>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_accept_verbatim_ruby']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['verb']
                           $right: #ApplyExpr[
                              $recv: #Field[
                                 $recv: #NameExpr['@RM']
                                 $name: #NameExpr['Verbatim']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['1 + 1\\n']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['verb']
                              $name: #NameExpr['format']
                           ]
                           $right: #NameExpr['ruby']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_verbatim']
                           $param: #List[
                              $expression: #NameExpr['verb']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['\n<pre class="ruby"><span class="ruby-value">1</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>\n</pre>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['@to']
                                    $recv: #NameExpr['res']
                                 ]
                                 $recv: #NameExpr['join']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_string']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['&lt;&gt;']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['convert_string']
                              $param: #List[
                                 $expression: #StringExpr['<>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_HYPERLINK_irc']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['irc://irc.freenode.net/#ruby-lang']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p><a href=\\"irc://irc.freenode.net/#ruby-lang\\">irc.freenode.net/#ruby-lang</a></p>\\n']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_RDOCLINK_label_label']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['rdoc-label:label-One']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p><a href=\\"#label-One\\">One</a></p>\\n']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_RDOCLINK_label_foottext']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['rdoc-label:foottext-1']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p><a href=\\"#foottext-1\\">1</a></p>\\n']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_RDOCLINK_label_footmark']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['rdoc-label:footmark-1']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p><a href=\\"#footmark-1\\">1</a></p>\\n']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_RDOCLINK_ref']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['rdoc-ref:C']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p>C</p>\\n']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_TIDYLINK_footnote']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['text{*1}[rdoc-label:foottext-1:footmark-1]']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p>text<sup><a id=\\"footmark-1\\" href=\\"#foottext-1\\">1</a></sup></p>\\n']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_TIDYLINK_multiple']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['{a}[http://example] {b}[http://example]']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['\n<p><a href=\\"http://example\\">a</a> <a href=\\"http://example\\">b</a></p>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_TIDYLINK_image']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['{rdoc-image:path/to/image.jpg}[http://example.com]']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #StringExpr['\\n<p><a href=\\"http://example.com\\"><img src=\\"path/to/image.jpg\\"></a></p>\\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_TIDYLINK_rdoc_label']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['{foo}[rdoc-label:foottext-1]']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p><a href=\\"#foottext-1\\">foo</a></p>\\n']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_convert_TIDYLINK_irc']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['result']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['convert']
                              $param: #List[
                                 $expression: #StringExpr['{ruby-lang}[irc://irc.freenode.net/#ruby-lang]']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['\\n<p><a href=\\"irc://irc.freenode.net/#ruby-lang\\">ruby-lang</a></p>\\n']
                              $expression: #NameExpr['result']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_gen_url']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<a href="example">example</a>']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['gen_url']
                              $param: #List[
                                 $expression: #StringExpr['link:example']
                                 $expression: #StringExpr['example']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_gen_url_rdoc_label']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<a href="#foottext-1">example</a>']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['gen_url']
                              $param: #List[
                                 $expression: #StringExpr['rdoc-label:foottext-1']
                                 $expression: #StringExpr['example']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_gen_url_rdoc_label_id']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<sup><a id="footmark-1" href="#foottext-1">example</a></sup>']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['gen_url']
                              $param: #List[
                                 $expression: #StringExpr['rdoc-label:foottext-1:footmark-1']
                                 $expression: #StringExpr['example']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_gen_url_image_url']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<img src="http://example.com/image.png" />']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['gen_url']
                              $param: #List[
                                 $expression: #StringExpr['http://example.com/image.png']
                                 $expression: #StringExpr['ignored']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_gen_url_ssl_image_url']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['<img src="https://example.com/image.png" />']
                           $expression: #ApplyExpr[
                              $recv: #NameExpr['@to']
                              $recv: #NameExpr['gen_url']
                              $param: #List[
                                 $expression: #StringExpr['https://example.com/image.png']
                                 $expression: #StringExpr['ignored']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_handle_special_HYPERLINK_link']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['special']
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['Special']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #IntExpr['0']
                                 $expression: #StringExpr['link:README.txt']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['link']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['handle_special_HYPERLINK']
                              $param: #List[
                                 $expression: #NameExpr['special']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<a href="README.txt">README.txt</a>']
                              $expression: #NameExpr['link']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_handle_special_HYPERLINK_irc']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['special']
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['Special']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #IntExpr['0']
                                 $expression: #StringExpr['irc://irc.freenode.net/#ruby-lang']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['link']
                           $right: #ApplyExpr[
                              $base: #NameExpr['@to']
                              $recv: #NameExpr['handle_special_HYPERLINK']
                              $param: #List[
                                 $expression: #NameExpr['special']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['<a href="irc://irc.freenode.net/#ruby-lang">irc.freenode.net/#ruby-lang</a>']
                              $expression: #NameExpr['link']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_list_verbatim_2']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['* one\\n    verb1\\n    verb2\\n* two\\n']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['expected']
                           $right: #HereDocument['<ul><li>\n<p>one</p>\n\n<pre class=\\"ruby\\"><span class=\\"ruby-identifier\\">verb1</span>\n<span class=\\"ruby-identifier\\">verb2</span>\n</pre>\n</li><li>\n<p>two</p>\n</li></ul>\n']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #NameExpr['expected']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['@m']
                                 $recv: #NameExpr['convert']
                                 $param: #List[
                                    $expression: #NameExpr['str']
                                    $expression: #NameExpr['@to']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_parseable_eh']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['valid_syntax']
                           $right: #Array[
                              $index: #List[
                                 $expression: #StringExpr['def x() end']
                                 $expression: #StringExpr['def x; end']
                                 $expression: #StringExpr['class C; end']
                                 $expression: #StringExpr['module M end']
                                 $expression: #StringExpr['a # => blah']
                                 $expression: #StringExpr['x { |y| nil }']
                                 $expression: #StringExpr['x do |y| nil end']
                                 $expression: #StringExpr['# only a comment']
                                 $expression: #StringExpr['require "foo"']
                                 $expression: #StringExpr['cls="foo"']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['invalid_syntax']
                           $right: #Array[
                              $index: #List[
                                 $expression: #StringExpr['def x end']
                                 $expression: #StringExpr['class C < end']
                                 $expression: #StringExpr['module M < C end']
                                 $expression: #StringExpr['a=># blah']
                                 $expression: #StringExpr['x { |y| ... }']
                                 $expression: #StringExpr['x do |y| ... end']
                                 $expression: #StringExpr['// only a comment']
                                 $expression: #StringExpr['<% require "foo" %>']
                                 $expression: #StringExpr['class="foo"']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['valid_syntax']
                           $recv: #NameExpr['each']
                           $body: #Block[
                              $param: #NameExpr['t']
                              $body: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['assert']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['@to']
                                       $recv: #NameExpr['parseable?']
                                       $param: #List[
                                          $expression: #NameExpr['t']
                                       ]
                                    ]
                                    $expression: #StringExpr[
                                       $inner: #NameExpr['t']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['invalid_syntax']
                           $recv: #NameExpr['each']
                           $body: #Block[
                              $param: #NameExpr['t']
                              $body: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['refute']
                                 $param: #List[
                                    $expression: #ApplyExpr[
                                       $recv: #NameExpr['@to']
                                       $recv: #NameExpr['parseable?']
                                       $param: #List[
                                          $expression: #NameExpr['t']
                                       ]
                                    ]
                                    $expression: #StringExpr[
                                       $inner: #NameExpr['t']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_to_html']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_equal']
                        $param: #List[
                           $expression: #StringExpr['\\n<p><code>--</code></p>\\n']
                           $expression: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['util_format']
                              $param: #List[
                                 $expression: #StringExpr['<tt>--</tt>']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['util_format']
                  $param: #List[
                     $param: #Param[
                        $param: #NameExpr['text']
                     ]
                  ]
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['paragraph']
                           $right: #ApplyExpr[
                              $base: #Field[
                                 $recv: #Field[
                                    $recv: #NameExpr['RDoc']
                                    $name: #NameExpr['Markup']
                                 ]
                                 $name: #NameExpr['Paragraph']
                              ]
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['text']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['start_accepting']
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['@to']
                           $recv: #NameExpr['accept_paragraph']
                           $param: #List[
                              $expression: #NameExpr['paragraph']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['@to']
                           $recv: #NameExpr['end_accepting']
                        ]
                     ]
                  ]
               ]
            ]
         ]
      ]
   ]
   #Comsumed['comsumed']
]
