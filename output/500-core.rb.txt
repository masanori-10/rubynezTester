#Source[
   #Class[
      $name: #NameExpr['CGI']
      $body: #BlockExpr[
         $main: #List[
            $statement: #AssignExpr[
               $left: #NameExpr['$CGI_ENV']
               $right: #NameExpr['ENV']
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['CR']
               $right: #StringExpr['\\015']
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['LF']
               $right: #StringExpr['\\012']
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['EOL']
               $right: #AddExpr[
                  $left: #NameExpr['CR']
                  $right: #NameExpr['LF']
               ]
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['REVISION']
               $right: #StringExpr['$Id$']
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['NEEDS_BINMODE']
               $right: #NeExpr[
                  $left: #Field[
                     $recv: #NameExpr['File']
                     $name: #NameExpr['BINARY']
                  ]
                  $right: #IntExpr['0']
               ]
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['PATH_SEPARATOR']
               $right: #List[
                  $hash: #Hash[
                     $key: #StringExpr['UNIX']
                     $value: #StringExpr['/']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['WINDOWS']
                     $value: #StringExpr['\\\\']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['MACINTOSH']
                     $value: #StringExpr[':']
                  ]
               ]
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['HTTP_STATUS']
               $right: #List[
                  $hash: #Hash[
                     $key: #StringExpr['OK']
                     $value: #StringExpr['200 OK']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['PARTIAL_CONTENT']
                     $value: #StringExpr['206 Partial Content']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['MULTIPLE_CHOICES']
                     $value: #StringExpr['300 Multiple Choices']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['MOVED']
                     $value: #StringExpr['301 Moved Permanently']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['REDIRECT']
                     $value: #StringExpr['302 Found']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['NOT_MODIFIED']
                     $value: #StringExpr['304 Not Modified']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['BAD_REQUEST']
                     $value: #StringExpr['400 Bad Request']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['AUTH_REQUIRED']
                     $value: #StringExpr['401 Authorization Required']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['FORBIDDEN']
                     $value: #StringExpr['403 Forbidden']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['NOT_FOUND']
                     $value: #StringExpr['404 Not Found']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['METHOD_NOT_ALLOWED']
                     $value: #StringExpr['405 Method Not Allowed']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['NOT_ACCEPTABLE']
                     $value: #StringExpr['406 Not Acceptable']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['LENGTH_REQUIRED']
                     $value: #StringExpr['411 Length Required']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['PRECONDITION_FAILED']
                     $value: #StringExpr['412 Precondition Failed']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['SERVER_ERROR']
                     $value: #StringExpr['500 Internal Server Error']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['NOT_IMPLEMENTED']
                     $value: #StringExpr['501 Method Not Implemented']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['BAD_GATEWAY']
                     $value: #StringExpr['502 Bad Gateway']
                  ]
                  $hash: #Hash[
                     $key: #StringExpr['VARIANT_ALSO_VARIES']
                     $value: #StringExpr['506 Variant Also Negotiates']
                  ]
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['env_table']
               $param: #List['']
               $body: #BlockExpr[
                  $main: #NameExpr['ENV']
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['stdinput']
               $param: #List['']
               $body: #BlockExpr[
                  $main: #NameExpr['$stdin']
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['stdoutput']
               $param: #List['']
               $body: #BlockExpr[
                  $main: #NameExpr['$stdout']
               ]
            ]
            $statement: #ApplyExpr[
               #Self['self']
               $recv: #NameExpr['private']
               $param: #List[
                  $expression: #NameExpr['env_table']
                  $expression: #NameExpr['stdinput']
                  $expression: #NameExpr['stdoutput']
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['http_header']
               $param: #List[
                  $param: #OptionalParam[
                     $name: #NameExpr['options']
                     $default: #StringExpr['text/html']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #List[
                     $statement: #IfExpr[
                        $cond: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['is_a?']
                           $param: #List[
                              $expression: #NameExpr['String']
                           ]
                        ]
                        $then: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['content_type']
                              $right: #NameExpr['options']
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['buf']
                              $right: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['_header_for_string']
                                 $param: #List[
                                    $expression: #NameExpr['content_type']
                                 ]
                              ]
                           ]
                        ]
                        $else: #IfExpr[
                           $cond: #ApplyExpr[
                              $recv: #NameExpr['options']
                              $recv: #NameExpr['is_a?']
                              $param: #List[
                                 $expression: #NameExpr['Hash']
                              ]
                           ]
                           $then: #IfExpr[
                              $cond: #LAnd[
                                 $left: #EqExpr[
                                    $left: #ApplyExpr[
                                       $recv: #NameExpr['options']
                                       $recv: #NameExpr['size']
                                    ]
                                    $right: #IntExpr['1']
                                 ]
                                 $right: #ApplyExpr[
                                    $recv: #NameExpr['options']
                                    $recv: #NameExpr['has_key?']
                                    $param: #List[
                                       $expression: #StringExpr['type']
                                    ]
                                 ]
                              ]
                              $then: #List[
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['content_type']
                                    $right: #Indexer[
                                       $recv: #NameExpr['options']
                                       $index: #List[
                                          $expression: #StringExpr['type']
                                       ]
                                    ]
                                 ]
                                 $statement: #AssignExpr[
                                    $left: #NameExpr['buf']
                                    $right: #ApplyExpr[
                                       #Self['self']
                                       $recv: #NameExpr['_header_for_string']
                                       $param: #List[
                                          $expression: #NameExpr['content_type']
                                       ]
                                    ]
                                 ]
                              ]
                              $else: #AssignExpr[
                                 $left: #NameExpr['buf']
                                 $right: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['_header_for_hash']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['options']
                                          $recv: #NameExpr['dup']
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                           $else: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['raise']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #NameExpr['ArgumentError']
                                    $recv: #NameExpr['new']
                                    $param: #List[
                                       $expression: #StringExpr[
                                          $inner: #ApplyExpr[
                                             $recv: #NameExpr['options']
                                             $recv: #NameExpr['class']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $cond: #Defined[
                           $base: #NameExpr['MOD_RUBY']
                        ]
                        $then: #List[
                           $statement: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['_header_for_modruby']
                              $param: #List[
                                 $expression: #NameExpr['buf']
                              ]
                           ]
                           $statement: #RReturnStmt[
                              $expr: #List[
                                 $expression: #StringExpr['']
                              ]
                           ]
                        ]
                        $else: #List[
                           $statement: #LShiftExpr[
                              $left: #NameExpr['buf']
                              $right: #NameExpr['EOL']
                           ]
                           $statement: #RReturnStmt[
                              $expr: #List[
                                 $expression: #NameExpr['buf']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
            $statement: #Alias[
               $newname: #NameExpr['header']
               $target: #NameExpr['http_header']
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['_header_for_string']
               $param: #List[
                  $param: #Param[
                     $param: #NameExpr['content_type']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #List[
                     $statement: #AssignExpr[
                        $left: #NameExpr['buf']
                        $right: #StringExpr['']
                     ]
                     $statement: #IfExpr[
                        $cond: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['nph?']
                           $param: #Empty['']
                        ]
                        $then: #List[
                           $statement: #LShiftExpr[
                              $left: #NameExpr['buf']
                              $right: #StringExpr[
                                 $inner: #LOr[
                                    $left: #Indexer[
                                       $recv: #NameExpr['$CGI_ENV']
                                       $index: #List[
                                          $expression: #StringExpr['SERVER_PROTOCOL']
                                       ]
                                    ]
                                    $right: #StringExpr['HTTP/1.0']
                                 ]
                                 $inner: #NameExpr['EOL']
                              ]
                           ]
                           $statement: #LShiftExpr[
                              $left: #NameExpr['buf']
                              $right: #StringExpr[
                                 $inner: #ApplyExpr[
                                    $recv: #NameExpr['CGI']
                                    $recv: #NameExpr['rfc1123_date']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['Time']
                                          $recv: #NameExpr['now']
                                       ]
                                    ]
                                 ]
                                 $inner: #NameExpr['EOL']
                              ]
                           ]
                           $statement: #LShiftExpr[
                              $left: #NameExpr['buf']
                              $right: #StringExpr[
                                 $inner: #Indexer[
                                    $recv: #NameExpr['$CGI_ENV']
                                    $index: #List[
                                       $expression: #StringExpr['SERVER_SOFTWARE']
                                    ]
                                 ]
                                 $inner: #NameExpr['EOL']
                              ]
                           ]
                           $statement: #LShiftExpr[
                              $left: #NameExpr['buf']
                              $right: #StringExpr[
                                 $inner: #NameExpr['EOL']
                              ]
                           ]
                        ]
                     ]
                     $statement: #LShiftExpr[
                        $left: #NameExpr['buf']
                        $right: #StringExpr[
                           $inner: #NameExpr['content_type']
                           $inner: #NameExpr['EOL']
                        ]
                     ]
                     $statement: #IfExpr[
                        $cond: #NameExpr['@output_cookies']
                        $then: #ApplyExpr[
                           $recv: #NameExpr['@output_cookies']
                           $recv: #NameExpr['each']
                           $body: #Block[
                              $param: #NameExpr['cookie']
                              $body: #LShiftExpr[
                                 $left: #NameExpr['buf']
                                 $right: #StringExpr[
                                    $inner: #NameExpr['cookie']
                                    $inner: #NameExpr['EOL']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #RReturnStmt[
                        $expr: #List[
                           $expression: #NameExpr['buf']
                        ]
                     ]
                  ]
               ]
            ]
            $statement: #ApplyExpr[
               #Self['self']
               $recv: #NameExpr['private']
               $param: #List[
                  $expression: #NameExpr['_header_for_string']
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['_header_for_hash']
               $param: #List[
                  $param: #Param[
                     $param: #NameExpr['options']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #List[
                     $statement: #AssignExpr[
                        $left: #NameExpr['buf']
                        $right: #StringExpr['']
                     ]
                     $statement: #LOrAssign[
                        $left: #Indexer[
                           $base: #NameExpr['options']
                           $index: #List[
                              $expression: #StringExpr['type']
                           ]
                        ]
                        $right: #StringExpr['text/html']
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['charset']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['charset']
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $then: #AddAssign[
                           $left: #Indexer[
                              $base: #NameExpr['options']
                              $index: #List[
                                 $expression: #StringExpr['type']
                              ]
                           ]
                           $right: #StringExpr[
                              $inner: #NameExpr['charset']
                           ]
                        ]
                        $cond: #NameExpr['charset']
                     ]
                     $statement: #IfExpr[
                        $then: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['nph']
                           ]
                        ]
                        $cond: #Defined[
                           $base: #NameExpr['MOD_RUBY']
                        ]
                     ]
                     $statement: #IfExpr[
                        $cond: #LOr[
                           $left: #ApplyExpr[
                              $recv: #NameExpr['options']
                              $recv: #NameExpr['delete']
                              $param: #List[
                                 $expression: #StringExpr['nph']
                              ]
                           ]
                           $right: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['nph?']
                              $param: #Empty['']
                           ]
                        ]
                        $then: #List[
                           $statement: #AssignExpr[
                              $left: #NameExpr['protocol']
                              $right: #LOr[
                                 $left: #Indexer[
                                    $recv: #NameExpr['$CGI_ENV']
                                    $index: #List[
                                       $expression: #StringExpr['SERVER_PROTOCOL']
                                    ]
                                 ]
                                 $right: #StringExpr['HTTP/1.0']
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['status']
                              $right: #ApplyExpr[
                                 $recv: #NameExpr['options']
                                 $recv: #NameExpr['delete']
                                 $param: #List[
                                    $expression: #StringExpr['status']
                                 ]
                              ]
                           ]
                           $statement: #AssignExpr[
                              $left: #NameExpr['status']
                              $right: #LOr[
                                 $left: #LOr[
                                    $left: #Indexer[
                                       $recv: #NameExpr['HTTP_STATUS']
                                       $index: #List[
                                          $expression: #NameExpr['status']
                                       ]
                                    ]
                                    $right: #NameExpr['status']
                                 ]
                                 $right: #StringExpr['200 OK']
                              ]
                           ]
                           $statement: #LShiftExpr[
                              $left: #NameExpr['buf']
                              $right: #StringExpr[
                                 $inner: #NameExpr['protocol']
                                 $inner: #NameExpr['status']
                                 $inner: #NameExpr['EOL']
                              ]
                           ]
                           $statement: #LShiftExpr[
                              $left: #NameExpr['buf']
                              $right: #StringExpr[
                                 $inner: #ApplyExpr[
                                    $recv: #NameExpr['CGI']
                                    $recv: #NameExpr['rfc1123_date']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['Time']
                                          $recv: #NameExpr['now']
                                       ]
                                    ]
                                 ]
                                 $inner: #NameExpr['EOL']
                              ]
                           ]
                           $statement: #LOrAssign[
                              $left: #Indexer[
                                 $base: #NameExpr['options']
                                 $index: #List[
                                    $expression: #StringExpr['server']
                                 ]
                              ]
                              $right: #LOr[
                                 $left: #Indexer[
                                    $recv: #NameExpr['$CGI_ENV']
                                    $index: #List[
                                       $expression: #StringExpr['SERVER_SOFTWARE']
                                    ]
                                 ]
                                 $right: #StringExpr['']
                              ]
                           ]
                           $statement: #LOrAssign[
                              $left: #Indexer[
                                 $base: #NameExpr['options']
                                 $index: #List[
                                    $expression: #StringExpr['connection']
                                 ]
                              ]
                              $right: #StringExpr['close']
                           ]
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['status']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['status']
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $then: #LShiftExpr[
                           $left: #NameExpr['buf']
                           $right: #StringExpr[
                              $inner: #LOr[
                                 $left: #Indexer[
                                    $recv: #NameExpr['HTTP_STATUS']
                                    $index: #List[
                                       $expression: #NameExpr['status']
                                    ]
                                 ]
                                 $right: #NameExpr['status']
                              ]
                              $inner: #NameExpr['EOL']
                           ]
                        ]
                        $cond: #NameExpr['status']
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['server']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['server']
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $then: #LShiftExpr[
                           $left: #NameExpr['buf']
                           $right: #StringExpr[
                              $inner: #NameExpr['server']
                              $inner: #NameExpr['EOL']
                           ]
                        ]
                        $cond: #NameExpr['server']
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['connection']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['connection']
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $then: #LShiftExpr[
                           $left: #NameExpr['buf']
                           $right: #StringExpr[
                              $inner: #NameExpr['connection']
                              $inner: #NameExpr['EOL']
                           ]
                        ]
                        $cond: #NameExpr['connection']
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['type']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['type']
                           ]
                        ]
                     ]
                     $statement: #LShiftExpr[
                        $left: #NameExpr['buf']
                        $right: #StringExpr[
                           $inner: #NameExpr['type']
                           $inner: #NameExpr['EOL']
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['length']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['length']
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $then: #LShiftExpr[
                           $left: #NameExpr['buf']
                           $right: #StringExpr[
                              $inner: #NameExpr['length']
                              $inner: #NameExpr['EOL']
                           ]
                        ]
                        $cond: #NameExpr['length']
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['language']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['language']
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $then: #LShiftExpr[
                           $left: #NameExpr['buf']
                           $right: #StringExpr[
                              $inner: #NameExpr['language']
                              $inner: #NameExpr['EOL']
                           ]
                        ]
                        $cond: #NameExpr['language']
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['expires']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['delete']
                           $param: #List[
                              $expression: #StringExpr['expires']
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $then: #LShiftExpr[
                           $left: #NameExpr['buf']
                           $right: #StringExpr[
                              $inner: #ApplyExpr[
                                 $recv: #NameExpr['CGI']
                                 $recv: #NameExpr['rfc1123_date']
                                 $param: #List[
                                    $expression: #NameExpr['expires']
                                 ]
                              ]
                              $inner: #NameExpr['EOL']
                           ]
                        ]
                        $cond: #NameExpr['expires']
                     ]
                     $statement: #IfExpr[
                        $cond: #AssignExpr[
                           $left: #NameExpr['cookie']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['options']
                              $recv: #NameExpr['delete']
                              $param: #List[
                                 $expression: #StringExpr['cookie']
                              ]
                           ]
                        ]
                        $then: #Case[
                           $cond: #NameExpr['cookie']
                           $body: #List[
                              $when: #When[
                                 $cond: #List[
                                    $expression: #NameExpr['String']
                                    $expression: #NameExpr['Cookie']
                                 ]
                                 $then: #LShiftExpr[
                                    $left: #NameExpr['buf']
                                    $right: #StringExpr[
                                       $inner: #NameExpr['cookie']
                                       $inner: #NameExpr['EOL']
                                    ]
                                 ]
                              ]
                              $when: #When[
                                 $cond: #List[
                                    $expression: #NameExpr['Array']
                                 ]
                                 $then: #List[
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['arr']
                                       $right: #NameExpr['cookie']
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['arr']
                                       $recv: #NameExpr['each']
                                       $body: #Block[
                                          $param: #NameExpr['c']
                                          $body: #LShiftExpr[
                                             $left: #NameExpr['buf']
                                             $right: #StringExpr[
                                                $inner: #NameExpr['c']
                                                $inner: #NameExpr['EOL']
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                              $when: #When[
                                 $cond: #List[
                                    $expression: #NameExpr['Hash']
                                 ]
                                 $then: #List[
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['hash']
                                       $right: #NameExpr['cookie']
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['hash']
                                       $recv: #NameExpr['each_value']
                                       $body: #Block[
                                          $param: #NameExpr['c']
                                          $body: #LShiftExpr[
                                             $left: #NameExpr['buf']
                                             $right: #StringExpr[
                                                $inner: #NameExpr['c']
                                                $inner: #NameExpr['EOL']
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $cond: #NameExpr['@output_cookies']
                        $then: #ApplyExpr[
                           $recv: #NameExpr['@output_cookies']
                           $recv: #NameExpr['each']
                           $body: #Block[
                              $param: #NameExpr['c']
                              $body: #LShiftExpr[
                                 $left: #NameExpr['buf']
                                 $right: #StringExpr[
                                    $inner: #NameExpr['c']
                                    $inner: #NameExpr['EOL']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #ApplyExpr[
                        $recv: #NameExpr['options']
                        $recv: #NameExpr['each']
                        $body: #Block[
                           $param: #MultipleLeftHandSideExpression[
                              $item: #NameExpr['key']
                              $item: #NameExpr['value']
                           ]
                           $body: #LShiftExpr[
                              $left: #NameExpr['buf']
                              $right: #StringExpr[
                                 $inner: #NameExpr['key']
                                 $inner: #NameExpr['value']
                                 $inner: #NameExpr['EOL']
                              ]
                           ]
                        ]
                     ]
                     $statement: #RReturnStmt[
                        $expr: #List[
                           $expression: #NameExpr['buf']
                        ]
                     ]
                  ]
               ]
            ]
            $statement: #ApplyExpr[
               #Self['self']
               $recv: #NameExpr['private']
               $param: #List[
                  $expression: #NameExpr['_header_for_hash']
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['nph?']
               $param: #List['']
               $body: #BlockExpr[
                  $main: #RReturnStmt[
                     $expr: #List[
                        $command: #ApplyExpr[
                           $base: #ApplyExpr[
                              $recv: #Regex['/IIS\\/(\\d+)/']
                              $recv: #NameExpr['match']
                              $param: #List[
                                 $expression: #Indexer[
                                    $recv: #NameExpr['$CGI_ENV']
                                    $index: #List[
                                       $expression: #StringExpr['SERVER_SOFTWARE']
                                    ]
                                 ]
                              ]
                           ]
                           $recv: #NameExpr['&']
                           $param: #List[
                              $expression: #LtExpr[
                                 $left: #ApplyExpr[
                                    $recv: #MatchedRegex['$1']
                                    $recv: #NameExpr['to_i']
                                 ]
                                 $right: #IntExpr['5']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['_header_for_modruby']
               $param: #List[
                  $param: #Param[
                     $param: #NameExpr['buf']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #List[
                     $statement: #AssignExpr[
                        $left: #NameExpr['request']
                        $right: #ApplyExpr[
                           $recv: #NameExpr['Apache']
                           $recv: #NameExpr['request']
                        ]
                     ]
                     $statement: #ApplyExpr[
                        $recv: #NameExpr['buf']
                        $recv: #NameExpr['scan']
                        $param: #List[
                           $expression: #Regex['/([^:]+): (.+)#{EOL}/o']
                        ]
                        $body: #Block[
                           $param: #MultipleLeftHandSideExpression[
                              $item: #NameExpr['name']
                              $item: #NameExpr['value']
                           ]
                           $body: #List[
                              $statement: #IfExpr[
                                 $then: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['warn']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['sprintf']
                                          $param: #List[
                                             $expression: #StringExpr['name:%s value:%s\\n']
                                             $expression: #NameExpr['name']
                                             $expression: #NameExpr['value']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $cond: #NameExpr['$DEBUG']
                              ]
                              $statement: #Case[
                                 $cond: #NameExpr['name']
                                 $body: #List[
                                    $when: #When[
                                       $cond: #List[
                                          $expression: #StringExpr['Set-Cookie']
                                       ]
                                       $then: #ApplyExpr[
                                          $recv: #ApplyExpr[
                                             $recv: #NameExpr['request']
                                             $recv: #NameExpr['headers_out']
                                          ]
                                          $recv: #NameExpr['add']
                                          $param: #List[
                                             $expression: #NameExpr['name']
                                             $expression: #NameExpr['value']
                                          ]
                                       ]
                                    ]
                                    $when: #When[
                                       $cond: #List[
                                          $expression: #Regex['/^status$/i']
                                       ]
                                       $then: #List[
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['request']
                                                $name: #NameExpr['status_line']
                                             ]
                                             $right: #NameExpr['value']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Field[
                                                $base: #NameExpr['request']
                                                $name: #NameExpr['status']
                                             ]
                                             $right: #ApplyExpr[
                                                $recv: #NameExpr['value']
                                                $recv: #NameExpr['to_i']
                                             ]
                                          ]
                                       ]
                                    ]
                                    $when: #When[
                                       $cond: #List[
                                          $expression: #Regex['/^content-type$/i']
                                       ]
                                       $then: #AssignExpr[
                                          $left: #Field[
                                             $base: #NameExpr['request']
                                             $name: #NameExpr['content_type']
                                          ]
                                          $right: #NameExpr['value']
                                       ]
                                    ]
                                    $when: #When[
                                       $cond: #List[
                                          $expression: #Regex['/^content-encoding$/i']
                                       ]
                                       $then: #AssignExpr[
                                          $left: #Field[
                                             $base: #NameExpr['request']
                                             $name: #NameExpr['content_encoding']
                                          ]
                                          $right: #NameExpr['value']
                                       ]
                                    ]
                                    $when: #When[
                                       $cond: #List[
                                          $expression: #Regex['/^location$/i']
                                       ]
                                       $then: #List[
                                          $statement: #IfExpr[
                                             $then: #AssignExpr[
                                                $left: #Field[
                                                   $base: #NameExpr['request']
                                                   $name: #NameExpr['status']
                                                ]
                                                $right: #IntExpr['302']
                                             ]
                                             $cond: #EqExpr[
                                                $left: #ApplyExpr[
                                                   $recv: #NameExpr['request']
                                                   $recv: #NameExpr['status']
                                                ]
                                                $right: #IntExpr['200']
                                             ]
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Indexer[
                                                $base: #ApplyExpr[
                                                   $recv: #NameExpr['request']
                                                   $recv: #NameExpr['headers_out']
                                                ]
                                                $index: #List[
                                                   $expression: #NameExpr['name']
                                                ]
                                             ]
                                             $right: #NameExpr['value']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $else: #AssignExpr[
                                    $left: #Indexer[
                                       $base: #ApplyExpr[
                                          $recv: #NameExpr['request']
                                          $recv: #NameExpr['headers_out']
                                       ]
                                       $index: #List[
                                          $expression: #NameExpr['name']
                                       ]
                                    ]
                                    $right: #NameExpr['value']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #ApplyExpr[
                        $recv: #NameExpr['request']
                        $recv: #NameExpr['send_http_header']
                     ]
                     $statement: #RReturnStmt[
                        $expr: #List[
                           $expression: #StringExpr['']
                        ]
                     ]
                  ]
               ]
            ]
            $statement: #ApplyExpr[
               #Self['self']
               $recv: #NameExpr['private']
               $param: #List[
                  $expression: #NameExpr['_header_for_modruby']
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['out']
               $param: #List[
                  $param: #OptionalParam[
                     $name: #NameExpr['options']
                     $default: #StringExpr['text/html']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #List[
                     $statement: #IfExpr[
                        $then: #AssignExpr[
                           $left: #NameExpr['options']
                           $right: #List[
                              $hash: #Hash[
                                 $key: #StringExpr['type']
                                 $value: #NameExpr['options']
                              ]
                           ]
                        ]
                        $cond: #ApplyExpr[
                           $recv: #NameExpr['options']
                           $recv: #NameExpr['kind_of?']
                           $param: #List[
                              $expression: #NameExpr['String']
                           ]
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['content']
                        $right: #Yield['yield']
                     ]
                     $statement: #AssignExpr[
                        $left: #Indexer[
                           $base: #NameExpr['options']
                           $index: #List[
                              $expression: #StringExpr['length']
                           ]
                        ]
                        $right: #ApplyExpr[
                           $recv: #ApplyExpr[
                              $recv: #NameExpr['content']
                              $recv: #NameExpr['bytesize']
                           ]
                           $recv: #NameExpr['to_s']
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['output']
                        $right: #NameExpr['stdoutput']
                     ]
                     $statement: #IfExpr[
                        $then: #ApplyExpr[
                           $recv: #NameExpr['output']
                           $recv: #NameExpr['binmode']
                        ]
                        $cond: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['defined?']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['output']
                                 $recv: #NameExpr['binmode']
                              ]
                           ]
                        ]
                     ]
                     $statement: #ApplyExpr[
                        $base: #NameExpr['output']
                        $recv: #NameExpr['print']
                        $param: #List[
                           $expression: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['http_header']
                              $param: #List[
                                 $expression: #NameExpr['options']
                              ]
                           ]
                        ]
                     ]
                     $statement: #Unless[
                        $then: #ApplyExpr[
                           $base: #NameExpr['output']
                           $recv: #NameExpr['print']
                           $param: #List[
                              $expression: #NameExpr['content']
                           ]
                        ]
                        $cond: #EqExpr[
                           $left: #StringExpr['HEAD']
                           $right: #Indexer[
                              $recv: #NameExpr['env_table']
                              $index: #List[
                                 $expression: #StringExpr['REQUEST_METHOD']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['print']
               $param: #List[
                  $param: #VariadicParam[
                     $name: #NameExpr['options']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #ApplyExpr[
                     $recv: #NameExpr['stdoutput']
                     $recv: #NameExpr['print']
                     $param: #List[
                        $variadic: #Variadic[
                           $base: #NameExpr['options']
                        ]
                     ]
                  ]
               ]
            ]
            $statement: #SFuncDecl[
               $path: #NameExpr['CGI']
               $name: #NameExpr['parse']
               $param: #List[
                  $param: #Param[
                     $param: #NameExpr['query']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #List[
                     $statement: #AssignExpr[
                        $left: #NameExpr['params']
                        $right: #List['{}']
                     ]
                     $statement: #ApplyExpr[
                        $recv: #ApplyExpr[
                           $recv: #NameExpr['query']
                           $recv: #NameExpr['split']
                           $param: #List[
                              $expression: #Regex['/[&;]/']
                           ]
                        ]
                        $recv: #NameExpr['each']
                        $body: #Block[
                           $param: #NameExpr['pairs']
                           $body: #List[
                              $statement: #MultipleAssign[
                                 $left: #MultipleLeftHandSideExpression[
                                    $item: #NameExpr['key']
                                    $item: #NameExpr['value']
                                 ]
                                 $right: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['pairs']
                                       $recv: #NameExpr['split']
                                       $param: #List[
                                          $expression: #StringExpr['=']
                                          $expression: #IntExpr['2']
                                       ]
                                    ]
                                    $recv: #NameExpr['collect']
                                    $body: #Block[
                                       $param: #NameExpr['v']
                                       $body: #ApplyExpr[
                                          $recv: #NameExpr['CGI']
                                          $recv: #NameExpr['unescape']
                                          $param: #List[
                                             $expression: #NameExpr['v']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                              $statement: #Unless[
                                 $then: #Next['next']
                                 $cond: #NameExpr['key']
                              ]
                              $statement: #LOrAssign[
                                 $left: #Indexer[
                                    $base: #NameExpr['params']
                                    $index: #List[
                                       $expression: #NameExpr['key']
                                    ]
                                 ]
                                 $right: #Array['[]']
                              ]
                              $statement: #IfExpr[
                                 $then: #ApplyExpr[
                                    $recv: #Indexer[
                                       $recv: #NameExpr['params']
                                       $index: #List[
                                          $expression: #NameExpr['key']
                                       ]
                                    ]
                                    $recv: #NameExpr['push']
                                    $param: #List[
                                       $expression: #NameExpr['value']
                                    ]
                                 ]
                                 $cond: #NameExpr['value']
                              ]
                           ]
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #Field[
                           $base: #NameExpr['params']
                           $name: #NameExpr['default']
                        ]
                        $right: #ApplyExpr[
                           $recv: #Array['[]']
                           $recv: #NameExpr['freeze']
                        ]
                     ]
                     $statement: #NameExpr['params']
                  ]
               ]
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['MAX_MULTIPART_COUNT']
               $right: #IntExpr['128']
            ]
            $statement: #Module[
               $name: #NameExpr['QueryExtension']
               $body: #BlockExpr[
                  $main: #List[
                     $statement: #ApplyExpr[
                        $recv: #ParcentNotation['%w[ CONTENT_LENGTH SERVER_PORT ]']
                        $recv: #NameExpr['each']
                        $body: #Block[
                           $param: #NameExpr['env']
                           $body: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['define_method']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['env']
                                       $recv: #NameExpr['sub']
                                       $param: #List[
                                          $expression: #Regex['/^HTTP_/']
                                          $expression: #StringExpr['']
                                       ]
                                    ]
                                    $recv: #NameExpr['downcase']
                                 ]
                              ]
                              $body: #Block[
                                 $body: #ApplyExpr[
                                    $base: #AssignExpr[
                                       $left: #NameExpr['val']
                                       $right: #Indexer[
                                          $recv: #NameExpr['env_table']
                                          $index: #List[
                                             $expression: #NameExpr['env']
                                          ]
                                       ]
                                    ]
                                    $recv: #NameExpr['&']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['Integer']
                                          $param: #List[
                                             $expression: #NameExpr['val']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #ApplyExpr[
                        $recv: #ParcentNotation['%w[ AUTH_TYPE CONTENT_TYPE GATEWAY_INTERFACE PATH_INFO\n        PATH_TRANSLATED QUERY_STRING REMOTE_ADDR REMOTE_HOST\n        REMOTE_IDENT REMOTE_USER REQUEST_METHOD SCRIPT_NAME\n        SERVER_NAME SERVER_PROTOCOL SERVER_SOFTWARE\n\n        HTTP_ACCEPT HTTP_ACCEPT_CHARSET HTTP_ACCEPT_ENCODING\n        HTTP_ACCEPT_LANGUAGE HTTP_CACHE_CONTROL HTTP_FROM HTTP_HOST\n        HTTP_NEGOTIATE HTTP_PRAGMA HTTP_REFERER HTTP_USER_AGENT ]']
                        $recv: #NameExpr['each']
                        $body: #Block[
                           $param: #NameExpr['env']
                           $body: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['define_method']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #NameExpr['env']
                                       $recv: #NameExpr['sub']
                                       $param: #List[
                                          $expression: #Regex['/^HTTP_/']
                                          $expression: #StringExpr['']
                                       ]
                                    ]
                                    $recv: #NameExpr['downcase']
                                 ]
                              ]
                              $body: #Block[
                                 $body: #Indexer[
                                    $recv: #NameExpr['env_table']
                                    $index: #List[
                                       $expression: #NameExpr['env']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['raw_cookie']
                        $param: #List['']
                        $body: #BlockExpr[
                           $main: #Indexer[
                              $recv: #NameExpr['env_table']
                              $index: #List[
                                 $expression: #StringExpr['HTTP_COOKIE']
                              ]
                           ]
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['raw_cookie2']
                        $param: #List['']
                        $body: #BlockExpr[
                           $main: #Indexer[
                              $recv: #NameExpr['env_table']
                              $index: #List[
                                 $expression: #StringExpr['HTTP_COOKIE2']
                              ]
                           ]
                        ]
                     ]
                     $statement: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['attr_accessor']
                        $param: #List[
                           $expression: #NameExpr['cookies']
                        ]
                     ]
                     $statement: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['attr_reader']
                        $param: #List[
                           $expression: #NameExpr['params']
                        ]
                     ]
                     $statement: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['attr_reader']
                        $param: #List[
                           $expression: #NameExpr['files']
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['params=']
                        $param: #List[
                           $param: #Param[
                              $param: #NameExpr['hash']
                           ]
                        ]
                        $body: #BlockExpr[
                           $main: #List[
                              $statement: #ApplyExpr[
                                 $recv: #NameExpr['@params']
                                 $recv: #NameExpr['clear']
                              ]
                              $statement: #ApplyExpr[
                                 $recv: #NameExpr['@params']
                                 $recv: #NameExpr['update']
                                 $param: #List[
                                    $expression: #NameExpr['hash']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['read_multipart']
                        $param: #List[
                           $param: #Param[
                              $param: #NameExpr['boundary']
                           ]
                           $param: #Param[
                              $param: #NameExpr['content_length']
                           ]
                        ]
                        $body: #BlockExpr[
                           $main: #List[
                              $statement: #AssignExpr[
                                 $left: #NameExpr['stdin']
                                 $right: #NameExpr['stdinput']
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['first_line']
                                 $right: #StringExpr[
                                    $inner: #NameExpr['boundary']
                                    $inner: #NameExpr['EOL']
                                 ]
                              ]
                              $statement: #SubAssign[
                                 $left: #NameExpr['content_length']
                                 $right: #ApplyExpr[
                                    $recv: #NameExpr['first_line']
                                    $recv: #NameExpr['bytesize']
                                 ]
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['status']
                                 $right: #ApplyExpr[
                                    $recv: #NameExpr['stdin']
                                    $recv: #NameExpr['read']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['first_line']
                                          $recv: #NameExpr['bytesize']
                                       ]
                                    ]
                                 ]
                              ]
                              $statement: #Unless[
                                 $then: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['raise']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['EOFError']
                                          $recv: #NameExpr['new']
                                          $param: #List[
                                             $expression: #StringExpr['no content body']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $cond: #NameExpr['status']
                              ]
                              $statement: #Unless[
                                 $then: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['raise']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['EOFError']
                                          $recv: #NameExpr['new']
                                          $param: #List[
                                             $expression: #StringExpr['bad content body']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $cond: #EqExpr[
                                    $left: #NameExpr['first_line']
                                    $right: #NameExpr['status']
                                 ]
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['params']
                                 $right: #List['{}']
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['@files']
                                 $right: #List['{}']
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['boundary_rexp']
                                 $right: #Regex['/--#{Regexp.quote(boundary)}(#{EOL}|--)/']
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['boundary_size']
                                 $right: #ApplyExpr[
                                    $recv: #StringExpr[
                                       $inner: #NameExpr['EOL']
                                       $inner: #NameExpr['boundary']
                                       $inner: #NameExpr['EOL']
                                    ]
                                    $recv: #NameExpr['bytesize']
                                 ]
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['buf']
                                 $right: #StringExpr['']
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['bufsize']
                                 $right: #MulExpr[
                                    $left: #IntExpr['10']
                                    $right: #IntExpr['1024']
                                 ]
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['max_count']
                                 $right: #NameExpr['MAX_MULTIPART_COUNT']
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['n']
                                 $right: #IntExpr['0']
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['tempfiles']
                                 $right: #Array['[]']
                              ]
                              $statement: #While[
                                 $cond: #TrueExpr['true']
                                 $body: #List[
                                    $statement: #OrExpr[
                                       $left: #LtExpr[
                                          $left: #AddAssign[
                                             $left: #NameExpr['n']
                                             $right: #IntExpr['1']
                                          ]
                                          $right: #NameExpr['max_count']
                                       ]
                                       $right: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['raise']
                                          $param: #List[
                                             $expression: #ApplyExpr[
                                                $recv: #NameExpr['StandardError']
                                                $recv: #NameExpr['new']
                                                $param: #List[
                                                   $expression: #StringExpr['too many parameters.']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['body']
                                       $right: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['create_body']
                                          $param: #List[
                                             $expression: #LtExpr[
                                                $left: #NameExpr['bufsize']
                                                $right: #NameExpr['content_length']
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #IfExpr[
                                       $then: #LShiftExpr[
                                          $left: #NameExpr['tempfiles']
                                          $right: #NameExpr['body']
                                       ]
                                       $cond: #Defined[
                                          $base: #LAnd[
                                             $left: #NameExpr['Tempfile']
                                             $right: #ApplyExpr[
                                                $recv: #NameExpr['body']
                                                $recv: #NameExpr['kind_of?']
                                                $param: #List[
                                                   $expression: #NameExpr['Tempfile']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #SClass[
                                       $path: #NameExpr['body']
                                       $body: #BlockExpr[
                                          $main: #List[
                                             $statement: #IfExpr[
                                                $cond: #ApplyExpr[
                                                   #Self['self']
                                                   $recv: #NameExpr['method_defined?']
                                                   $param: #List[
                                                      $expression: #NameExpr['path']
                                                   ]
                                                ]
                                                $then: #Alias[
                                                   $newname: #NameExpr['local_path']
                                                   $target: #NameExpr['path']
                                                ]
                                                $else: #FuncDecl[
                                                   $name: #NameExpr['local_path']
                                                   $param: #List['']
                                                   $body: #BlockExpr[
                                                      $main: #Nil['nil']
                                                   ]
                                                ]
                                             ]
                                             $statement: #ApplyExpr[
                                                #Self['self']
                                                $recv: #NameExpr['attr_reader']
                                                $param: #List[
                                                   $expression: #NameExpr['original_filename']
                                                   $expression: #NameExpr['content_type']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['head']
                                       $right: #Nil['nil']
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['separator']
                                       $right: #MulExpr[
                                          $left: #NameExpr['EOL']
                                          $right: #IntExpr['2']
                                       ]
                                    ]
                                    $statement: #Until[
                                       $cond: #ApplyExpr[
                                          $base: #NameExpr['head']
                                          $recv: #NameExpr['&']
                                          $param: #List[
                                             $expression: #AssignExpr[
                                                $left: #NameExpr['matched']
                                                $right: #ApplyExpr[
                                                   $recv: #NameExpr['boundary_rexp']
                                                   $recv: #NameExpr['match']
                                                   $param: #List[
                                                      $expression: #NameExpr['buf']
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                       $body: #IfExpr[
                                          $cond: #[
                                             $base: #ApplyExpr[
                                                $base: #NameExpr['head']
                                                $recv: #NameExpr['&']
                                                $param: #List[
                                                   $expression: #AssignExpr[
                                                      $left: #NameExpr['pos']
                                                      $right: #ApplyExpr[
                                                         $recv: #NameExpr['buf']
                                                         $recv: #NameExpr['index']
                                                         $param: #List[
                                                            $expression: #NameExpr['separator']
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $then: #List[
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['len']
                                                $right: #AddExpr[
                                                   $left: #NameExpr['pos']
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['EOL']
                                                      $recv: #NameExpr['bytesize']
                                                   ]
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['head']
                                                $right: #Indexer[
                                                   $recv: #NameExpr['buf']
                                                   $index: #List[
                                                      $expression: #IntExpr['0']
                                                      $expression: #NameExpr['len']
                                                   ]
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['buf']
                                                $right: #Indexer[
                                                   $recv: #NameExpr['buf']
                                                   $index: #List[
                                                      $expression: #ClosedRange[
                                                         #AddExpr[
                                                            $left: #NameExpr['pos']
                                                            $right: #ApplyExpr[
                                                               $recv: #NameExpr['separator']
                                                               $recv: #NameExpr['bytesize']
                                                            ]
                                                         ]
                                                         #MinusExpr[
                                                            $expr: #IntExpr['1']
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $else: #List[
                                             $statement: #IfExpr[
                                                $cond: #ApplyExpr[
                                                   $base: #NameExpr['head']
                                                   $recv: #NameExpr['&']
                                                   $param: #List[
                                                      $expression: #GtExpr[
                                                         $left: #ApplyExpr[
                                                            $recv: #NameExpr['buf']
                                                            $recv: #NameExpr['size']
                                                         ]
                                                         $right: #NameExpr['boundary_size']
                                                      ]
                                                   ]
                                                ]
                                                $then: #List[
                                                   $statement: #AssignExpr[
                                                      $left: #NameExpr['len']
                                                      $right: #SubExpr[
                                                         $left: #ApplyExpr[
                                                            $recv: #NameExpr['buf']
                                                            $recv: #NameExpr['size']
                                                         ]
                                                         $right: #NameExpr['boundary_size']
                                                      ]
                                                   ]
                                                   $statement: #ApplyExpr[
                                                      $recv: #NameExpr['body']
                                                      $recv: #NameExpr['print']
                                                      $param: #List[
                                                         $expression: #Indexer[
                                                            $recv: #NameExpr['buf']
                                                            $index: #List[
                                                               $expression: #IntExpr['0']
                                                               $expression: #NameExpr['len']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                   $statement: #AssignExpr[
                                                      $left: #Indexer[
                                                         $base: #NameExpr['buf']
                                                         $index: #List[
                                                            $expression: #IntExpr['0']
                                                            $expression: #NameExpr['len']
                                                         ]
                                                      ]
                                                      $right: #StringExpr['']
                                                   ]
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['c']
                                                $right: #ApplyExpr[
                                                   $recv: #NameExpr['stdin']
                                                   $recv: #NameExpr['read']
                                                   $param: #List[
                                                      $expression: #Conditional[
                                                         $cond: #LtExpr[
                                                            $left: #NameExpr['bufsize']
                                                            $right: #NameExpr['content_length']
                                                         ]
                                                         $then: #NameExpr['bufsize']
                                                         $else: #NameExpr['content_length']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                             $statement: #IfExpr[
                                                $then: #ApplyExpr[
                                                   #Self['self']
                                                   $recv: #NameExpr['raise']
                                                   $param: #List[
                                                      $expression: #ApplyExpr[
                                                         $recv: #NameExpr['EOFError']
                                                         $recv: #NameExpr['new']
                                                         $param: #List[
                                                            $expression: #StringExpr['bad content body']
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                                $cond: #LOr[
                                                   $left: #ApplyExpr[
                                                      $recv: #NameExpr['c']
                                                      $recv: #NameExpr['nil?']
                                                   ]
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['c']
                                                      $recv: #NameExpr['empty?']
                                                   ]
                                                ]
                                             ]
                                             $statement: #LShiftExpr[
                                                $left: #NameExpr['buf']
                                                $right: #NameExpr['c']
                                             ]
                                             $statement: #SubAssign[
                                                $left: #NameExpr['content_length']
                                                $right: #ApplyExpr[
                                                   $recv: #NameExpr['c']
                                                   $recv: #NameExpr['bytesize']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['m']
                                       $right: #NameExpr['matched']
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['len']
                                       $right: #ApplyExpr[
                                          $recv: #NameExpr['m']
                                          $recv: #NameExpr['begin']
                                          $param: #List[
                                             $expression: #IntExpr['0']
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['s']
                                       $right: #Indexer[
                                          $recv: #NameExpr['buf']
                                          $index: #List[
                                             $expression: #IntExpr['0']
                                             $expression: #NameExpr['len']
                                          ]
                                       ]
                                    ]
                                    $statement: #IfExpr[
                                       $cond: #AssignExpr[
                                          $left: #NameExpr['s']
                                          $right: #ComplExpr[
                                             $expr: #Regex['/(\\r?\\n)\\z/']
                                          ]
                                       ]
                                       $then: #AssignExpr[
                                          $left: #NameExpr['s']
                                          $right: #Indexer[
                                             $recv: #NameExpr['buf']
                                             $index: #List[
                                                $expression: #IntExpr['0']
                                                $expression: #SubExpr[
                                                   $left: #NameExpr['len']
                                                   $right: #ApplyExpr[
                                                      $recv: #MatchedRegex['$1']
                                                      $recv: #NameExpr['bytesize']
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['body']
                                       $recv: #NameExpr['print']
                                       $param: #List[
                                          $expression: #NameExpr['s']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['buf']
                                       $right: #Indexer[
                                          $recv: #NameExpr['buf']
                                          $index: #List[
                                             $expression: #ClosedRange[
                                                #ApplyExpr[
                                                   $recv: #NameExpr['m']
                                                   $recv: #NameExpr['end']
                                                   $param: #List[
                                                      $expression: #IntExpr['0']
                                                   ]
                                                ]
                                                #MinusExpr[
                                                   $expr: #IntExpr['1']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['boundary_end']
                                       $right: #Indexer[
                                          $recv: #NameExpr['m']
                                          $index: #List[
                                             $expression: #IntExpr['1']
                                          ]
                                       ]
                                    ]
                                    $statement: #IfExpr[
                                       $then: #AssignExpr[
                                          $left: #NameExpr['content_length']
                                          $right: #MinusExpr[
                                             $expr: #IntExpr['1']
                                          ]
                                       ]
                                       $cond: #EqExpr[
                                          $left: #NameExpr['boundary_end']
                                          $right: #StringExpr['--']
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['body']
                                       $recv: #NameExpr['rewind']
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #Regex['/Content-Disposition:.* filename=(?:"(.*?)"|([^;\\r\\n]*))/i']
                                       $recv: #NameExpr['match']
                                       $param: #List[
                                          $expression: #NameExpr['head']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['filename']
                                       $right: #LOr[
                                          $left: #LOr[
                                             $left: #MatchedRegex['$1']
                                             $right: #MatchedRegex['$2']
                                          ]
                                          $right: #StringExpr['']
                                       ]
                                    ]
                                    $statement: #IfExpr[
                                       $then: #AssignExpr[
                                          $left: #NameExpr['filename']
                                          $right: #ApplyExpr[
                                             $recv: #NameExpr['CGI']
                                             $recv: #NameExpr['unescape']
                                             $param: #List[
                                                $expression: #NameExpr['filename']
                                             ]
                                          ]
                                       ]
                                       $cond: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['unescape_filename?']
                                          $param: #Empty['']
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['body']
                                       $recv: #NameExpr['instance_variable_set']
                                       $param: #List[
                                          $expression: #NameExpr['@original_filename']
                                          $expression: #ApplyExpr[
                                             $recv: #NameExpr['filename']
                                             $recv: #NameExpr['taint']
                                          ]
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #Regex['/Content-Type: (.*)/i']
                                       $recv: #NameExpr['match']
                                       $param: #List[
                                          $expression: #NameExpr['head']
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #AssignExpr[
                                          $left: #NameExpr['content_type']
                                          $right: #LOr[
                                             $left: #MatchedRegex['$1']
                                             $right: #StringExpr['']
                                          ]
                                       ]
                                       $recv: #NameExpr['chomp!']
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #NameExpr['body']
                                       $recv: #NameExpr['instance_variable_set']
                                       $param: #List[
                                          $expression: #NameExpr['@content_type']
                                          $expression: #ApplyExpr[
                                             $recv: #NameExpr['content_type']
                                             $recv: #NameExpr['taint']
                                          ]
                                       ]
                                    ]
                                    $statement: #ApplyExpr[
                                       $recv: #Regex['/Content-Disposition:.* name=(?:"(.*?)"|([^;\\r\\n]*))/i']
                                       $recv: #NameExpr['match']
                                       $param: #List[
                                          $expression: #NameExpr['head']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['name']
                                       $right: #LOr[
                                          $left: #LOr[
                                             $left: #MatchedRegex['$1']
                                             $right: #MatchedRegex['$2']
                                          ]
                                          $right: #StringExpr['']
                                       ]
                                    ]
                                    $statement: #IfExpr[
                                       $cond: #ApplyExpr[
                                          $recv: #ApplyExpr[
                                             $recv: #NameExpr['body']
                                             $recv: #NameExpr['original_filename']
                                          ]
                                          $recv: #NameExpr['empty?']
                                       ]
                                       $then: #List[
                                          $statement: #AssignExpr[
                                             $left: #NameExpr['value']
                                             $right: #ApplyExpr[
                                                $recv: #ApplyExpr[
                                                   $recv: #ApplyExpr[
                                                      $recv: #NameExpr['body']
                                                      $recv: #NameExpr['read']
                                                   ]
                                                   $recv: #NameExpr['dup']
                                                ]
                                                $recv: #NameExpr['force_encoding']
                                                $param: #List[
                                                   $expression: #NameExpr['@accept_charset']
                                                ]
                                             ]
                                          ]
                                          $statement: #IfExpr[
                                             $then: #ApplyExpr[
                                                $recv: #NameExpr['body']
                                                $recv: #NameExpr['close!']
                                             ]
                                             $cond: #Defined[
                                                $base: #LAnd[
                                                   $left: #NameExpr['Tempfile']
                                                   $right: #ApplyExpr[
                                                      $recv: #NameExpr['body']
                                                      $recv: #NameExpr['kind_of?']
                                                      $param: #List[
                                                         $expression: #NameExpr['Tempfile']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $statement: #LShiftExpr[
                                             $left: #LOrAssign[
                                                $left: #Indexer[
                                                   $base: #NameExpr['params']
                                                   $index: #List[
                                                      $expression: #NameExpr['name']
                                                   ]
                                                ]
                                                $right: #Array['[]']
                                             ]
                                             $right: #NameExpr['value']
                                          ]
                                          $statement: #Unless[
                                             $cond: #ApplyExpr[
                                                $recv: #NameExpr['value']
                                                $recv: #NameExpr['valid_encoding?']
                                             ]
                                             $then: #IfExpr[
                                                $cond: #NameExpr['@accept_charset_error_block']
                                                $then: #ApplyExpr[
                                                   $recv: #NameExpr['@accept_charset_error_block']
                                                   $recv: #NameExpr['call']
                                                   $param: #List[
                                                      $expression: #NameExpr['name']
                                                      $expression: #NameExpr['value']
                                                   ]
                                                ]
                                                $else: #ApplyExpr[
                                                   #Self['self']
                                                   $recv: #NameExpr['raise']
                                                   $param: #List[
                                                      $expression: #NameExpr['InvalidEncoding']
                                                      $expression: #StringExpr['Accept-Charset encoding error']
                                                   ]
                                                ]
                                             ]
                                          ]
                                          $statement: #ApplyExpr[
                                             $recv: #SClass[
                                                $path: #ApplyExpr[
                                                   $recv: #Indexer[
                                                      $recv: #NameExpr['params']
                                                      $index: #List[
                                                         $expression: #NameExpr['name']
                                                      ]
                                                   ]
                                                   $recv: #NameExpr['last']
                                                ]
                                                $body: #BlockExpr[
                                                   $main: #Self['self']
                                                ]
                                             ]
                                             $recv: #NameExpr['class_eval']
                                             $body: #Block[
                                                $body: #List[
                                                   $statement: #ApplyExpr[
                                                      #Self['self']
                                                      $recv: #NameExpr['define_method']
                                                      $param: #List[
                                                         $expression: #NameExpr['read']
                                                      ]
                                                      $body: #Block[
                                                         $body: #Self['self']
                                                      ]
                                                   ]
                                                   $statement: #ApplyExpr[
                                                      #Self['self']
                                                      $recv: #NameExpr['define_method']
                                                      $param: #List[
                                                         $expression: #NameExpr['original_filename']
                                                      ]
                                                      $body: #Block[
                                                         $body: #StringExpr['']
                                                      ]
                                                   ]
                                                   $statement: #ApplyExpr[
                                                      #Self['self']
                                                      $recv: #NameExpr['define_method']
                                                      $param: #List[
                                                         $expression: #NameExpr['content_type']
                                                      ]
                                                      $body: #Block[
                                                         $body: #StringExpr['']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                       $else: #List[
                                          $statement: #LShiftExpr[
                                             $left: #LOrAssign[
                                                $left: #Indexer[
                                                   $base: #NameExpr['params']
                                                   $index: #List[
                                                      $expression: #NameExpr['name']
                                                   ]
                                                ]
                                                $right: #Array['[]']
                                             ]
                                             $right: #NameExpr['body']
                                          ]
                                          $statement: #AssignExpr[
                                             $left: #Indexer[
                                                $base: #NameExpr['@files']
                                                $index: #List[
                                                   $expression: #NameExpr['name']
                                                ]
                                             ]
                                             $right: #NameExpr['body']
                                          ]
                                       ]
                                    ]
                                    $statement: #IfExpr[
                                       $then: #Break['break']
                                       $cond: #EqExpr[
                                          $left: #NameExpr['content_length']
                                          $right: #MinusExpr[
                                             $expr: #IntExpr['1']
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                              $statement: #Unless[
                                 $then: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['raise']
                                    $param: #List[
                                       $expression: #NameExpr['EOFError']
                                       $expression: #StringExpr['bad boundary end of body part']
                                    ]
                                 ]
                                 $cond: #AssignExpr[
                                    $left: #NameExpr['boundary_end']
                                    $right: #ComplExpr[
                                       $expr: #Regex['/--/']
                                    ]
                                 ]
                              ]
                              $statement: #AssignExpr[
                                 $left: #Field[
                                    $base: #NameExpr['params']
                                    $name: #NameExpr['default']
                                 ]
                                 $right: #Array['[]']
                              ]
                              $statement: #NameExpr['params']
                           ]
                           $rescue: #List[
                              $rescue: #Rescue[
                                 $class: #NameExpr['Exception']
                                 $then: #List[
                                    $statement: #IfExpr[
                                       $cond: #NameExpr['tempfiles']
                                       $then: #ApplyExpr[
                                          $recv: #NameExpr['tempfiles']
                                          $recv: #NameExpr['each']
                                          $body: #Block[
                                             $param: #NameExpr['t']
                                             $body: #IfExpr[
                                                $cond: #ApplyExpr[
                                                   $recv: #NameExpr['t']
                                                   $recv: #NameExpr['path']
                                                ]
                                                $then: #ApplyExpr[
                                                   $recv: #NameExpr['t']
                                                   $recv: #NameExpr['close!']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #NameExpr['raise']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['private']
                        $param: #List[
                           $expression: #NameExpr['read_multipart']
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['create_body']
                        $param: #List[
                           $param: #Param[
                              $param: #NameExpr['is_large']
                           ]
                        ]
                        $body: #BlockExpr[
                           $main: #List[
                              $statement: #IfExpr[
                                 $cond: #NameExpr['is_large']
                                 $then: #List[
                                    $statement: #ApplyExpr[
                                       #Self['self']
                                       $recv: #NameExpr['require']
                                       $param: #List[
                                          $expression: #StringExpr['tempfile']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['body']
                                       $right: #ApplyExpr[
                                          $recv: #NameExpr['Tempfile']
                                          $recv: #NameExpr['new']
                                          $param: #List[
                                             $expression: #StringExpr['CGI']
                                             $hash: #Hash[
                                                $key: #NameExpr['encoding']
                                                $value: #Field[
                                                   $recv: #NameExpr['Encoding']
                                                   $name: #NameExpr['ASCII_8BIT']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $else: #ExceptionBlock[
                                    $main: #List[
                                       $statement: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['require']
                                          $param: #List[
                                             $expression: #StringExpr['stringio']
                                          ]
                                       ]
                                       $statement: #AssignExpr[
                                          $left: #NameExpr['body']
                                          $right: #ApplyExpr[
                                             $recv: #NameExpr['StringIO']
                                             $recv: #NameExpr['new']
                                             $param: #List[
                                                $expression: #ApplyExpr[
                                                   $recv: #StringExpr['']
                                                   $recv: #NameExpr['force_encoding']
                                                   $param: #List[
                                                      $expression: #Field[
                                                         $recv: #NameExpr['Encoding']
                                                         $name: #NameExpr['ASCII_8BIT']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $rescue: #List[
                                       $rescue: #Rescue[
                                          $class: #NameExpr['LoadError']
                                          $then: #List[
                                             $statement: #ApplyExpr[
                                                #Self['self']
                                                $recv: #NameExpr['require']
                                                $param: #List[
                                                   $expression: #StringExpr['tempfile']
                                                ]
                                             ]
                                             $statement: #AssignExpr[
                                                $left: #NameExpr['body']
                                                $right: #ApplyExpr[
                                                   $recv: #NameExpr['Tempfile']
                                                   $recv: #NameExpr['new']
                                                   $param: #List[
                                                      $expression: #StringExpr['CGI']
                                                      $hash: #Hash[
                                                         $key: #NameExpr['encoding']
                                                         $value: #Field[
                                                            $recv: #NameExpr['Encoding']
                                                            $name: #NameExpr['ASCII_8BIT']
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                              $statement: #IfExpr[
                                 $then: #ApplyExpr[
                                    $recv: #NameExpr['body']
                                    $recv: #NameExpr['binmode']
                                 ]
                                 $cond: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['defined?']
                                    $param: #List[
                                       $expression: #ApplyExpr[
                                          $recv: #NameExpr['body']
                                          $recv: #NameExpr['binmode']
                                       ]
                                    ]
                                 ]
                              ]
                              $statement: #RReturnStmt[
                                 $expr: #List[
                                    $expression: #NameExpr['body']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['unescape_filename?']
                        $param: #List['']
                        $body: #BlockExpr[
                           $main: #List[
                              $statement: #AssignExpr[
                                 $left: #NameExpr['user_agent']
                                 $right: #Indexer[
                                    $recv: #NameExpr['$CGI_ENV']
                                    $index: #List[
                                       $expression: #StringExpr['HTTP_USER_AGENT']
                                    ]
                                 ]
                              ]
                              $statement: #RReturnStmt[
                                 $expr: #List[
                                    $command: #ApplyExpr[
                                       $base: #ApplyExpr[
                                          $recv: #Regex['/Mac/i']
                                          $recv: #NameExpr['match']
                                          $param: #List[
                                             $expression: #NameExpr['user_agent']
                                          ]
                                       ]
                                       $recv: #NameExpr['&']
                                       $param: #List[
                                          $command: #ApplyExpr[
                                             $base: #ApplyExpr[
                                                $recv: #Regex['/Mozilla/i']
                                                $recv: #NameExpr['match']
                                                $param: #List[
                                                   $expression: #NameExpr['user_agent']
                                                ]
                                             ]
                                             $recv: #NameExpr['&']
                                             $param: #List[
                                                $expression: #NotExpr[
                                                   $expr: #ApplyExpr[
                                                      $recv: #Regex['/MSIE/i']
                                                      $recv: #NameExpr['match']
                                                      $param: #List[
                                                         $expression: #NameExpr['user_agent']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['read_from_cmdline']
                        $param: #List['']
                        $body: #BlockExpr[
                           $main: #List[
                              $statement: #ApplyExpr[
                                 #Self['self']
                                 $recv: #NameExpr['require']
                                 $param: #List[
                                    $expression: #StringExpr['shellwords']
                                 ]
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['string']
                                 $right: #ApplyExpr[
                                    $recv: #ApplyExpr[
                                       $recv: #Unless[
                                          $cond: #ApplyExpr[
                                             $recv: #NameExpr['ARGV']
                                             $recv: #NameExpr['empty?']
                                          ]
                                          $then: #ApplyExpr[
                                             $recv: #NameExpr['ARGV']
                                             $recv: #NameExpr['join']
                                             $param: #List[
                                                $expression: #StringExpr[' ']
                                             ]
                                          ]
                                          $else: #List[
                                             $statement: #IfExpr[
                                                $cond: #ApplyExpr[
                                                   $recv: #NameExpr['STDIN']
                                                   $recv: #NameExpr['tty?']
                                                ]
                                                $then: #ApplyExpr[
                                                   $recv: #NameExpr['STDERR']
                                                   $recv: #NameExpr['print']
                                                   $param: #List[
                                                      $expression: #ParcentNotation['%|(offline mode: enter name=value pairs on standard input)\\n|']
                                                   ]
                                                ]
                                             ]
                                             $statement: #Rescue[
                                                $body: #AssignExpr[
                                                   $left: #NameExpr['array']
                                                   $right: #NameExpr['readlines']
                                                ]
                                                $rescue: #Nil['nil']
                                             ]
                                             $statement: #IfExpr[
                                                $cond: #[
                                                   $base: #ApplyExpr[
                                                      $recv: #NameExpr['array']
                                                      $recv: #NameExpr['nil?']
                                                   ]
                                                ]
                                                $then: #ApplyExpr[
                                                   $recv: #ApplyExpr[
                                                      $recv: #NameExpr['array']
                                                      $recv: #NameExpr['join']
                                                      $param: #List[
                                                         $expression: #StringExpr[' ']
                                                      ]
                                                   ]
                                                   $recv: #NameExpr['gsub']
                                                   $param: #List[
                                                      $expression: #Regex['/\\n/n']
                                                      $expression: #StringExpr['']
                                                   ]
                                                ]
                                                $else: #StringExpr['']
                                             ]
                                          ]
                                       ]
                                       $recv: #NameExpr['gsub']
                                       $param: #List[
                                          $expression: #Regex['/\\\\=/n']
                                          $expression: #StringExpr['%3D']
                                       ]
                                    ]
                                    $recv: #NameExpr['gsub']
                                    $param: #List[
                                       $expression: #Regex['/\\\\&/n']
                                       $expression: #StringExpr['%26']
                                    ]
                                 ]
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['words']
                                 $right: #ApplyExpr[
                                    $recv: #NameExpr['Shellwords']
                                    $recv: #NameExpr['shellwords']
                                    $param: #List[
                                       $expression: #NameExpr['string']
                                    ]
                                 ]
                              ]
                              $statement: #IfExpr[
                                 $cond: #ApplyExpr[
                                    $recv: #NameExpr['words']
                                    $recv: #NameExpr['find']
                                    $body: #Block[
                                       $param: #NameExpr['x']
                                       $body: #ApplyExpr[
                                          $recv: #Regex['/=/n']
                                          $recv: #NameExpr['match']
                                          $param: #List[
                                             $expression: #NameExpr['x']
                                          ]
                                       ]
                                    ]
                                 ]
                                 $then: #ApplyExpr[
                                    $recv: #NameExpr['words']
                                    $recv: #NameExpr['join']
                                    $param: #List[
                                       $expression: #StringExpr['&']
                                    ]
                                 ]
                                 $else: #ApplyExpr[
                                    $recv: #NameExpr['words']
                                    $recv: #NameExpr['join']
                                    $param: #List[
                                       $expression: #StringExpr['+']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['private']
                        $param: #List[
                           $expression: #NameExpr['read_from_cmdline']
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['initialize_query']
                        $param: #List['']
                        $body: #BlockExpr[
                           $main: #List[
                              $statement: #IfExpr[
                                 $cond: #AndExpr[
                                    $left: #EqExpr[
                                       $left: #StringExpr['POST']
                                       $right: #Indexer[
                                          $recv: #NameExpr['env_table']
                                          $index: #List[
                                             $expression: #StringExpr['REQUEST_METHOD']
                                          ]
                                       ]
                                    ]
                                    $right: #ApplyExpr[
                                       $recv: #Regex['%r|\\Amultipart/form-data.*boundary=\\"?([^\\";,]+)\\"?|']
                                       $recv: #NameExpr['match']
                                       $param: #List[
                                          $expression: #Indexer[
                                             $recv: #NameExpr['env_table']
                                             $index: #List[
                                                $expression: #StringExpr['CONTENT_TYPE']
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $then: #List[
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['current_max_multipart_length']
                                       $right: #Conditional[
                                          $cond: #ApplyExpr[
                                             $recv: #NameExpr['@max_multipart_length']
                                             $recv: #NameExpr['respond_to?']
                                             $param: #List[
                                                $expression: #NameExpr['call']
                                             ]
                                          ]
                                          $then: #ApplyExpr[
                                             $recv: #NameExpr['@max_multipart_length']
                                             $recv: #NameExpr['call']
                                          ]
                                          $else: #NameExpr['@max_multipart_length']
                                       ]
                                    ]
                                    $statement: #IfExpr[
                                       $then: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['raise']
                                          $param: #List[
                                             $expression: #ApplyExpr[
                                                $recv: #NameExpr['StandardError']
                                                $recv: #NameExpr['new']
                                                $param: #List[
                                                   $expression: #StringExpr['too large multipart data.']
                                                ]
                                             ]
                                          ]
                                       ]
                                       $cond: #GtExpr[
                                          $left: #ApplyExpr[
                                             $recv: #Indexer[
                                                $recv: #NameExpr['env_table']
                                                $index: #List[
                                                   $expression: #StringExpr['CONTENT_LENGTH']
                                                ]
                                             ]
                                             $recv: #NameExpr['to_i']
                                          ]
                                          $right: #NameExpr['current_max_multipart_length']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['boundary']
                                       $right: #ApplyExpr[
                                          $recv: #MatchedRegex['$1']
                                          $recv: #NameExpr['dup']
                                       ]
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@multipart']
                                       $right: #TrueExpr['true']
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@params']
                                       $right: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['read_multipart']
                                          $param: #List[
                                             $expression: #NameExpr['boundary']
                                             $expression: #ApplyExpr[
                                                #Self['self']
                                                $recv: #NameExpr['Integer']
                                                $param: #List[
                                                   $expression: #Indexer[
                                                      $recv: #NameExpr['env_table']
                                                      $index: #List[
                                                         $expression: #StringExpr['CONTENT_LENGTH']
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $else: #List[
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@multipart']
                                       $right: #FalseExpr['false']
                                    ]
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['@params']
                                       $right: #ApplyExpr[
                                          $recv: #NameExpr['CGI']
                                          $recv: #NameExpr['parse']
                                          $param: #List[
                                             $expression: #ApplyExpr[
                                                $recv: #ApplyExpr[
                                                   $recv: #Case[
                                                      $cond: #Indexer[
                                                         $recv: #NameExpr['env_table']
                                                         $index: #List[
                                                            $expression: #StringExpr['REQUEST_METHOD']
                                                         ]
                                                      ]
                                                      $body: #List[
                                                         $when: #When[
                                                            $cond: #List[
                                                               $expression: #StringExpr['GET']
                                                               $expression: #StringExpr['HEAD']
                                                            ]
                                                            $then: #IfExpr[
                                                               $cond: #Defined[
                                                                  $base: #NameExpr['MOD_RUBY']
                                                               ]
                                                               $then: #OrExpr[
                                                                  $left: #ApplyExpr[
                                                                     $recv: #ApplyExpr[
                                                                        $recv: #NameExpr['Apache']
                                                                        $recv: #NameExpr['request']
                                                                     ]
                                                                     $recv: #NameExpr['args']
                                                                  ]
                                                                  $right: #StringExpr['']
                                                               ]
                                                               $else: #OrExpr[
                                                                  $left: #Indexer[
                                                                     $recv: #NameExpr['env_table']
                                                                     $index: #List[
                                                                        $expression: #StringExpr['QUERY_STRING']
                                                                     ]
                                                                  ]
                                                                  $right: #StringExpr['']
                                                               ]
                                                            ]
                                                         ]
                                                         $when: #When[
                                                            $cond: #List[
                                                               $expression: #StringExpr['POST']
                                                            ]
                                                            $then: #List[
                                                               $statement: #IfExpr[
                                                                  $then: #ApplyExpr[
                                                                     $recv: #NameExpr['stdinput']
                                                                     $recv: #NameExpr['binmode']
                                                                  ]
                                                                  $cond: #ApplyExpr[
                                                                     #Self['self']
                                                                     $recv: #NameExpr['defined?']
                                                                     $param: #List[
                                                                        $expression: #ApplyExpr[
                                                                           $recv: #NameExpr['stdinput']
                                                                           $recv: #NameExpr['binmode']
                                                                        ]
                                                                     ]
                                                                  ]
                                                               ]
                                                               $statement: #OrExpr[
                                                                  $left: #ApplyExpr[
                                                                     $recv: #NameExpr['stdinput']
                                                                     $recv: #NameExpr['read']
                                                                     $param: #List[
                                                                        $expression: #ApplyExpr[
                                                                           #Self['self']
                                                                           $recv: #NameExpr['Integer']
                                                                           $param: #List[
                                                                              $expression: #Indexer[
                                                                                 $recv: #NameExpr['env_table']
                                                                                 $index: #List[
                                                                                    $expression: #StringExpr['CONTENT_LENGTH']
                                                                                 ]
                                                                              ]
                                                                           ]
                                                                        ]
                                                                     ]
                                                                  ]
                                                                  $right: #StringExpr['']
                                                               ]
                                                            ]
                                                         ]
                                                      ]
                                                      $else: #NameExpr['read_from_cmdline']
                                                   ]
                                                   $recv: #NameExpr['dup']
                                                ]
                                                $recv: #NameExpr['force_encoding']
                                                $param: #List[
                                                   $expression: #NameExpr['@accept_charset']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                    $statement: #Unless[
                                       $cond: #EqExpr[
                                          $left: #ApplyExpr[
                                             $recv: #NameExpr['Encoding']
                                             $recv: #NameExpr['find']
                                             $param: #List[
                                                $expression: #NameExpr['@accept_charset']
                                             ]
                                          ]
                                          $right: #Field[
                                             $recv: #NameExpr['Encoding']
                                             $name: #NameExpr['ASCII_8BIT']
                                          ]
                                       ]
                                       $then: #ApplyExpr[
                                          $recv: #NameExpr['@params']
                                          $recv: #NameExpr['each']
                                          $body: #Block[
                                             $param: #MultipleLeftHandSideExpression[
                                                $item: #NameExpr['key']
                                                $item: #NameExpr['values']
                                             ]
                                             $body: #ApplyExpr[
                                                $recv: #NameExpr['values']
                                                $recv: #NameExpr['each']
                                                $body: #Block[
                                                   $param: #NameExpr['value']
                                                   $body: #Unless[
                                                      $cond: #ApplyExpr[
                                                         $recv: #NameExpr['value']
                                                         $recv: #NameExpr['valid_encoding?']
                                                      ]
                                                      $then: #IfExpr[
                                                         $cond: #NameExpr['@accept_charset_error_block']
                                                         $then: #ApplyExpr[
                                                            $recv: #NameExpr['@accept_charset_error_block']
                                                            $recv: #NameExpr['call']
                                                            $param: #List[
                                                               $expression: #NameExpr['key']
                                                               $expression: #NameExpr['value']
                                                            ]
                                                         ]
                                                         $else: #ApplyExpr[
                                                            #Self['self']
                                                            $recv: #NameExpr['raise']
                                                            $param: #List[
                                                               $expression: #NameExpr['InvalidEncoding']
                                                               $expression: #StringExpr['Accept-Charset encoding error']
                                                            ]
                                                         ]
                                                      ]
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['@cookies']
                                 $right: #ApplyExpr[
                                    $recv: #Field[
                                       $recv: #NameExpr['CGI']
                                       $name: #NameExpr['Cookie']
                                    ]
                                    $recv: #NameExpr['parse']
                                    $param: #List[
                                       $expression: #OrExpr[
                                          $left: #Indexer[
                                             $recv: #NameExpr['env_table']
                                             $index: #List[
                                                $expression: #StringExpr['HTTP_COOKIE']
                                             ]
                                          ]
                                          $right: #Indexer[
                                             $recv: #NameExpr['env_table']
                                             $index: #List[
                                                $expression: #StringExpr['COOKIE']
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['private']
                        $param: #List[
                           $expression: #NameExpr['initialize_query']
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['multipart?']
                        $param: #List['']
                        $body: #BlockExpr[
                           $main: #NameExpr['@multipart']
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['[]']
                        $param: #List[
                           $param: #Param[
                              $param: #NameExpr['key']
                           ]
                        ]
                        $body: #BlockExpr[
                           $main: #List[
                              $statement: #AssignExpr[
                                 $left: #NameExpr['params']
                                 $right: #Indexer[
                                    $recv: #NameExpr['@params']
                                    $index: #List[
                                       $expression: #NameExpr['key']
                                    ]
                                 ]
                              ]
                              $statement: #Unless[
                                 $then: #RReturnStmt[
                                    $expr: #List[
                                       $expression: #StringExpr['']
                                    ]
                                 ]
                                 $cond: #NameExpr['params']
                              ]
                              $statement: #AssignExpr[
                                 $left: #NameExpr['value']
                                 $right: #Indexer[
                                    $recv: #NameExpr['params']
                                    $index: #List[
                                       $expression: #IntExpr['0']
                                    ]
                                 ]
                              ]
                              $statement: #IfExpr[
                                 $cond: #NameExpr['@multipart']
                                 $then: #IfExpr[
                                    $cond: #NameExpr['value']
                                    $then: #RReturnStmt[
                                       $expr: #List[
                                          $expression: #NameExpr['value']
                                       ]
                                    ]
                                    $else: #IfExpr[
                                       $cond: #ApplyExpr[
                                          #Self['self']
                                          $recv: #NameExpr['defined?']
                                          $param: #List[
                                             $expression: #NameExpr['StringIO']
                                          ]
                                       ]
                                       $then: #ApplyExpr[
                                          $recv: #NameExpr['StringIO']
                                          $recv: #NameExpr['new']
                                          $param: #List[
                                             $expression: #ApplyExpr[
                                                $recv: #StringExpr['']
                                                $recv: #NameExpr['force_encoding']
                                                $param: #List[
                                                   $expression: #Field[
                                                      $recv: #NameExpr['Encoding']
                                                      $name: #NameExpr['ASCII_8BIT']
                                                   ]
                                                ]
                                             ]
                                          ]
                                       ]
                                       $else: #ApplyExpr[
                                          $recv: #NameExpr['Tempfile']
                                          $recv: #NameExpr['new']
                                          $param: #List[
                                             $expression: #StringExpr['CGI']
                                             $hash: #Hash[
                                                $key: #NameExpr['encoding']
                                                $value: #Field[
                                                   $recv: #NameExpr['Encoding']
                                                   $name: #NameExpr['ASCII_8BIT']
                                                ]
                                             ]
                                          ]
                                       ]
                                    ]
                                 ]
                                 $else: #List[
                                    $statement: #AssignExpr[
                                       $left: #NameExpr['str']
                                       $right: #IfExpr[
                                          $cond: #NameExpr['value']
                                          $then: #ApplyExpr[
                                             $recv: #NameExpr['value']
                                             $recv: #NameExpr['dup']
                                          ]
                                          $else: #StringExpr['']
                                       ]
                                    ]
                                    $statement: #NameExpr['str']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['keys']
                        $param: #List[
                           $param: #VariadicParam[
                              $name: #NameExpr['args']
                           ]
                        ]
                        $body: #BlockExpr[
                           $main: #ApplyExpr[
                              $recv: #NameExpr['@params']
                              $recv: #NameExpr['keys']
                              $param: #List[
                                 $variadic: #Variadic[
                                    $base: #NameExpr['args']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #FuncDecl[
                        $name: #NameExpr['has_key?']
                        $param: #List[
                           $param: #VariadicParam[
                              $name: #NameExpr['args']
                           ]
                        ]
                        $body: #BlockExpr[
                           $main: #ApplyExpr[
                              $recv: #NameExpr['@params']
                              $recv: #NameExpr['has_key?']
                              $param: #List[
                                 $variadic: #Variadic[
                                    $base: #NameExpr['args']
                                 ]
                              ]
                           ]
                        ]
                     ]
                     $statement: #Alias[
                        $newname: #NameExpr['key?']
                        $target: #NameExpr['has_key?']
                     ]
                     $statement: #Alias[
                        $newname: #NameExpr['include?']
                        $target: #NameExpr['has_key?']
                     ]
                  ]
               ]
            ]
            $statement: #Class[
               $name: #NameExpr['InvalidEncoding']
               $super: #NameExpr['Exception']
               $body: #BlockExpr[
                  $main: #Empty['']
               ]
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['@@accept_charset']
               $right: #StringExpr['UTF-8']
            ]
            $statement: #SFuncDecl[
               $path: #Self['self']
               $name: #NameExpr['accept_charset']
               $param: #List['']
               $body: #BlockExpr[
                  $main: #NameExpr['@@accept_charset']
               ]
            ]
            $statement: #SFuncDecl[
               $path: #Self['self']
               $name: #NameExpr['accept_charset=']
               $param: #List[
                  $param: #Param[
                     $param: #NameExpr['accept_charset']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #AssignExpr[
                     $left: #NameExpr['@@accept_charset']
                     $right: #NameExpr['accept_charset']
                  ]
               ]
            ]
            $statement: #ApplyExpr[
               #Self['self']
               $recv: #NameExpr['attr_reader']
               $param: #List[
                  $expression: #NameExpr['accept_charset']
               ]
            ]
            $statement: #AssignExpr[
               $left: #NameExpr['@@max_multipart_length']
               $right: #MulExpr[
                  $left: #MulExpr[
                     $left: #IntExpr['128']
                     $right: #IntExpr['1024']
                  ]
                  $right: #IntExpr['1024']
               ]
            ]
            $statement: #FuncDecl[
               $name: #NameExpr['initialize']
               $param: #List[
                  $param: #OptionalParam[
                     $name: #NameExpr['options']
                     $default: #List['{}']
                  ]
                  $param: #ProcedureParam[
                     $name: #NameExpr['block']
                  ]
               ]
               $body: #BlockExpr[
                  $main: #List[
                     $statement: #AssignExpr[
                        $left: #NameExpr['@accept_charset_error_block']
                        $right: #Conditional[
                           $cond: #ApplyExpr[
                              #Self['self']
                              $recv: #NameExpr['block_given?']
                           ]
                           $then: #NameExpr['block']
                           $else: #Nil['nil']
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['@options']
                        $right: #List[
                           $hash: #Hash[
                              $key: #NameExpr['accept_charset']
                              $value: #NameExpr['@@accept_charset']
                           ]
                           $hash: #Hash[
                              $key: #NameExpr['max_multipart_length']
                              $value: #NameExpr['@@max_multipart_length']
                           ]
                        ]
                     ]
                     $statement: #Case[
                        $cond: #NameExpr['options']
                        $body: #List[
                           $when: #When[
                              $cond: #List[
                                 $expression: #NameExpr['Hash']
                              ]
                              $then: #ApplyExpr[
                                 $recv: #NameExpr['@options']
                                 $recv: #NameExpr['merge!']
                                 $param: #List[
                                    $expression: #NameExpr['options']
                                 ]
                              ]
                           ]
                           $when: #When[
                              $cond: #List[
                                 $expression: #NameExpr['String']
                              ]
                              $then: #AssignExpr[
                                 $left: #Indexer[
                                    $base: #NameExpr['@options']
                                    $index: #List[
                                       $expression: #NameExpr['tag_maker']
                                    ]
                                 ]
                                 $right: #NameExpr['options']
                              ]
                           ]
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['@accept_charset']
                        $right: #Indexer[
                           $recv: #NameExpr['@options']
                           $index: #List[
                              $expression: #NameExpr['accept_charset']
                           ]
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['@max_multipart_length']
                        $right: #Indexer[
                           $recv: #NameExpr['@options']
                           $index: #List[
                              $expression: #NameExpr['max_multipart_length']
                           ]
                        ]
                     ]
                     $statement: #IfExpr[
                        $cond: #Defined[
                           $base: #LAnd[
                              $left: #NameExpr['MOD_RUBY']
                              $right: #NotExpr[
                                 $expr: #ApplyExpr[
                                    $recv: #NameExpr['ENV']
                                    $recv: #NameExpr['key?']
                                    $param: #List[
                                       $expression: #StringExpr['GATEWAY_INTERFACE']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $then: #ApplyExpr[
                           $recv: #ApplyExpr[
                              $recv: #NameExpr['Apache']
                              $recv: #NameExpr['request']
                           ]
                           $recv: #NameExpr['setup_cgi_env']
                        ]
                     ]
                     $statement: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['extend']
                        $param: #List[
                           $expression: #NameExpr['QueryExtension']
                        ]
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['@multipart']
                        $right: #FalseExpr['false']
                     ]
                     $statement: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['initialize_query']
                        $param: #Empty['']
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['@output_cookies']
                        $right: #Nil['nil']
                     ]
                     $statement: #AssignExpr[
                        $left: #NameExpr['@output_hidden']
                        $right: #Nil['nil']
                     ]
                     $statement: #Case[
                        $cond: #Indexer[
                           $recv: #NameExpr['@options']
                           $index: #List[
                              $expression: #NameExpr['tag_maker']
                           ]
                        ]
                        $body: #List[
                           $when: #When[
                              $cond: #List[
                                 $expression: #StringExpr['html3']
                              ]
                              $then: #List[
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['require']
                                    $param: #List[
                                       $expression: #StringExpr['cgi/html']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['Html3']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['HtmlExtension']
                                    ]
                                 ]
                              ]
                           ]
                           $when: #When[
                              $cond: #List[
                                 $expression: #StringExpr['html4']
                              ]
                              $then: #List[
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['require']
                                    $param: #List[
                                       $expression: #StringExpr['cgi/html']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['Html4']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['HtmlExtension']
                                    ]
                                 ]
                              ]
                           ]
                           $when: #When[
                              $cond: #List[
                                 $expression: #StringExpr['html4Tr']
                              ]
                              $then: #List[
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['require']
                                    $param: #List[
                                       $expression: #StringExpr['cgi/html']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['Html4Tr']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['HtmlExtension']
                                    ]
                                 ]
                              ]
                           ]
                           $when: #When[
                              $cond: #List[
                                 $expression: #StringExpr['html4Fr']
                              ]
                              $then: #List[
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['require']
                                    $param: #List[
                                       $expression: #StringExpr['cgi/html']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['Html4Tr']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['Html4Fr']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['HtmlExtension']
                                    ]
                                 ]
                              ]
                           ]
                           $when: #When[
                              $cond: #List[
                                 $expression: #StringExpr['html5']
                              ]
                              $then: #List[
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['require']
                                    $param: #List[
                                       $expression: #StringExpr['cgi/html']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['Html5']
                                    ]
                                 ]
                                 $statement: #ApplyExpr[
                                    #Self['self']
                                    $recv: #NameExpr['extend']
                                    $param: #List[
                                       $expression: #NameExpr['HtmlExtension']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
         ]
      ]
   ]
   #Comsumed['comsumed']
]
