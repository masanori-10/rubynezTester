#Source[
   #List[
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['strscan']
         ]
      ]
      $statement: #ApplyExpr[
         #Self['self']
         $recv: #NameExpr['require']
         $param: #List[
            $expression: #StringExpr['test/unit']
         ]
      ]
      $statement: #Class[
         $name: #NameExpr['TestStringScanner']
         $super: #Field[
            $recv: #Field[
               $recv: #NameExpr['Test']
               $name: #NameExpr['Unit']
            ]
            $name: #NameExpr['TestCase']
         ]
         $body: #BlockExpr[
            $main: #List[
               $statement: #FuncDecl[
                  $name: #NameExpr['test_s_new']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_instance_of']
                           $param: #List[
                              $expression: #NameExpr['StringScanner']
                              $expression: #NameExpr['s']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['test string']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                                 $expression: #FalseExpr['false']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_instance_of']
                           $param: #List[
                              $expression: #NameExpr['StringScanner']
                              $expression: #NameExpr['s']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_same']
                           $param: #List[
                              $expression: #NameExpr['str']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['string']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['test string']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['string']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #AssignExpr[
                  $left: #NameExpr['UNINIT_ERROR']
                  $right: #NameExpr['ArgumentError']
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_s_allocate']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['allocate']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['#<StringScanner (uninitialized)>']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['inspect']
                                 ]
                                 $recv: #NameExpr['sub']
                                 $param: #List[
                                    $expression: #Regex['/StringScanner_C/']
                                    $expression: #StringExpr['StringScanner']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_raise']
                           $param: #List[
                              $expression: #NameExpr['UNINIT_ERROR']
                           ]
                           $body: #Block[
                              $body: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_raise']
                           $param: #List[
                              $expression: #NameExpr['UNINIT_ERROR']
                           ]
                           $body: #Block[
                              $body: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/a/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['s']
                              $name: #NameExpr['string']
                           ]
                           $right: #StringExpr['test']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['#<StringScanner 0/4 @ "test">']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['inspect']
                                 ]
                                 $recv: #NameExpr['sub']
                                 $param: #List[
                                    $expression: #Regex['/StringScanner_C/']
                                    $expression: #StringExpr['StringScanner']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nothing_raised']
                           $param: #List[
                              $expression: #NameExpr['UNINIT_ERROR']
                           ]
                           $body: #Block[
                              $body: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_s_mustc']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #ApplyExpr[
                        #Self['self']
                        $recv: #NameExpr['assert_nothing_raised']
                        $param: #List[
                           $expression: #NameExpr['NotImplementedError']
                        ]
                        $body: #Block[
                           $body: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['must_C_version']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_dup']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['d']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['dup']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['inspect']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched?']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['matched?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test/']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['d']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['dup']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['inspect']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched?']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['matched?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/NOT MATCH/']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['d']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['dup']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['inspect']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched?']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['matched?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['terminate']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['d']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['dup']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['inspect']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched?']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['matched?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['d']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_const_Version']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_instance_of']
                           $param: #List[
                              $expression: #NameExpr['String']
                              $expression: #Field[
                                 $recv: #NameExpr['StringScanner']
                                 $name: #NameExpr['Version']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['StringScanner']
                                    $name: #NameExpr['Version']
                                 ]
                                 $recv: #NameExpr['frozen?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_const_Id']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_instance_of']
                           $param: #List[
                              $expression: #NameExpr['String']
                              $expression: #Field[
                                 $recv: #NameExpr['StringScanner']
                                 $name: #NameExpr['Id']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #Field[
                                    $recv: #NameExpr['StringScanner']
                                    $name: #NameExpr['Id']
                                 ]
                                 $recv: #NameExpr['frozen?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_inspect']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['test string']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                                 $expression: #FalseExpr['false']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_instance_of']
                           $param: #List[
                              $expression: #NameExpr['String']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['#<StringScanner 0/11 @ "test ...">']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['inspect']
                                 ]
                                 $recv: #NameExpr['sub']
                                 $param: #List[
                                    $expression: #Regex['/StringScanner_C/']
                                    $expression: #StringExpr['StringScanner']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['#<StringScanner 1/11 "t" @ "est s...">']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['inspect']
                                 ]
                                 $recv: #NameExpr['sub']
                                 $param: #List[
                                    $expression: #Regex['/StringScanner_C/']
                                    $expression: #StringExpr['StringScanner']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['inspect']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['\\n']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['#<StringScanner 0/1 @ "\\n">']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_eos?']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\s+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/te/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['string']
                           ]
                           $recv: #NameExpr['replace']
                           $param: #List[
                              $expression: #StringExpr['']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_bol?']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['a\\nbbb\\n\\ncccc\\nddd\\r\\neee']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/a/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\n/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/b/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/b/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/b/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\n/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['unscan']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\n/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\n/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/c+\\n/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/d+\\r\\n/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/e+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['bol?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_string']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['test']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['s']
                              $name: #NameExpr['string']
                           ]
                           $right: #StringExpr['a']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/a/']
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['s']
                              $name: #NameExpr['string']
                           ]
                           $right: #StringExpr['b']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_string_set_is_equal']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['name']
                           $right: #StringExpr['tenderlove']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['name']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['name']
                                 $recv: #NameExpr['object_id']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['string']
                                 ]
                                 $recv: #NameExpr['object_id']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['s']
                              $name: #NameExpr['string']
                           ]
                           $right: #NameExpr['name']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['name']
                                 $recv: #NameExpr['object_id']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['string']
                                 ]
                                 $recv: #NameExpr['object_id']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_string_append']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['tender']
                              ]
                           ]
                        ]
                        $statement: #LShiftExpr[
                           $left: #NameExpr['s']
                           $right: #StringExpr['love']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['tenderlove']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['s']
                              $name: #NameExpr['string']
                           ]
                           $right: #StringExpr['tender']
                        ]
                        $statement: #LShiftExpr[
                           $left: #NameExpr['s']
                           $right: #StringExpr['love']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['tenderlove']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['string']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_pos']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['1']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['2']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['terminate']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['11']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_pos_unicode']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['abcdefghi']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['charpos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['abc']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_until']
                                 $param: #List[
                                    $expression: #Regex['//']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['charpos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['def']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_until']
                                 $param: #List[
                                    $expression: #Regex['//']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['8']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['charpos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['terminate']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['11']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['charpos']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_concat']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['a']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/a/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['s']
                           $recv: #NameExpr['concat']
                           $param: #List[
                              $expression: #StringExpr['b']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['b']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/b/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #NameExpr['s']
                           $recv: #NameExpr['concat']
                           $param: #List[
                              $expression: #StringExpr['c']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['c']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/c/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_scan']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['stra strb strc']
                                 $expression: #TrueExpr['true']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['tmp']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['scan']
                              $param: #List[
                                 $expression: #Regex['/\\w+/']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['stra']
                              $expression: #NameExpr['tmp']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['tmp']
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['tmp']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['scan']
                              $param: #List[
                                 $expression: #Regex['/\\s+/']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' ']
                              $expression: #NameExpr['tmp']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['tmp']
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['strb']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\s+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['tmp']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['scan']
                              $param: #List[
                                 $expression: #Regex['/\\w+/']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['strc']
                              $expression: #NameExpr['tmp']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['tmp']
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['stra strb strc']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                                 $expression: #FalseExpr['false']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['tmp']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['scan']
                              $param: #List[
                                 $expression: #Regex['/\\w+/']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['stra']
                              $expression: #NameExpr['tmp']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['tmp']
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['tmp']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['scan']
                              $param: #List[
                                 $expression: #Regex['/\\s+/']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' ']
                              $expression: #NameExpr['tmp']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['tmp']
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['strb']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\s+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['tmp']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['scan']
                              $param: #List[
                                 $expression: #Regex['/\\w+/']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['strc']
                              $expression: #NameExpr['tmp']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['tmp']
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/te/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['string']
                           ]
                           $recv: #NameExpr['replace']
                           $param: #List[
                              $expression: #StringExpr['']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/test/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['//']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['//']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_skip']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['stra strb strc']
                                 $expression: #TrueExpr['true']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['1']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['/\\s+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['1']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['/\\s+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['/\\s+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/te/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['string']
                           ]
                           $recv: #NameExpr['replace']
                           $param: #List[
                              $expression: #StringExpr['']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['/./']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['//']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip']
                                 $param: #List[
                                    $expression: #Regex['//']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_getch']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['abcde']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['b']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['c']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['d']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['abc']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['getch']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['getch']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['getch']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #StringExpr['\\244\\242']
                                    $recv: #NameExpr['force_encoding']
                                    $param: #List[
                                       $expression: #StringExpr['euc-jp']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #StringExpr['\\244\\242']
                                 $recv: #NameExpr['force_encoding']
                                 $param: #List[
                                    $expression: #StringExpr['euc-jp']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/te/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['string']
                           ]
                           $recv: #NameExpr['replace']
                           $param: #List[
                              $expression: #StringExpr['']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['getch']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_get_byte']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['abcde']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['b']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['c']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['d']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['abc']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['get_byte']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['get_byte']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['get_byte']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #StringExpr['\\244\\242']
                                    $recv: #NameExpr['force_encoding']
                                    $param: #List[
                                       $expression: #StringExpr['euc-jp']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #StringExpr['\\244']
                                 $recv: #NameExpr['force_encoding']
                                 $param: #List[
                                    $expression: #StringExpr['euc-jp']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #StringExpr['\\242']
                                 $recv: #NameExpr['force_encoding']
                                 $param: #List[
                                    $expression: #StringExpr['euc-jp']
                                 ]
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/te/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $base: #ApplyExpr[
                              $recv: #NameExpr['s']
                              $recv: #NameExpr['string']
                           ]
                           $recv: #NameExpr['replace']
                           $param: #List[
                              $expression: #StringExpr['']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['get_byte']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_matched']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['stra strb strc']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['stra']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['matched']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\s+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['strb']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\s+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['strc']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['getch']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['stra strb strc']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['getch']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['s']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['matched']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['t']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['t']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['matched']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['test']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['matched']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['matched']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_AREF']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['stra strb strc']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['2']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['stra']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['1']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['stra']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['1']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_raise']
                           $param: #List[
                              $expression: #NameExpr['IndexError']
                           ]
                           $body: #Block[
                              $body: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #NameExpr['c']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_raise']
                           $param: #List[
                              $expression: #NameExpr['IndexError']
                           ]
                           $body: #Block[
                              $body: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #StringExpr['c']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #Indexer[
                                    $recv: #NameExpr['s']
                                    $index: #List[
                                       $expression: #MinusExpr[
                                          $expr: #IntExpr['1']
                                       ]
                                    ]
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #Indexer[
                                    $recv: #NameExpr['s']
                                    $index: #List[
                                       $expression: #IntExpr['0']
                                    ]
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['skip']
                           $param: #List[
                              $expression: #Regex['/\\s+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['2']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' ']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['1']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' ']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['1']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/(s)t(r)b/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['100']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['4']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['strb']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['3']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['s']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['2']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['r']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['1']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['strb']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['s']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['1']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['r']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['2']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['3']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['100']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\s+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['getch']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['2']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['s']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['1']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['s']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['1']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['2']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['t']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #MinusExpr[
                                       $expr: #IntExpr['1']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['t']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['1']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/.*/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/./']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #StringExpr['\\244\\242']
                                    $recv: #NameExpr['force_encoding']
                                    $param: #List[
                                       $expression: #StringExpr['euc-jp']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['getch']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #StringExpr['\\244\\242']
                                 $recv: #NameExpr['force_encoding']
                                 $param: #List[
                                    $expression: #StringExpr['euc-jp']
                                 ]
                              ]
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['0']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['test']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/(t)(e)(s)(t)/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #Indexer[
                                    $recv: #NameExpr['s']
                                    $index: #List[
                                       $expression: #IntExpr['0']
                                    ]
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #Indexer[
                                    $recv: #NameExpr['s']
                                    $index: #List[
                                       $expression: #IntExpr['1']
                                    ]
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #Indexer[
                                    $recv: #NameExpr['s']
                                    $index: #List[
                                       $expression: #IntExpr['2']
                                    ]
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #Indexer[
                                    $recv: #NameExpr['s']
                                    $index: #List[
                                       $expression: #IntExpr['3']
                                    ]
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #Indexer[
                                    $recv: #NameExpr['s']
                                    $index: #List[
                                       $expression: #IntExpr['4']
                                    ]
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['foo bar baz']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/(?<a>\\w+) (?<b>\\w+) (\\w+)/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['foo']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['1']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['bar']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['2']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #IntExpr['3']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['foo']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #NameExpr['a']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['bar']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #NameExpr['b']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_raise']
                           $param: #List[
                              $expression: #NameExpr['IndexError']
                           ]
                           $body: #Block[
                              $body: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #NameExpr['c']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['foo']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #StringExpr['a']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['bar']
                              $expression: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #StringExpr['b']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_raise']
                           $param: #List[
                              $expression: #NameExpr['IndexError']
                           ]
                           $body: #Block[
                              $body: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #StringExpr['c']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_raise_with_message']
                           $param: #List[
                              $expression: #NameExpr['IndexError']
                              $expression: #Regex['/\\u{30c6 30b9 30c8}/']
                           ]
                           $body: #Block[
                              $body: #Indexer[
                                 $recv: #NameExpr['s']
                                 $index: #List[
                                    $expression: #StringExpr['\\u{30c6 30b9 30c8}']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_pre_match']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['a b c d e']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pre_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['pre_match']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['skip']
                           $param: #List[
                              $expression: #Regex['/\\s/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pre_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #FalseExpr['false']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['pre_match']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pre_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan_until']
                           $param: #List[
                              $expression: #Regex['/c/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a b ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pre_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['getch']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a b c']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pre_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a b c ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pre_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['a b c d']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pre_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/never match/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pre_match']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['test string']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['pre_match']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\s+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['pre_match']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['pre_match']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_post_match']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['a b c d e']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' b c d e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['skip']
                           $param: #List[
                              $expression: #Regex['/\\s/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['b c d e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' c d e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan_until']
                           $param: #List[
                              $expression: #Regex['/c/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' d e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['getch']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['d e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['get_byte']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['e']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/never match/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/./']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/./']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['post_match']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['str']
                           $right: #StringExpr['test string']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['str']
                           $recv: #NameExpr['taint']
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #NameExpr['str']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['post_match']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\s+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['post_match']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['s']
                                    $recv: #NameExpr['post_match']
                                 ]
                                 $recv: #NameExpr['tainted?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_terminate']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['ssss']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['getch']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['terminate']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['terminate']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #TrueExpr['true']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['eos?']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_reset']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['ssss']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['getch']
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['reset']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/\\w+/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['reset']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['reset']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_matched_size']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['//']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/x/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['terminate']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['terminate']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_nil']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched_size']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_encoding']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['ss']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #StringExpr['\\xA1\\xA2']
                                    $recv: #NameExpr['force_encoding']
                                    $param: #List[
                                       $expression: #StringExpr['euc-jp']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Field[
                                 $recv: #NameExpr['Encoding']
                                 $name: #NameExpr['EUC_JP']
                              ]
                              $expression: #ApplyExpr[
                                 $recv: #ApplyExpr[
                                    $recv: #NameExpr['ss']
                                    $recv: #NameExpr['scan']
                                    $param: #List[
                                       $expression: #Regex['/./e']
                                    ]
                                 ]
                                 $recv: #NameExpr['encoding']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_generic_regexp']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['ss']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #ApplyExpr[
                                    $recv: #StringExpr['\\xA1\\xA2']
                                    $recv: #NameExpr['force_encoding']
                                    $param: #List[
                                       $expression: #StringExpr['euc-jp']
                                    ]
                                 ]
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #NameExpr['t']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['ss']
                              $recv: #NameExpr['scan']
                              $param: #List[
                                 $expression: #Regex['/./']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #ApplyExpr[
                                 $recv: #StringExpr['\\xa1\\xa2']
                                 $recv: #NameExpr['force_encoding']
                                 $param: #List[
                                    $expression: #StringExpr['euc-jp']
                                 ]
                              ]
                              $expression: #NameExpr['t']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_set_pos']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #AssignExpr[
                           $left: #Field[
                              $base: #NameExpr['s']
                              $name: #NameExpr['pos']
                           ]
                           $right: #IntExpr['7']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['ring']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['rest']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_match_p']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['match?']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['match?']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['match?']
                                 $param: #List[
                                    $expression: #Regex['/\\s+/']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_check']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['Foo Bar Baz']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Foo']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['check']
                                 $param: #List[
                                    $expression: #Regex['/Foo/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Foo']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['check']
                                 $param: #List[
                                    $expression: #Regex['/Bar/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['matched']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_scan_full']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['Foo Bar Baz']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_full']
                                 $param: #List[
                                    $expression: #Regex['/Foo /']
                                    $expression: #FalseExpr['false']
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_full']
                                 $param: #List[
                                    $expression: #Regex['/Baz/']
                                    $expression: #FalseExpr['false']
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Foo ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_full']
                                 $param: #List[
                                    $expression: #Regex['/Foo /']
                                    $expression: #FalseExpr['false']
                                    $expression: #TrueExpr['true']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_full']
                                 $param: #List[
                                    $expression: #Regex['/Baz/']
                                    $expression: #FalseExpr['false']
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_full']
                                 $param: #List[
                                    $expression: #Regex['/Foo /']
                                    $expression: #TrueExpr['true']
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_full']
                                 $param: #List[
                                    $expression: #Regex['/Baz /']
                                    $expression: #FalseExpr['false']
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Bar ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_full']
                                 $param: #List[
                                    $expression: #Regex['/Bar /']
                                    $expression: #TrueExpr['true']
                                    $expression: #TrueExpr['true']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['8']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan_full']
                                 $param: #List[
                                    $expression: #Regex['/az/']
                                    $expression: #FalseExpr['false']
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_exist_p']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['3']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['exist?']
                                 $param: #List[
                                    $expression: #Regex['/s/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['2']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['exist?']
                                 $param: #List[
                                    $expression: #Regex['/s/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['exist?']
                                 $param: #List[
                                    $expression: #Regex['/e/']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_skip_until']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['Foo Bar Baz']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['3']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip_until']
                                 $param: #List[
                                    $expression: #Regex['/Foo/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['3']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['4']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip_until']
                                 $param: #List[
                                    $expression: #Regex['/Bar/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['7']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['skip_until']
                                 $param: #List[
                                    $expression: #Regex['/Qux/']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_check_until']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['Foo Bar Baz']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Foo']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['check_until']
                                 $param: #List[
                                    $expression: #Regex['/Foo/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Foo Bar']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['check_until']
                                 $param: #List[
                                    $expression: #Regex['/Bar/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['check_until']
                                 $param: #List[
                                    $expression: #Regex['/Qux/']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_search_full']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['Foo Bar Baz']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['8']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['search_full']
                                 $param: #List[
                                    $expression: #Regex['/Bar /']
                                    $expression: #FalseExpr['false']
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Foo Bar ']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['search_full']
                                 $param: #List[
                                    $expression: #Regex['/Bar /']
                                    $expression: #FalseExpr['false']
                                    $expression: #TrueExpr['true']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['8']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['search_full']
                                 $param: #List[
                                    $expression: #Regex['/Bar /']
                                    $expression: #TrueExpr['true']
                                    $expression: #FalseExpr['false']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['8']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['Baz']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['search_full']
                                 $param: #List[
                                    $expression: #Regex['/az/']
                                    $expression: #TrueExpr['true']
                                    $expression: #TrueExpr['true']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['11']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['pos']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_peek']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['test st']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['peek']
                                 $param: #List[
                                    $expression: #IntExpr['7']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['test st']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['peek']
                                 $param: #List[
                                    $expression: #IntExpr['7']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' stri']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['peek']
                                 $param: #List[
                                    $expression: #IntExpr['5']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' string']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['peek']
                                 $param: #List[
                                    $expression: #IntExpr['10']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/ string/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['peek']
                                 $param: #List[
                                    $expression: #IntExpr['10']
                                 ]
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_unscan']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['test']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\w+/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['unscan']
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['te']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/../']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #Nil['nil']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['scan']
                                 $param: #List[
                                    $expression: #Regex['/\\d/']
                                 ]
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_raise']
                           $param: #List[
                              $expression: #NameExpr['ScanError']
                           ]
                           $body: #Block[
                              $body: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['unscan']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_rest']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['test string']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['rest']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr[' string']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['rest']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/ string/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['rest']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/ string/']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_rest_size']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['11']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['rest_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['7']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['rest_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/ string/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #IntExpr['0']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['rest_size']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/ string/']
                           ]
                        ]
                     ]
                  ]
               ]
               $statement: #FuncDecl[
                  $name: #NameExpr['test_inspect2']
                  $param: #List['']
                  $body: #BlockExpr[
                     $main: #List[
                        $statement: #AssignExpr[
                           $left: #NameExpr['s']
                           $right: #ApplyExpr[
                              $recv: #NameExpr['StringScanner']
                              $recv: #NameExpr['new']
                              $param: #List[
                                 $expression: #StringExpr['test string test']
                              ]
                           ]
                        ]
                        $statement: #ApplyExpr[
                           $recv: #NameExpr['s']
                           $recv: #NameExpr['scan']
                           $param: #List[
                              $expression: #Regex['/test strin/']
                           ]
                        ]
                        $statement: #ApplyExpr[
                           #Self['self']
                           $recv: #NameExpr['assert_equal']
                           $param: #List[
                              $expression: #StringExpr['#<StringScanner 10/16 "...strin" @ "g tes...">']
                              $expression: #ApplyExpr[
                                 $recv: #NameExpr['s']
                                 $recv: #NameExpr['inspect']
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
            ]
         ]
      ]
   ]
   #Comsumed['comsumed']
]
